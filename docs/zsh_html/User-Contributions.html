<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created on May 14, 2022 by texi2html 5.0
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>zsh: 26 User Contributions</title>

<meta name="description" content="zsh: 26 User Contributions">
<meta name="keywords" content="zsh: 26 User Contributions">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 5.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nocodebreak {white-space:pre}
span.nolinebreak {white-space:pre}
span.roman {font-family:serif; font-weight:normal}
span.sansserif {font-family:sans-serif; font-weight:normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="User-Contributions"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="Zftp-Function-System.html#Zftp-Function-System" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="Zftp-Function-System.html#Completion-3" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Description-7" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="User-Contributions-1"></a>
<h1 class="chapter">26 User Contributions</h1>
<a name="index-user-contributions"></a>

<hr>
<a name="Description-7"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-Contributions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-Contributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">26.1 Description</h2>

<p>The Zsh source distribution includes a number of items contributed by the
user community.  These are not inherently a part of the shell, and some
may not be available in every zsh installation.  The most significant of
these are documented here.  For documentation on other contributed items
such as shell functions, look for comments in the function source files.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Utilities">26.2 Utilities</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Recent-Directories">26.3 Remembering Recent Directories</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Other-Directory-Functions">26.4 Abbreviated dynamic references to directories</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Version-Control-Information">26.5 Gathering information from version control systems</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Prompt-Themes">26.6 Prompt Themes</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#ZLE-Functions">26.7 ZLE Functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Exception-Handling">26.8 Exception Handling</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#MIME-Functions">26.9 MIME Functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Mathematical-Functions">26.10 Mathematical Functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#User-Configuration-Functions">26.11 User Configuration Functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Other-Functions">26.12 Other Functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Utilities"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Description-7" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-Contributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Accessing-On_002dLine-Help" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="Utilities-1"></a>
<h2 class="section">26.2 Utilities</h2>


<hr>
<a name="Accessing-On_002dLine-Help"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Recompiling-Functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.2.1 Accessing On-Line Help</h3>
<a name="index-helpfiles-utility"></a>

<p>The key sequence <tt>ESC h</tt> is normally bound by ZLE to execute the
<tt>run-help</tt> widget (see
<a href="Zsh-Line-Editor.html#Zsh-Line-Editor">Zsh Line Editor</a>).  This invokes the <tt>run-help</tt> command with the command word from the
current input line as its argument.  By default, <tt>run-help</tt> is an alias
for the <tt>man</tt> command, so this often fails when the command word is a
shell builtin or a user-defined function.  By redefining the <tt>run-help</tt>
alias, one can improve the on-line help provided by the shell.
</p>
<p>The <tt>helpfiles</tt> utility, found in the <tt>Util</tt> directory of the
distribution, is a Perl program that can be used to process the zsh manual
to produce a separate help file for each shell builtin and for many other
shell features as well.  The autoloadable <tt>run-help</tt> function, found in
<tt>Functions/Misc</tt>, searches for these helpfiles and performs several
other tests to produce the most complete help possible for the command.
</p>
<p>Help files are installed by default to a subdirectory of <tt>/usr/share/zsh</tt>
or <tt>/usr/local/share/zsh</tt>.
</p>
<p>To create your own help files with <tt>helpfiles</tt>, choose or create a
directory where the individual command help files will reside.  For
example, you might choose <tt>~/zsh_help</tt>.  If you unpacked the zsh
distribution in your home directory, you would use the commands:
</p>
<div class="example">
<pre class="example">mkdir ~/zsh_help
perl ~/zsh-5.9/Util/helpfiles ~/zsh_help
</pre></div>

<a name="index-HELPDIR"></a>
<p>The <tt>HELPDIR</tt> parameter tells <tt>run-help</tt> where to look for the help
files. When unset, it uses the default installation path.
To use your own set of help files, set this to the appropriate path
in one of your startup files:
</p>
<div class="example">
<pre class="example">HELPDIR=~/zsh_help
</pre></div>

<a name="index-run_002dhelp_002c-use-of"></a>
<p>To use the <tt>run-help</tt> function, you need to add lines something
like the following to your <tt>.zshrc</tt> or equivalent startup file:
</p>
<div class="example">
<pre class="example">unalias run-help
autoload run-help
</pre></div>

<p>Note that in order for &lsquo;<tt>autoload run-help</tt>&rsquo; to work, the <tt>run-help</tt>
file must be in one of the directories named in your <tt>fpath</tt> array (see
<a href="Parameters.html#Parameters-Used-By-The-Shell">Parameters Used By The Shell</a>).  This should already be the case if you have a standard zsh
installation; if it is not, copy <tt>Functions/Misc/run-help</tt> to an
appropriate directory.
</p>

<hr>
<a name="Recompiling-Functions"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Accessing-On_002dLine-Help" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Keyboard-Definition" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.2.2 Recompiling Functions</h3>
<a name="index-functions_002c-recompiling"></a>
<a name="index-zrecompile-utility"></a>

<p>If you frequently edit your zsh functions, or periodically update your zsh
installation to track the latest developments, you may find that function
digests compiled with the <tt>zcompile</tt> builtin are frequently out of date
with respect to the function source files.  This is not usually a problem,
because zsh always looks for the newest file when loading a function, but
it may cause slower shell startup and function loading.  Also, if a digest
file is explicitly used as an element of <tt>fpath</tt>, zsh won&rsquo;t check whether
any of its source files has changed.
</p>
<p>The <tt>zrecompile</tt> autoloadable function, found in <tt>Functions/Misc</tt>, can
be used to keep function digests up to date.
</p>
<dl compact="compact">
<dd><a name="index-zrecompile"></a>
</dd>
<dt><tt>zrecompile</tt> [ <tt>-qt</tt> ] [ <var>name</var> ... ]</dt>
<dt><tt>zrecompile</tt> [ <tt>-qt</tt> ] <tt>-p</tt> <var>arg</var> ... [ <tt>-</tt><tt>-</tt> <var>arg</var> ... ]</dt>
<dd><p>This tries to find <tt>*.zwc</tt> files and automatically re-compile them if at
least one of the original files is newer than the compiled file.  This
works only if the names stored in the compiled files are full paths or are
relative to the directory that contains the <tt>.zwc</tt> file.
</p>
<p>In the first form, each <var>name</var> is the name of a compiled file or a
directory containing <tt>*.zwc</tt> files that should be checked.  If no
arguments are given, the directories and <tt>*.zwc</tt> files in <tt>fpath</tt> are
used.
</p>
<p>When <tt>-t</tt> is given, no compilation is performed, but a return status of
zero (true) is set if there are files that need to be re-compiled and
non-zero (false) otherwise.  The <tt>-q</tt> option quiets the chatty output
that describes what <tt>zrecompile</tt> is doing.
</p>
<p>Without the <tt>-t</tt> option, the return status is zero if all files that
needed re-compilation could be compiled and non-zero if compilation for at
least one of the files failed.
</p>
<p>If the <tt>-p</tt> option is given, the <var>arg</var>s are interpreted as one
or more sets of arguments for <tt>zcompile</tt>, separated by &lsquo;<tt>-</tt><tt>-</tt>&rsquo;.
For example:
</p>
<div class="example">
<pre class="example">zrecompile -p \ 
           -R ~/.zshrc -- \ 
           -M ~/.zcompdump -- \ 
           ~/zsh/comp.zwc ~/zsh/Completion/*/_*
</pre></div>

<p>This compiles <tt>~/.zshrc</tt> into <tt>~/.zshrc.zwc</tt> if that doesn&rsquo;t exist or
if it is older than <tt>~/.zshrc</tt>. The compiled file will be marked for
reading instead of mapping. The same is done for <tt>~/.zcompdump</tt> and
<tt>~/.zcompdump.zwc</tt>, but this compiled file is marked for mapping. The
last line re-creates the file <tt>~/zsh/comp.zwc</tt> if any of the files
matching the given pattern is newer than it.
</p>
<p>Without the <tt>-p</tt> option, <tt>zrecompile</tt> does not create function digests
that do not already exist, nor does it add new functions to the digest.
</p>
</dd>
</dl>

<p>The following shell loop is an example of a method for creating function
digests for all functions in your <tt>fpath</tt>, assuming that you have write
permission to the directories:
</p>
<div class="example">
<pre class="example">for ((i=1; i &lt;= $#fpath; ++i)); do
  dir=$fpath[i]
  zwc=${dir:t}.zwc
  if [[ $dir == (.|..) || $dir == (.|..)/* ]]; then
    continue
  fi
  files=($dir/*(N-.))
  if [[ -w $dir:h &amp;&amp; -n $files ]]; then
    files=(${${(M)files%/*/*}#/})
    if ( cd $dir:h &amp;&amp;
         zrecompile -p -U -z $zwc $files ); then
      fpath[i]=$fpath[i].zwc
    fi
  fi
done
</pre></div>

<p>The <tt>-U</tt> and <tt>-z</tt> options are appropriate for functions in the default
zsh installation <tt>fpath</tt>; you may need to use different options for your
personal function directories.
</p>
<p>Once the digests have been created and your <tt>fpath</tt> modified to refer to
them, you can keep them up to date by running <tt>zrecompile</tt> with no
arguments.
</p>

<hr>
<a name="Keyboard-Definition"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Recompiling-Functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Dumping-Shell-State" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.2.3 Keyboard Definition</h3>
<a name="index-keyboard-definition"></a>

<a name="index-zkbd"></a>
<p>The large number of possible combinations of keyboards, workstations,
terminals, emulators, and window systems makes it impossible for zsh to
have built-in key bindings for every situation.  The <tt>zkbd</tt> utility,
found in <tt>Functions/Misc</tt>, can help you quickly create key bindings for your
configuration.
</p>
<p>Run <tt>zkbd</tt> either as an autoloaded function, or as a shell script:
</p>
<div class="example">
<pre class="example">zsh -f ~/zsh-5.9/Functions/Misc/zkbd
</pre></div>

<p>When you run <tt>zkbd</tt>, it first asks you to enter your terminal type; if
the default it offers is correct, just press return.  It then asks you to
press a number of different keys to determine characteristics of your
keyboard and terminal; <tt>zkbd</tt> warns you if it finds anything out of the
ordinary, such as a Delete key that sends neither <tt>^H</tt> nor <tt>^?</tt>.
</p>
<p>The keystrokes read by <tt>zkbd</tt> are recorded as a definition for an
associative array named <tt>key</tt>, written to a file in the subdirectory
<tt>.zkbd</tt> within either your <tt>HOME</tt> or <tt>ZDOTDIR</tt> directory.  The name
of the file is composed from the <tt>TERM</tt>, <tt>VENDOR</tt> and <tt>OSTYPE</tt>
parameters, joined by hyphens.
</p>
<p>You may read this file into your <tt>.zshrc</tt> or another startup file with
the &lsquo;<tt>source</tt>&rsquo; or &lsquo;<tt>.</tt>&rsquo; commands, then reference the <tt>key</tt> parameter
in bindkey commands, like this:
</p>
<div class="example">
<pre class="example">source ${ZDOTDIR:-$HOME}/.zkbd/$TERM-$VENDOR-$OSTYPE
[[ -n ${key[Left]} ]] &amp;&amp; bindkey &quot;${key[Left]}&quot; backward-char
[[ -n ${key[Right]} ]] &amp;&amp; bindkey &quot;${key[Right]}&quot; forward-char
# etc.
</pre></div>

<p>Note that in order for &lsquo;<tt>autoload zkbd</tt>&rsquo; to work, the <tt>zkdb</tt> file must
be in one of the directories named in your <tt>fpath</tt> array (see
<a href="Parameters.html#Parameters-Used-By-The-Shell">Parameters Used By The Shell</a>).  This should already be the case if you have a standard zsh
installation; if it is not, copy <tt>Functions/Misc/zkbd</tt> to an
appropriate directory.
</p>

<hr>
<a name="Dumping-Shell-State"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Keyboard-Definition" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Manipulating-Hook-Functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.2.4 Dumping Shell State</h3>
<a name="index-reporter-utility"></a>

<p>Occasionally you may encounter what appears to be a bug in the shell,
particularly if you are using a beta version of zsh or a development
release.  Usually it is sufficient to send a description of the
problem to one of the zsh mailing lists (see
<a href="Introduction.html#Mailing-Lists">Mailing Lists</a>), but sometimes one of the zsh developers will need to recreate your
environment in order to track the problem down.
</p>
<p>The script named <tt>reporter</tt>, found in the <tt>Util</tt> directory of the
distribution, is provided for this purpose.  (It is also possible to
<tt>autoload reporter</tt>, but <tt>reporter</tt> is not installed in <tt>fpath</tt>
by default.)  This script outputs a detailed dump of the shell state,
in the form of another script that can be read with &lsquo;<tt>zsh -f</tt>&rsquo; to
recreate that state.
</p>
<p>To use <tt>reporter</tt>, read the script into your shell with the &lsquo;<tt>.</tt>&rsquo;
command and redirect the output into a file:
</p>
<div class="example">
<pre class="example">. ~/zsh-5.9/Util/reporter &gt; zsh.report
</pre></div>

<p>You should check the <tt>zsh.report</tt> file for any sensitive information
such as passwords and delete them by hand before sending the script to the
developers.  Also, as the output can be voluminous, it&rsquo;s best to wait for
the developers to ask for this information before sending it.
</p>
<p>You can also use <tt>reporter</tt> to dump only a subset of the shell state.
This is sometimes useful for creating startup files for the first time.
Most of the output from reporter is far more detailed than usually is
necessary for a startup file, but the <tt>aliases</tt>, <tt>options</tt>, and
<tt>zstyles</tt> states may be useful because they include only changes from
the defaults.  The <tt>bindings</tt> state may be useful if you have created
any of your own keymaps, because <tt>reporter</tt> arranges to dump the keymap
creation commands as well as the bindings for every keymap.
</p>
<p>As is usual with automated tools, if you create a startup file with
<tt>reporter</tt>, you should edit the results to remove unnecessary commands.
Note that if you&rsquo;re using the new completion system, you should <em>not</em>
dump the <tt>functions</tt> state to your startup files with <tt>reporter</tt>; use
the <tt>compdump</tt> function instead (see
<a href="Completion-System.html#Completion-System">Completion System</a>).
</p>
<dl compact="compact">
<dt><tt>reporter</tt> [ <var>state</var> ... ]</dt>
<dd><a name="index-reporter"></a>
<p>Print to standard output the indicated subset of the current shell state.
The <var>state</var> arguments may be one or more of:
</p>
<dl compact="compact">
<dt><tt>all</tt></dt>
<dd><p>Output everything listed below.
</p></dd>
<dt><tt>aliases</tt></dt>
<dd><p>Output alias definitions.
</p></dd>
<dt><tt>bindings</tt></dt>
<dd><p>Output ZLE key maps and bindings.
</p></dd>
<dt><tt>completion</tt></dt>
<dd><p>Output old-style <tt>compctl</tt> commands.
New completion is covered by <tt>functions</tt> and <tt>zstyles</tt>.
</p></dd>
<dt><tt>functions</tt></dt>
<dd><p>Output autoloads and function definitions.
</p></dd>
<dt><tt>limits</tt></dt>
<dd><p>Output <tt>limit</tt> commands.
</p></dd>
<dt><tt>options</tt></dt>
<dd><p>Output <tt>setopt</tt> commands.
</p></dd>
<dt><tt>styles</tt></dt>
<dd><p>Same as <tt>zstyles</tt>.
</p></dd>
<dt><tt>variables</tt></dt>
<dd><p>Output shell parameter assignments, plus <tt>export</tt>
commands for any environment variables.
</p></dd>
<dt><tt>zstyles</tt></dt>
<dd><p>Output <tt>zstyle</tt> commands.
</p></dd>
</dl>

<p>If the <var>state</var> is omitted, <tt>all</tt> is assumed.
</p>

<p>With the exception of &lsquo;<tt>all</tt>&rsquo;, every <var>state</var> can be abbreviated by
any prefix, even a single letter; thus <tt>a</tt> is the same as <tt>aliases</tt>,
<tt>z</tt> is the same as <tt>zstyles</tt>, etc.
</p></dd>
</dl>


<hr>
<a name="Manipulating-Hook-Functions"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Dumping-Shell-State" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Recent-Directories" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.2.5 Manipulating Hook Functions</h3>
<a name="index-hook-function-utility"></a>

<dl compact="compact">
<dd><a name="index-add_002dzsh_002dhook"></a>
</dd>
<dt><tt>add-zsh-hook</tt> [ <tt>-L</tt> | <tt>-dD</tt> ] [ <tt>-Uzk</tt> ] <var>hook</var> <var>function</var></dt>
<dd><p>Several functions are special to the shell, as described in the section
Special Functions, <a href="Functions.html#Functions">Functions</a>,
in that they are automatically called at specific points during shell execution.
Each has an associated array consisting of names of functions to be
called at the same point; these are so-called &lsquo;hook functions&rsquo;.
The shell function <tt>add-zsh-hook</tt> provides a simple way of adding or
removing functions from the array.
</p>
<p><var>hook</var> is one of <tt>chpwd</tt>, <tt>periodic</tt>, <tt>precmd</tt>, <tt>preexec</tt>,
<tt>zshaddhistory</tt>, <tt>zshexit</tt>, or <tt>zsh_directory_name</tt>,
the special functions in question.  Note that <tt>zsh_directory_name</tt>
is called in a different way from the other functions, but may
still be manipulated as a hook.
</p>
<p><var>function</var> is name of an ordinary shell function.  If no options
are given this will be added to the array of functions to be executed
in the given context.
Functions are invoked in the order they were added.
</p>
<p>If the option <tt>-L</tt> is given, the current values for the hook arrays
are listed with <tt>typeset</tt>.
</p>
<p>If the option <tt>-d</tt> is given, the <var>function</var> is removed from
the array of functions to be executed.
</p>
<p>If the option <tt>-D</tt> is given, the <var>function</var> is treated as a pattern
and any matching names of functions are removed from the array of
functions to be executed.
</p>
<p>The options <tt>-U</tt>, <tt>-z</tt> and <tt>-k</tt> are passed as arguments to
<tt>autoload</tt> for <var>function</var>.  For functions contributed with zsh, the
options <tt>-Uz</tt> are appropriate.
</p>
<a name="index-add_002dzle_002dhook_002dwidget"></a>
</dd>
<dt><tt>add-zle-hook-widget</tt> [ <tt>-L</tt> | <tt>-dD</tt> ] [ <tt>-Uzk</tt> ] <var>hook</var> <var>widgetname</var></dt>
<dd><p>Several widget names are special to the line editor, as described in the section
Special Widgets, <a href="Zsh-Line-Editor.html#Zle-Widgets">Zle Widgets</a>,
in that they are automatically called at specific points during editing.
Unlike function hooks, these do not use a predefined array of other names
to call at the same point; the shell function <tt>add-zle-hook-widget</tt>
maintains a similar array and arranges for the special widget to invoke
those additional widgets.
</p>
<p><var>hook</var> is one of <tt>isearch-exit</tt>, <tt>isearch-update</tt>,
<tt>line-pre-redraw</tt>, <tt>line-init</tt>, <tt>line-finish</tt>, <tt>history-line-set</tt>,
or <tt>keymap-select</tt>, corresponding to each of the special widgets
<tt>zle-isearch-exit</tt>, etc.  The special widget names are also accepted
as the <var>hook</var> argument.
</p>
<p><var>widgetname</var> is the name of a ZLE widget.  If no options are given this
is added to the array of widgets to be invoked in the given hook context.
Widgets are invoked in the order they were added, with
</p><div class="example">
<pre class="example"><tt>zle </tt><var>widgetname</var><tt> -Nw -f &quot;nolast&quot; -- &quot;$@&quot;</tt>
</pre></div>

<a name="index-WIDGET_002c-in-hooks"></a>
<p>Note that this means that the &lsquo;<tt>WIDGET</tt>&rsquo; special parameter tracks the
<var>widgetname</var> when the widget function is called, rather than tracking
the name of the corresponding special hook widget.
</p>
<p>If the option <tt>-d</tt> is given, the <var>widgetname</var> is removed from
the array of widgets to be executed.
</p>
<p>If the option <tt>-D</tt> is given, the <var>widgetname</var> is treated as a pattern
and any matching names of widgets are removed from the array.
</p>
<p>If <var>widgetname</var> does not name an existing widget when added to the
array, it is assumed that a shell function also named <var>widgetname</var> is
meant to provide the implementation of the widget.  This name is therefore
marked for autoloading, and the options <tt>-U</tt>, <tt>-z</tt> and <tt>-k</tt> are
passed as arguments to <tt>autoload</tt> as with <tt>add-zsh-hook</tt>.  The
widget is also created with &lsquo;<tt>zle -N </tt><var>widgetname</var>&rsquo; to cause the
corresponding function to be loaded the first time the hook is called.
</p>
<p>The arrays of <var>widgetname</var> are currently maintained in <tt>zstyle</tt>
contexts, one for each <var>hook</var> context, with a style of &lsquo;<tt>widgets</tt>&rsquo;.
If the <tt>-L</tt> option is given, this set of styles is listed with
&lsquo;<tt>zstyle -L</tt>&rsquo;.  This implementation may change, and the special widgets
that refer to the styles are created only if <tt>add-zle-hook-widget</tt> is
called to add at least one widget, so if this function is used for any
hooks, then all hooks should be managed only via this function.
</p>
</dd>
</dl>

<hr>
<a name="Recent-Directories"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Manipulating-Hook-Functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-Contributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Installation-2" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="index-recent-directories_002c-maintaining-list-of"></a>
<a name="index-directories_002c-maintaining-list-of-recent"></a>
<a name="index-cdr"></a>
<a name="index-_005fcdr"></a>
<a name="index-chpwd_005frecent_005fadd"></a>
<a name="index-chpwd_005frecent_005fdirs"></a>
<a name="index-chpwd_005frecent_005ffilehandler"></a>

<a name="Remembering-Recent-Directories"></a>
<h2 class="section">26.3 Remembering Recent Directories</h2>

<p>The function <tt>cdr</tt> allows you to change the working directory to a
previous working directory from a list maintained automatically.  It is
similar in concept to the directory stack controlled by the <tt>pushd</tt>,
<tt>popd</tt> and <tt>dirs</tt> builtins, but is more configurable, and as it stores
all entries in files it is maintained across sessions and (by default)
between terminal emulators in the current session.  Duplicates are
automatically removed, so that the list reflects the single most recent
use of each directory.
</p>
<p>Note that the <tt>pushd</tt> directory stack is not actually modified or used
by <tt>cdr</tt> unless you configure it to do so as described in the
configuration section below.
</p>

<hr>
<a name="Installation-2"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Recent-Directories" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Recent-Directories" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Use" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.3.1 Installation</h3>

<p>The system works by means of a hook function that is called every time the
directory changes.  To install the system, autoload the required functions
and use the <tt>add-zsh-hook</tt> function described above:
</p>
<div class="example">
<pre class="example">autoload -Uz chpwd_recent_dirs cdr add-zsh-hook
add-zsh-hook chpwd chpwd_recent_dirs
</pre></div>

<p>Now every time you change directly interactively, no matter which
command you use, the directory to which you change will be remembered
in most-recent-first order.
</p>

<hr>
<a name="Use"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation-2" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Recent-Directories" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Options-2" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.3.2 Use</h3>

<p>All direct user interaction is via the <tt>cdr</tt> function.
</p>
<p>The argument to cdr is a number <var>N</var> corresponding to the <var>N</var>th most
recently changed-to directory.  1 is the immediately preceding directory;
the current directory is remembered but is not offered as a destination.
Note that if you have multiple windows open 1 may refer to a directory
changed to in another window; you can avoid this by having per-terminal
files for storing directory as described for the
<tt>recent-dirs-file</tt> style below.
</p>
<p>If you set the <tt>recent-dirs-default</tt> style described below <tt>cdr</tt>
will behave the same as <tt>cd</tt> if given a non-numeric argument, or more
than one argument.  The recent directory list is updated just the same
however you change directory.
</p>
<p>If the argument is omitted, 1 is assumed.  This is similar to <tt>pushd</tt>&rsquo;s
behaviour of swapping the two most recent directories on the stack.
</p>
<p>Completion for the argument to <tt>cdr</tt> is available if compinit has been
run; menu selection is recommended, using:
</p>
<div class="example">
<pre class="example">zstyle ':completion:*:*:cdr:*:*' menu selection
</pre></div>

<p>to allow you to cycle through recent directories; the order is preserved,
so the first choice is the most recent directory before the current one.
The verbose style is also recommended to ensure the directory is shown; this
style is on by default so no action is required unless you have changed it.
</p>

<hr>
<a name="Options-2"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Use" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Recent-Directories" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-1" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.3.3 Options</h3>

<p>The behaviour of <tt>cdr</tt> may be modified by the following options.
</p>
<dl compact="compact">
<dt><tt>-l</tt></dt>
<dd><p>lists the numbers and the corresponding directories in
abbreviated form (i.e. with <tt>~</tt> substitution reapplied), one per line.
The directories here are not quoted (this would only be an issue if a
directory name contained a newline).  This is used by the completion
system.
</p>
</dd>
<dt><tt>-r</tt></dt>
<dd><p>sets the variable <tt>reply</tt> to the current set of directories.  Nothing
is printed and the directory is not changed.
</p>
</dd>
<dt><tt>-e</tt></dt>
<dd><p>allows you to edit the list of directories, one per line.  The
list can be edited to any extent you like; no sanity checking is
performed.  Completion is available.  No quoting is necessary (except for
newlines, where I have in any case no sympathy); directories are in
unabbreviated form and contain an absolute path, i.e. they start with <tt>/</tt>.
Usually the first entry should be left as the current directory.
</p>
</dd>
<dt><tt>-p &rsquo;</tt><var>pattern</var><tt>&rsquo;</tt></dt>
<dd><p>Prunes any items in the directory list that match the given extended glob
pattern; the pattern needs to be quoted from immediate expansion on the
command line.  The pattern is matched against each completely expanded
file name in the list; the full string must match, so wildcards at the
end (e.g. <tt>&rsquo;*removeme*&rsquo;</tt>) are needed to remove entries with a given
substring.
</p>
<p>If output is to a terminal, then the function will print the new list
after pruning and prompt for confirmation by the user.  This output and
confirmation step can be skipped by using <tt>-P</tt> instead of <tt>-p</tt>.
</p>
</dd>
</dl>


<hr>
<a name="Configuration-1"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Options-2" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Recent-Directories" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Use-with-dynamic-directory-naming" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.3.4 Configuration</h3>

<p>Configuration is by means of the styles mechanism that should be familiar
from completion; if not, see the description of the <tt>zstyle</tt> command in
<a href="Zsh-Modules.html#The-zsh_002fzutil-Module">The zsh/zutil Module</a>.  The context for setting styles
should be <tt>&rsquo;:chpwd:*&rsquo;</tt> in case the meaning of the context is extended in
future, for example:
</p>
<div class="example">
<pre class="example">zstyle ':chpwd:*' recent-dirs-max 0
</pre></div>

<p>sets the value of the <tt>recent-dirs-max</tt> style to 0.  In practice the
style name is specific enough that a context of &rsquo;*&rsquo; should be fine.
</p>
<p>An exception is <tt>recent-dirs-insert</tt>, which is used exclusively by the
completion system and so has the usual completion system context
(<tt>&rsquo;:completion:*&rsquo;</tt> if nothing more specific is needed), though again
<tt>&rsquo;*&rsquo;</tt> should be fine in practice.
</p>
<dl compact="compact">
<dt><tt>recent-dirs-default</tt></dt>
<dd><p>If true, and the command is expecting a recent directory index, and
either there is more than one argument or the argument is not an
integer, then fall through to &quot;cd&quot;.  This allows the lazy to use only
one command for directory changing.  Completion recognises this, too;
see recent-dirs-insert for how to control completion when this option
is in use.
</p>
</dd>
<dt><tt>recent-dirs-file</tt></dt>
<dd><p>The file where the list of directories is saved.  The default
is <tt>${ZDOTDIR:-$HOME}/.chpwd-recent-dirs</tt>, i.e. this is in your
home directory unless you have set the variable <tt>ZDOTDIR</tt> to point
somewhere else.  Directory names are saved in <tt>$&rsquo;</tt><var>...</var><tt>&rsquo;</tt> quoted
form, so each line in the file can be supplied directly to the shell as an
argument.
</p>
<p>The value of this style may be an array.  In this case, the first
file in the list will always be used for saving directories while any
other files are left untouched.  When reading the recent directory
list, if there are fewer than the maximum number of entries in the
first file, the contents of later files in the array will be appended
with duplicates removed from the list shown.  The contents of the two
files are not sorted together, i.e. all the entries in the first file
are shown first.  The special value <tt>+</tt> can appear in the list to
indicate the default file should be read at that point.  This allows
effects like the following:
</p>
<div class="example">
<pre class="example">zstyle ':chpwd:*' recent-dirs-file \ 
~/.chpwd-recent-dirs-${TTY##*/} +
</pre></div>

<p>Recent directories are read from a file numbered according to
the terminal.  If there are insufficient entries the list
is supplemented from the default file.
</p>
<p>It is possible to use <tt>zstyle -e</tt> to make the directory configurable
at run time:
</p>
<div class="example">
<pre class="example">zstyle -e ':chpwd:*' recent-dirs-file pick-recent-dirs-file
pick-recent-dirs-file() {
  if [[ $PWD = ~/text/writing(|/*) ]]; then
    reply=(~/.chpwd-recent-dirs-writing)
  else
    reply=(+)
  fi
}
</pre></div>

<p>In this example, if the current directory is <tt>~/text/writing</tt> or a
directory under it, then use a special file for saving recent
directories, else use the default.
</p>
</dd>
<dt><tt>recent-dirs-insert</tt></dt>
<dd><p>Used by completion.  If <tt>recent-dirs-default</tt> is true, then setting
this to <tt>true</tt> causes the actual directory, rather than its index, to
be inserted on the command line; this has the same effect as using
the corresponding index, but makes the history clearer and the line
easier to edit.  With this setting, if part of an argument was
already typed, normal directory completion rather than recent
directory completion is done; this is because recent directory
completion is expected to be done by cycling through entries menu
fashion.
</p>
<p>If the value of the style is <tt>always</tt>, then only recent directories will
be completed; in that case, use the <tt>cd</tt> command when you want to
complete other directories.
</p>
<p>If the value is <tt>fallback</tt>, recent directories will be tried first, then
normal directory completion is performed if recent directory completion
failed to find a match.
</p>
<p>Finally, if the value is <tt>both</tt> then both sets of completions are
presented; the usual tag mechanism can be used to distinguish results, with
recent directories tagged as <tt>recent-dirs</tt>.  Note that the recent
directories inserted are abbreviated with directory names where appropriate.
</p>
</dd>
<dt><tt>recent-dirs-max</tt></dt>
<dd><p>The maximum number of directories to save to the file.  If
this is zero or negative there is no maximum.  The default is 20.
Note this includes the current directory, which isn&rsquo;t offered,
so the highest number of directories you will be offered
is one less than the maximum.
</p>
</dd>
<dt><tt>recent-dirs-prune</tt></dt>
<dd><p>This style is an array determining what directories should (or should
not) be added to the recent list.  Elements of the array can include:
</p>
<dl compact="compact">
<dt><tt>parent</tt></dt>
<dd><p>Prune parents (more accurately, ancestors) from the recent list.
If present, changing directly down by any number of directories
causes the current directory to be overwritten.  For example,
changing from ~pws to ~pws/some/other/dir causes ~pws not to be
left on the recent directory stack.  This only applies to direct
changes to descendant directories; earlier directories on the
list are not pruned.  For example, changing from ~pws/yet/another
to ~pws/some/other/dir does not cause ~pws to be pruned.
</p>
</dd>
<dt><tt>pattern:</tt><var>pattern</var></dt>
<dd><p>Gives a zsh pattern for directories that should not be
added to the recent list (if not already there).  This element
can be repeated to add different patterns.  For example,
<tt>&rsquo;pattern:/tmp(|/*)&rsquo;</tt> stops <tt>/tmp</tt> or its descendants
from being added.  The <tt>EXTENDED_GLOB</tt> option is always turned on
for these patterns.
</p>
</dd>
</dl>

</dd>
<dt><tt>recent-dirs-pushd</tt></dt>
<dd><p>If set to true, <tt>cdr</tt> will use <tt>pushd</tt> instead of <tt>cd</tt> to change the
directory, so the directory is saved on the directory stack.  As the
directory stack is completely separate from the list of files saved
by the mechanism used in this file there is no obvious reason to do
this.
</p>
</dd>
</dl>


<hr>
<a name="Use-with-dynamic-directory-naming"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-1" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Recent-Directories" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Details-of-directory-handling" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.3.5 Use with dynamic directory naming</h3>

<p>It is possible to refer to recent directories using the dynamic directory
name syntax by using the supplied function <tt>zsh_directory_name_cdr</tt>
a hook:
</p>
<div class="example">
<pre class="example">autoload -Uz add-zsh-hook
add-zsh-hook -Uz zsh_directory_name zsh_directory_name_cdr
</pre></div>

<p>When this is done, <tt>~[1]</tt> will refer to the most recent
directory other than $PWD, and so on.  Completion after <tt>~[</tt><var>...</var>
also works.
</p>

<hr>
<a name="Details-of-directory-handling"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Use-with-dynamic-directory-naming" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Recent-Directories" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Other-Directory-Functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.3.6 Details of directory handling</h3>

<p>This section is for the curious or confused; most users will not
need to know this information.
</p>
<p>Recent directories are saved to a file immediately and hence are
preserved across sessions.  Note currently no file locking is applied:
the list is updated immediately on interactive commands and nowhere else
(unlike history), and it is assumed you are only going to change
directory in one window at once.  This is not safe on shared accounts,
but in any case the system has limited utility when someone else is
changing to a different set of directories behind your back.
</p>
<p>To make this a little safer, only directory changes instituted from the
command line, either directly or indirectly through shell function calls
(but not through subshells, evals, traps, completion functions and the
like) are saved.  Shell functions should use <tt>cd -q</tt> or <tt>pushd -q</tt> to
avoid side effects if the change to the directory is to be invisible at the
command line.  See the contents of the function <tt>chpwd_recent_dirs</tt> for
more details.
</p>
<hr>
<a name="Other-Directory-Functions"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Details-of-directory-handling" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-Contributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Usage" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="index-directories_002c-named_002c-dynamic_002c-helper-function"></a>
<a name="index-dynamic-directory-naming_002c-helper-function"></a>
<a name="index-named-directories_002c-dynamic_002c-helper-function"></a>
<a name="index-zsh_005fdirectory_005fname_005fgeneric"></a>

<a name="Abbreviated-dynamic-references-to-directories"></a>
<h2 class="section">26.4 Abbreviated dynamic references to directories</h2>

<p>The dynamic directory naming system is described in the subsection
<em>Dynamic named directories</em> of
<a href="Expansion.html#Filename-Expansion">Filename Expansion</a>.  In this, a reference to
<tt>~[</tt><var>...</var><tt>]</tt> is expanded by a function found by the hooks
mechanism.
</p>
<p>The contributed function <tt>zsh_directory_name_generic</tt> provides a
system allowing the user to refer to directories with only a limited
amount of new code.  It supports all three of the standard interfaces
for directory naming: converting from a name to a directory, converting
in the reverse direction to find a short name, and completion of names.
</p>
<p>The main feature of this function is a path-like syntax,
combining abbreviations at multiple levels separated by &quot;:&quot;.
As an example, ~[g:p:s] might specify:
</p><dl compact="compact">
<dt><tt>g</tt></dt>
<dd><p>The top level directory for your git area.  This first component
has to match, or the function will return indicating another
directory name hook function should be tried.
</p>
</dd>
<dt><tt>p</tt></dt>
<dd><p>The name of a project within your git area.
</p>
</dd>
<dt><tt>s</tt></dt>
<dd><p>The source area within that project.
</p>
</dd>
</dl>
<p>This allows you to collapse references to long hierarchies to a very
compact form, particularly if the hierarchies are similar across different
areas of the disk.
</p>
<p>Name components may be completed: if a description is shown at the top
of the list of completions, it includes the path to which previous
components expand, while the description for an individual completion
shows the path segment it would add.  No additional configuration is
needed for this as the completion system is aware of the dynamic
directory name mechanism.
</p>

<hr>
<a name="Usage"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Other-Directory-Functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Other-Directory-Functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.4.1 Usage</h3>

<p>To use the function, first define a wrapper function for your specific
case.  We&rsquo;ll assume it&rsquo;s to be autoloaded.  This can have any name but
we&rsquo;ll refer to it as zdn_mywrapper.  This wrapper function will define
various variables and then call this function with the same arguments
that the wrapper function gets.  This configuration is described below.
</p>
<p>Then arrange for the wrapper to be run as a zsh_directory_name hook:
</p>
<div class="example">
<pre class="example">autoload -Uz add-zsh-hook zsh_directory_name_generic zdn_mywrapper
add-zsh-hook -U zsh_directory_name zdn_mywrapper
</pre></div>


<hr>
<a name="Configuration"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Other-Directory-Functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Complete-example" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.4.2 Configuration</h3>

<p>The wrapper function should define a local associative array zdn_top.
Alternatively, this can be set with a style called <tt>mapping</tt>.  The
context for the style is <tt>:zdn:</tt><var>wrapper-name</var> where
<var>wrapper-name</var> is the function calling zsh_directory_name_generic;
for example:
</p>
<div class="example">
<pre class="example">zstyle :zdn:zdn_mywrapper: mapping zdn_mywrapper_top
</pre></div>

<p>The keys in this associative array correspond to the first component of
the name.  The values are matching directories.  They may have an
optional suffix with a slash followed by a colon and the name of a
variable in the same format to give the next component.  (The slash
before the colon is to disambiguate the case where a colon is needed in
the path for a drive.  There is otherwise no syntax for escaping this,
so path components whose names start with a colon are not supported.)  A
special component <tt>:default:</tt> specifies a variable in the form
<tt>/:</tt><var>var</var> (the path section is ignored and so is usually empty)
that will be used for the next component if no variable is given for the
path.  Variables referred to within <tt>zdn_top</tt> have the same format as
<tt>zdn_top</tt> itself, but contain relative paths.
</p>
<p>For example,
</p>
<div class="example">
<pre class="example">local -A zdn_top=(
  g   ~/git
  ga  ~/alternate/git
  gs  /scratch/$USER/git/:second2
  :default: /:second1
)
</pre></div>

<p>This specifies the behaviour of a directory referred to as <tt>~[g:...]</tt>
or <tt>~[ga:...]</tt> or <tt>~[gs:...]</tt>.  Later path components are optional;
in that case <tt>~[g]</tt> expands to <tt>~/git</tt>, and so on.  <tt>gs</tt> expands
to <tt>/scratch/$USER/git</tt> and uses the associative array <tt>second2</tt> to
match the second component; <tt>g</tt> and <tt>ga</tt> use the associative array
<tt>second1</tt> to match the second component.
</p>
<p>When expanding a name to a directory, if the first component is not <tt>g</tt> or
<tt>ga</tt> or <tt>gs</tt>, it is not an error; the function simply returns 1 so that a
later hook function can be tried.  However, matching the first component
commits the function, so if a later component does not match, an error
is printed (though this still does not stop later hooks from being
executed).
</p>
<p>For components after the first, a relative path is expected, but note that
multiple levels may still appear.  Here is an example of <tt>second1</tt>:
</p>
<div class="example">
<pre class="example">local -A second1=(
  p   myproject
  s   somproject
  os  otherproject/subproject/:third
)
</pre></div>

<p>The path as found from <tt>zdn_top</tt> is extended with the matching
directory, so <tt>~[g:p]</tt> becomes <tt>~/git/myproject</tt>.  The slash between
is added automatically (it&rsquo;s not possible to have a later component
modify the name of a directory already matched).  Only <tt>os</tt> specifies
a variable for a third component, and there&rsquo;s no <tt>:default:</tt>, so it&rsquo;s
an error to use a name like <tt>~[g:p:x]</tt> or <tt>~[ga:s:y]</tt> because
there&rsquo;s nowhere to look up the <tt>x</tt> or <tt>y</tt>.
</p>
<p>The associative arrays need to be visible within this function; the
generic function therefore uses internal variable names beginning
<tt>_zdn_</tt> in order to avoid clashes.  Note that the variable <tt>reply</tt>
needs to be passed back to the shell, so should not be local in the
calling function.
</p>
<p>The function does not test whether directories assembled by component
actually exist; this allows the system to work across automounted
file systems.  The error from the command trying to use a non-existent
directory should be sufficient to indicate the problem.
</p>

<hr>
<a name="Complete-example"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Other-Directory-Functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Version-Control-Information" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.4.3 Complete example</h3>

<p>Here is a full fictitious but usable autoloadable definition of the
example function defined by the code above.  So <tt>~[gs:p:s]</tt> expands
to <tt>/scratch/$USER/git/myscratchproject/top/srcdir</tt> (with <tt>$USER</tt>
also expanded).
</p>
<div class="example">
<pre class="example">local -A zdn_top=(
  g   ~/git
  ga  ~/alternate/git
  gs  /scratch/$USER/git/:second2
  :default: /:second1
)

local -A second1=(
  p   myproject
  s   somproject
  os  otherproject/subproject/:third
)

local -A second2=(
  p   myscratchproject
  s   somescratchproject
)

local -A third=(
  s   top/srcdir
  d   top/documentation
)

# autoload not needed if you did this at initialisation...
autoload -Uz zsh_directory_name_generic
zsh_directory_name_generic &quot;$@
</pre></div>

<p>It is also possible to use global associative arrays, suitably named,
and set the style for the context of your wrapper function to
refer to this.  Then your set up code would contain the following:
</p>
<div class="example">
<pre class="example">typeset -A zdn_mywrapper_top=(...)
# ... and so on for other associative arrays ...
zstyle ':zdn:zdn_mywrapper:' mapping zdn_mywrapper_top
autoload -Uz add-zsh-hook zsh_directory_name_generic zdn_mywrapper
add-zsh-hook -U zsh_directory_name zdn_mywrapper
</pre></div>

<p>and the function <tt>zdn_mywrapper</tt> would contain only the following:
</p>
<div class="example">
<pre class="example">zsh_directory_name_generic &quot;$@&quot;
</pre></div>

<hr>
<a name="Version-Control-Information"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Complete-example" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-Contributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-Quickstart" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="Gathering-information-from-version-control-systems"></a>
<h2 class="section">26.5 Gathering information from version control systems</h2>
<a name="index-version-control-utility"></a>

<p>In a lot of cases, it is nice to automatically retrieve information from
version control systems (VCSs), such as subversion, CVS or git, to be able
to provide it to the user; possibly in the user&rsquo;s prompt. So that you can
instantly tell which branch you are currently on, for example.
</p>
<p>In order to do that, you may use the <tt>vcs_info</tt> function.
</p>
<p>The following VCSs are supported, showing the abbreviated name by which
they are referred to within the system:
</p><dl compact="compact">
<dt>Bazaar (<tt>bzr</tt>)</dt>
<dd><p><tt><a href="https://bazaar.canonical.com/">https://bazaar.canonical.com/</a></tt>
</p></dd>
<dt>Codeville (<tt>cdv</tt>)</dt>
<dd><p><tt><a href="http://freecode.com/projects/codeville/">http://freecode.com/projects/codeville/</a></tt>
</p></dd>
<dt>Concurrent Versioning System (<tt>cvs</tt>)</dt>
<dd><p><tt><a href="https://www.nongnu.org/cvs/">https://www.nongnu.org/cvs/</a></tt>
</p></dd>
<dt>Darcs (<tt>darcs</tt>)</dt>
<dd><p><tt><a href="http://darcs.net/">http://darcs.net/</a></tt>
</p></dd>
<dt>Fossil (<tt>fossil</tt>)</dt>
<dd><p><tt><a href="https://fossil-scm.org/">https://fossil-scm.org/</a></tt>
</p></dd>
<dt>Git (<tt>git</tt>)</dt>
<dd><p><tt><a href="https://git-scm.com/">https://git-scm.com/</a></tt>
</p></dd>
<dt>GNU arch (<tt>tla</tt>)</dt>
<dd><p><tt><a href="https://www.gnu.org/software/gnu-arch/">https://www.gnu.org/software/gnu-arch/</a></tt>
</p></dd>
<dt>Mercurial (<tt>hg</tt>)</dt>
<dd><p><tt><a href="https://www.mercurial-scm.org/">https://www.mercurial-scm.org/</a></tt>
</p></dd>
<dt>Monotone (<tt>mtn</tt>)</dt>
<dd><p><tt><a href="https://monotone.ca/">https://monotone.ca/</a></tt>
</p></dd>
<dt>Perforce (<tt>p4</tt>)</dt>
<dd><p><tt><a href="https://www.perforce.com/">https://www.perforce.com/</a></tt>
</p></dd>
<dt>Subversion (<tt>svn</tt>)</dt>
<dd><p><tt><a href="https://subversion.apache.org/">https://subversion.apache.org/</a></tt>
</p></dd>
<dt>SVK (<tt>svk</tt>)</dt>
<dd><p><tt><a href="https://svk.bestpractical.com/">https://svk.bestpractical.com/</a></tt>
</p></dd>
</dl>

<p>There is also support for the patch management system <tt>quilt</tt>
(<tt><a href="https://savannah.nongnu.org/projects/quilt">https://savannah.nongnu.org/projects/quilt</a></tt>). See
<a href="#vcs_005finfo-Quilt-Support">Quilt Support</a>
below for details.
</p>
<p>To load <tt>vcs_info</tt>:
</p>
<div class="example">
<pre class="example">autoload -Uz vcs_info
</pre></div>

<p>It can be used in any existing prompt, because it does not require any
specific <tt>$psvar</tt> entries to be available.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#vcs_005finfo-Quickstart">26.5.1 Quickstart</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#vcs_005finfo-Configuration">26.5.2 Configuration</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#vcs_005finfo-Oddities">26.5.3 Oddities</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#vcs_005finfo-Quilt-Support">26.5.4 Quilt Support</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#vcs_005finfo-API">26.5.5 Function Descriptions (Public API)</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#vcs_005finfo-Variables">26.5.6 Variable Description</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#vcs_005finfo-Hooks">26.5.7 Hooks in vcs_info</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#vcs_005finfo-Examples">26.5.8 Examples</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="vcs_005finfo-Quickstart"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Version-Control-Information" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Version-Control-Information" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-Configuration" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="Quickstart"></a>
<h3 class="subsection">26.5.1 Quickstart</h3>

<p>To get this feature working quickly (including colors), you can do the
following (assuming, you loaded <tt>vcs_info</tt> properly - see above):
</p>
<div class="example">
<pre class="example">zstyle ':vcs_info:*' actionformats \ 
    '%F{5}(%f%s%F{5})%F{3}-%F{5}[%F{2}%b%F{3}|%F{1}%a%F{5}]%f '
zstyle ':vcs_info:*' formats       \ 
    '%F{5}(%f%s%F{5})%F{3}-%F{5}[%F{2}%b%F{5}]%f '
zstyle ':vcs_info:(sv[nk]|bzr):*' branchformat '%b%F{1}:%F{3}%r'
precmd () { vcs_info }
PS1='%F{5}[%F{2}%n%F{5}] %F{3}%3~ ${vcs_info_msg_0_}%f%# '
</pre></div>

<p>Obviously, the last two lines are there for demonstration. You need to
call <tt>vcs_info</tt> from your <tt>precmd</tt> function. Once that is done you need
a <em>single quoted</em> <tt>&rsquo;${vcs_info_msg_0_}&rsquo;</tt> in your prompt.
</p>
<p>To be able to use <tt>&rsquo;${vcs_info_msg_0_}&rsquo;</tt> directly in your prompt like
this, you will need to have the <tt>PROMPT_SUBST</tt> option enabled.
</p>
<p>Now call the <tt>vcs_info_printsys</tt> utility from the command line:
</p>
<div class="example">
<pre class="example">% vcs_info_printsys
## list of supported version control backends:
## disabled systems are prefixed by a hash sign (#)
bzr
cdv
cvs
darcs
fossil
git
hg
mtn
p4
svk
svn
tla
## flavours (cannot be used in the enable or disable styles; they
## are enabled and disabled with their master [git-svn -&gt; git])
## they *can* be used in contexts: ':vcs_info:git-svn:*'.
git-p4
git-svn
hg-git
hg-hgsubversion
hg-hgsvn
</pre></div>

<p>You may not want all of these because there is no point in running the
code to detect systems you do not use.  So there is a way to disable
some backends altogether:
</p>
<div class="example">
<pre class="example">zstyle ':vcs_info:*' disable bzr cdv darcs mtn svk tla
</pre></div>

<p>You may also pick a few from that list and enable only those:
</p>
<div class="example">
<pre class="example">zstyle ':vcs_info:*' enable git cvs svn
</pre></div>

<p>If you rerun <tt>vcs_info_printsys</tt> after one of these commands, you will
see the backends listed in the <tt>disable</tt> style (or backends not in the
<tt>enable</tt> style - if you used that) marked as disabled by a hash sign.
That means the detection of these systems is skipped <em>completely</em>. No
wasted time there.
</p>
<hr>
<a name="vcs_005finfo-Configuration"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-Quickstart" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Version-Control-Information" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-Oddities" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="Configuration-3"></a>
<h3 class="subsection">26.5.2 Configuration</h3>

<p>The <tt>vcs_info</tt> feature can be configured via <tt>zstyle</tt>.
</p>
<p>First, the context in which we are working:
</p><div class="example">
<pre class="example">:vcs_info:<var>vcs-string</var>:<var>user-context</var>:<var>repo-root-name</var>
</pre></div>

<dl compact="compact">
<dt><var>vcs-string</var></dt>
<dd><p>is one of: <tt>git</tt>, <tt>git-svn</tt>, <tt>git-p4</tt>, <tt>hg</tt>, <tt>hg-git</tt>,
<tt>hg-hgsubversion</tt>, <tt>hg-hgsvn</tt>, <tt>darcs</tt>, <tt>bzr</tt>, <tt>cdv</tt>, <tt>mtn</tt>,
<tt>svn</tt>, <tt>cvs</tt>, <tt>svk</tt>, <tt>tla</tt>, <tt>p4</tt> or <tt>fossil</tt>.
This is followed by &lsquo;<tt>.quilt-</tt><var>quilt-mode</var>&rsquo; in Quilt mode
(see <a href="#vcs_005finfo-Quilt-Support">Quilt Support</a> for details)
and by &lsquo;<tt>+</tt><var>hook-name</var>&rsquo; while hooks are active
(see <a href="#vcs_005finfo-Hooks">Hooks in vcs_info</a> for details).
</p>

<p>Currently, hooks in quilt mode don&rsquo;t add the &lsquo;<tt>.quilt-</tt><var>quilt-mode</var>&rsquo; information.
This may change in the future.
</p>
</dd>
<dt><var>user-context</var></dt>
<dd><p>is a freely configurable string, assignable by
the user as the first argument to <tt>vcs_info</tt> (see its description
below).
</p>
</dd>
<dt><var>repo-root-name</var></dt>
<dd><p>is the name of a repository in which you want a
style to match. So, if you want a setting specific to <tt>/usr/src/zsh</tt>,
with that being a CVS checkout, you can set <var>repo-root-name</var> to
<tt>zsh</tt> to make it so.
</p>
</dd>
</dl>

<p>There are three special values for <var>vcs-string</var>: The first is named
<tt>-init-</tt>, that is in effect as long as there was no decision what VCS
backend to use. The second is <tt>-preinit-</tt>; it is used <em>before</em>
<tt>vcs_info</tt> is run, when initializing the data exporting variables. The
third special value is <tt>formats</tt> and is used by the <tt>vcs_info_lastmsg</tt>
for looking up its styles.
</p>
<p>The initial value of <var>repo-root-name</var> is <tt>-all-</tt> and it is replaced
with the actual name, as soon as it is known. Only use this part of the
context for defining the <tt>formats</tt>, <tt>actionformats</tt> or
<tt>branchformat</tt> styles, as it is guaranteed that <var>repo-root-name</var> is
set up correctly for these only. For all other styles, just use <tt>&rsquo;*&rsquo;</tt>
instead.
</p>
<p>There are two pre-defined values for <var>user-context</var>:
</p><dl compact="compact">
<dt><tt>default</tt></dt>
<dd><p>the one used if none is specified
</p></dd>
<dt><tt>command</tt></dt>
<dd><p>used by vcs_info_lastmsg to lookup its styles
</p></dd>
</dl>

<p>You can of course use <tt>&rsquo;:vcs_info:*&rsquo;</tt> to match all VCSs in all
user-contexts at once.
</p>
<p>This is a description of all styles that are looked up.
</p>
<dl compact="compact">
<dd><a name="index-formats"></a>
</dd>
<dt><tt>formats</tt></dt>
<dd><p>A list of formats, used when actionformats is not used
(which is most of the time).
</p>
<a name="index-actionformats"></a>
</dd>
<dt><tt>actionformats</tt></dt>
<dd><p>A list of formats, used if there is a special
action going on in your current repository; like an interactive rebase or
a merge conflict.
</p>
<a name="index-branchformat"></a>
</dd>
<dt><tt>branchformat</tt></dt>
<dd><p>Some backends replace <tt>%b</tt> in the formats and
actionformats styles above, not only by a branch name but also by a
revision number. This style lets you modify how that string should look.
</p>
<a name="index-nvcsformats"></a>
</dd>
<dt><tt>nvcsformats</tt></dt>
<dd><p>These &quot;formats&quot; are set when we didn&rsquo;t detect a version control system
for the current directory or <tt>vcs_info</tt> was disabled. This is useful if
you want <tt>vcs_info</tt> to completely take over the generation of your
prompt. You would do something like <tt>PS1=&rsquo;${vcs_info_msg_0_}&rsquo;</tt> to
accomplish that.
</p>
<a name="index-hgrevformat"></a>
</dd>
<dt><tt>hgrevformat</tt></dt>
<dd><p><tt>hg</tt> uses both a hash and a revision number to reference a specific
changeset in a repository. With this style you can format the revision
string (see <tt>branchformat</tt>) to include either or both. It&rsquo;s only
useful when <tt>get-revision</tt> is true. Note, the full 40-character revision id
is not available (except when using the <tt>use-simple</tt> option) because
executing hg more than once per prompt is too slow; you may customize this
behavior using hooks.
</p>
<a name="index-max_002dexports"></a>
</dd>
<dt><tt>max-exports</tt></dt>
<dd><p>Defines the maximum number of
<tt>vcs_info_msg_*_</tt> variables <tt>vcs_info</tt> will set.
</p>
<a name="index-enable-1"></a>
</dd>
<dt><tt>enable</tt></dt>
<dd><p>A list of backends you want to use. Checked in the <tt>-init-</tt> context. If
this list contains an item called <tt>NONE</tt> no backend is used at all and
<tt>vcs_info</tt> will do nothing. If this list contains <tt>ALL</tt>, <tt>vcs_info</tt>
will use all known backends. Only with <tt>ALL</tt> in <tt>enable</tt> will the
<tt>disable</tt> style have any effect. <tt>ALL</tt> and <tt>NONE</tt> are case insensitive.
</p>
<a name="index-disable-1"></a>
</dd>
<dt><tt>disable</tt></dt>
<dd><p>A list of VCSs you don&rsquo;t want <tt>vcs_info</tt> to test for
repositories (checked in the <tt>-init-</tt> context, too). Only used if
<tt>enable</tt> contains <tt>ALL</tt>.
</p>
<a name="index-disable_002dpatterns"></a>
</dd>
<dt><tt>disable-patterns</tt></dt>
<dd><p>A list of patterns that are checked against <tt>$PWD</tt>. If a pattern
matches, <tt>vcs_info</tt> will be disabled. This style is checked in the
<tt>:vcs_info:-init-:*:-all-</tt> context.
</p>
<p>Say, <tt>~/.zsh</tt> is a directory under version control, in which you do
not want <tt>vcs_info</tt> to be active, do:
</p><div class="example">
<pre class="example">zstyle ':vcs_info:*' disable-patterns &quot;${(b)HOME}/.zsh(|/*)&quot;
</pre></div>

<a name="index-use_002dquilt"></a>
</dd>
<dt><tt>use-quilt</tt></dt>
<dd><p>If enabled, the <tt>quilt</tt> support code is active in &lsquo;addon&rsquo; mode.
See <a href="#vcs_005finfo-Quilt-Support">Quilt Support</a> for details.
</p>
<a name="index-quilt_002dstandalone"></a>
</dd>
<dt><tt>quilt-standalone</tt></dt>
<dd><p>If enabled, &lsquo;standalone&rsquo; mode detection is attempted if no VCS is active
in a given directory. See <a href="#vcs_005finfo-Quilt-Support">Quilt Support</a> for details.
</p>
<a name="index-quilt_002dpatch_002ddir"></a>
</dd>
<dt><tt>quilt-patch-dir</tt></dt>
<dd><p>Overwrite the value of the <tt>$QUILT_PATCHES</tt> environment variable. See
<a href="#vcs_005finfo-Quilt-Support">Quilt Support</a> for details.
</p>
<a name="index-quiltcommand"></a>
</dd>
<dt><tt>quiltcommand</tt></dt>
<dd><p>When <tt>quilt</tt> itself is called in quilt support, the value of this style
is used as the command name.
</p>
<a name="index-check_002dfor_002dchanges"></a>
</dd>
<dt><tt>check-for-changes</tt></dt>
<dd><p>If enabled, this style causes the <tt>%c</tt> and <tt>%u</tt> format escapes to show
when the working directory has uncommitted changes. The strings displayed by
these escapes can be controlled via the <tt>stagedstr</tt> and <tt>unstagedstr</tt>
styles. The only backends that currently support this option are <tt>git</tt>,
<tt>hg</tt>, and <tt>bzr</tt> (the latter two only support unstaged).
</p>
<p>For this style to be evaluated with the <tt>hg</tt> backend, the <tt>get-revision</tt>
style needs to be set and the <tt>use-simple</tt> style needs to be unset. The
latter is the default; the former is not.
</p>
<p>With the <tt>bzr</tt> backend, <em>lightweight checkouts</em> only honor this style if
the <tt>use-server</tt> style is set.
</p>
<p>Note, the actions taken if this style is enabled are potentially expensive
(read: they may be slow, depending on how big the current repository is).
Therefore, it is disabled by default.
</p>
<a name="index-check_002dfor_002dstaged_002dchanges"></a>
</dd>
<dt><tt>check-for-staged-changes</tt></dt>
<dd><p>This style is like <tt>check-for-changes</tt>, but it never checks the worktree
files, only the metadata in the <tt>.${vcs}</tt> dir.  Therefore,
this style initializes only the <tt>%c</tt> escape (with <tt>stagedstr</tt>) but
not the <tt>%u</tt> escape.  This style is faster than <tt>check-for-changes</tt>.
</p>
<p>In the <tt>git</tt> backend, this style checks for changes in the index.
Other backends do not currently implement this style.
</p>
<p>This style is disabled by default.
</p>
<a name="index-stagedstr"></a>
</dd>
<dt><tt>stagedstr</tt></dt>
<dd><p>This string will be used in the <tt>%c</tt> escape if there are staged changes in
the repository.
</p>
<a name="index-unstagedstr"></a>
</dd>
<dt><tt>unstagedstr</tt></dt>
<dd><p>This string will be used in the <tt>%u</tt> escape if there are unstaged changes
in the repository.
</p>
<a name="index-command-2"></a>
</dd>
<dt><tt>command</tt></dt>
<dd><p>This style causes <tt>vcs_info</tt> to use the supplied string as the command
to use as the VCS&rsquo;s binary. Note, that setting this in &rsquo;<tt>:vcs_info:*</tt>&rsquo; is
not a good idea.
</p>
<p>If the value of this style is empty (which is the default), the used binary
name is the name of the backend in use (e.g. <tt>svn</tt> is used in an <tt>svn</tt>
repository).
</p>
<p>The <tt>repo-root-name</tt> part in the context is always the default <tt>-all-</tt>
when this style is looked up.
</p>
<p>For example, this style can be used to use binaries from non-default
installation directories. Assume, <tt>git</tt> is installed in /usr/bin but
your sysadmin installed a newer version in /usr/local/bin. Instead of
changing the order of your <tt>$PATH</tt> parameter, you can do this:
</p><div class="example">
<pre class="example">zstyle ':vcs_info:git:*:-all-' command /usr/local/bin/git
</pre></div>

<a name="index-use_002dserver"></a>
</dd>
<dt><tt>use-server</tt></dt>
<dd><p>This is used by the Perforce backend (<tt>p4</tt>) to decide if it should
contact the Perforce server to find out if a directory is managed
by Perforce.  This is the only reliable way of doing this, but runs
the risk of a delay if the server name cannot be found.  If the
server (more specifically, the <var>host</var><tt>:</tt><var>port</var> pair describing the
server) cannot be contacted, its name is put into the associative array
<tt>vcs_info_p4_dead_servers</tt> and is not contacted again during the session
until it is removed by hand.  If you do not set this style, the <tt>p4</tt>
backend is only usable if you have set the environment variable
<tt>P4CONFIG</tt> to a file name and have corresponding files in the root
directories of each Perforce client.  See comments in the function
<tt>VCS_INFO_detect_p4</tt> for more detail.
</p>
<p>The Bazaar backend (<tt>bzr</tt>) uses this to permit contacting the server
about lightweight checkouts, see the <tt>check-for-changes</tt> style.
</p>
<a name="index-use_002dsimple"></a>
</dd>
<dt><tt>use-simple</tt></dt>
<dd><p>If there are two different ways of gathering
information, you can select the simpler one by setting this style to true;
the default is to use the not-that-simple code, which is potentially a lot
slower but might be more accurate in all possible cases. This style is
used by the <tt>bzr</tt>, <tt>hg</tt>, and <tt>git</tt> backends. In the case of <tt>hg</tt> it will invoke
the external hexdump program to parse the binary dirstate cache file; this
method will not return the local revision number.
</p>
<a name="index-get_002drevision"></a>
</dd>
<dt><tt>get-revision</tt></dt>
<dd><p>If set to true, vcs_info goes the extra mile to figure out the revision of
a repository&rsquo;s work tree (currently for the <tt>git</tt> and <tt>hg</tt> backends,
where this kind of information is not always vital). For <tt>git</tt>, the
hash value of the currently checked out commit is available via the <tt>%i</tt>
expansion. With <tt>hg</tt>, the local revision number and the corresponding
global hash are available via <tt>%i</tt>.
</p>
<a name="index-get_002dmq"></a>
</dd>
<dt><tt>get-mq</tt></dt>
<dd><p>If set to true, the <tt>hg</tt> backend will look for a Mercurial Queue (<tt>mq</tt>)
patch directory. Information will be available via the &lsquo;<tt>%m</tt>&rsquo; replacement.
</p>
<a name="index-get_002dbookmarks"></a>
</dd>
<dt><tt>get-bookmarks</tt></dt>
<dd><p>If set to true, the <tt>hg</tt> backend will try to get a list of current
bookmarks. They will be available via the &lsquo;<tt>%m</tt>&rsquo; replacement.
</p>
<p>The default is to generate a comma-separated list of all bookmark names
that refer to the currently checked out revision.  If a bookmark is active,
its name is suffixed an asterisk and placed first in the list.
</p>
<a name="index-use_002dprompt_002descapes"></a>
</dd>
<dt><tt>use-prompt-escapes</tt></dt>
<dd><p>Determines if we assume that the assembled
string from <tt>vcs_info</tt> includes prompt escapes. (Used by
<tt>vcs_info_lastmsg</tt>.)
</p>
<a name="index-debug"></a>
</dd>
<dt><tt>debug</tt></dt>
<dd><p>Enable debugging output to track possible problems. Currently this style
is only used by <tt>vcs_info</tt>&rsquo;s hooks system.
</p>
<a name="index-hooks"></a>
</dd>
<dt><tt>hooks</tt></dt>
<dd><p>A list style that defines hook-function names. See <a href="#vcs_005finfo-Hooks">Hooks in vcs_info</a>
below for details.
</p>
<a name="index-patch_002dformat"></a>
<a name="index-nopatch_002dformat"></a>
</dd>
<dt><tt>patch-format</tt></dt>
<dt><tt>nopatch-format</tt></dt>
<dd><p>This pair of styles format the patch information used by the <tt>%m</tt> expando in
formats and actionformats for the <tt>git</tt> and <tt>hg</tt> backends.  The value is
subject to certain <tt>%</tt>-expansions described below.
The expanded value is made available in the global <tt>backend_misc</tt> array as
<tt>${backend_misc[patches]}</tt> (also if a <tt>set-patch-format</tt> hook is used).
</p>
<a name="index-get_002dunapplied"></a>
</dd>
<dt><tt>get-unapplied</tt></dt>
<dd><p>This boolean style controls whether a backend should attempt to gather a list
of unapplied patches (for example with Mercurial Queue patches).
</p>
<p>Used by the <tt>quilt</tt>, <tt>hg</tt>, and <tt>git</tt> backends.
</p>
</dd>
</dl>

<p>The default values for these styles in all contexts are:
</p>
<dl compact="compact">
<dt><tt>formats</tt></dt>
<dd><p>&quot; (%s)-[%b]%u%c-&quot;
</p></dd>
<dt><tt>actionformats</tt></dt>
<dd><p>&quot; (%s)-[%b|%a]%u%c-&quot;
</p></dd>
<dt><tt>branchformat</tt></dt>
<dd><p>&quot;%b:%r&quot; (for bzr, svn, svk and hg)
</p></dd>
<dt><tt>nvcsformats</tt></dt>
<dd><p>&quot;&quot;
</p></dd>
<dt><tt>hgrevformat</tt></dt>
<dd><p>&quot;%r:%h&quot;
</p></dd>
<dt><tt>max-exports</tt></dt>
<dd><p>2
</p></dd>
<dt><tt>enable</tt></dt>
<dd><p>ALL
</p></dd>
<dt><tt>disable</tt></dt>
<dd><p>(empty list)
</p></dd>
<dt><tt>disable-patterns</tt></dt>
<dd><p>(empty list)
</p></dd>
<dt><tt>check-for-changes</tt></dt>
<dd><p>false
</p></dd>
<dt><tt>check-for-staged-changes</tt></dt>
<dd><p>false
</p></dd>
<dt><tt>stagedstr</tt></dt>
<dd><p>(string: &quot;S&quot;)
</p></dd>
<dt><tt>unstagedstr</tt></dt>
<dd><p>(string: &quot;U&quot;)
</p></dd>
<dt><tt>command</tt></dt>
<dd><p>(empty string)
</p></dd>
<dt><tt>use-server</tt></dt>
<dd><p>false
</p></dd>
<dt><tt>use-simple</tt></dt>
<dd><p>false
</p></dd>
<dt><tt>get-revision</tt></dt>
<dd><p>false
</p></dd>
<dt><tt>get-mq</tt></dt>
<dd><p>true
</p></dd>
<dt><tt>get-bookmarks</tt></dt>
<dd><p>false
</p></dd>
<dt><tt>use-prompt-escapes</tt></dt>
<dd><p>true
</p></dd>
<dt><tt>debug</tt></dt>
<dd><p>false
</p></dd>
<dt><tt>hooks</tt></dt>
<dd><p>(empty list)
</p></dd>
<dt><tt>use-quilt</tt></dt>
<dd><p>false
</p></dd>
<dt><tt>quilt-standalone</tt></dt>
<dd><p>false
</p></dd>
<dt><tt>quilt-patch-dir</tt></dt>
<dd><p>empty - use <tt>$QUILT_PATCHES</tt>
</p></dd>
<dt><tt>quiltcommand</tt></dt>
<dd><p>quilt
</p></dd>
<dt><tt>patch-format</tt></dt>
<dd><p><var>backend dependent</var>
</p></dd>
<dt><tt>nopatch-format</tt></dt>
<dd><p><var>backend dependent</var>
</p></dd>
<dt><tt>get-unapplied</tt></dt>
<dd><p>false
</p></dd>
</dl>

<p>In normal <tt>formats</tt> and <tt>actionformats</tt> the following replacements are
done:
</p>
<dl compact="compact">
<dt><tt>%s</tt></dt>
<dd><p>The VCS in use (git, hg, svn, etc.).
</p></dd>
<dt><tt>%b</tt></dt>
<dd><p>Information about the current branch.
</p></dd>
<dt><tt>%a</tt></dt>
<dd><p>An identifier that describes the action. Only makes sense in
<tt>actionformats</tt>.
</p></dd>
<dt><tt>%i</tt></dt>
<dd><p>The current revision number or identifier. For <tt>hg</tt>
the <tt>hgrevformat</tt> style may be used to customize the output.
</p></dd>
<dt><tt>%c</tt></dt>
<dd><p>The string from the <tt>stagedstr</tt> style if there are staged
changes in the repository.
</p></dd>
<dt><tt>%u</tt></dt>
<dd><p>The string from the <tt>unstagedstr</tt> style if there are
unstaged changes in the repository.
</p></dd>
<dt><tt>%R</tt></dt>
<dd><p>The base directory of the repository.
</p></dd>
<dt><tt>%r</tt></dt>
<dd><p>The repository name. If <tt>%R</tt> is <tt>/foo/bar/repoXY</tt>, <tt>%r</tt>
is <tt>repoXY</tt>.
</p></dd>
<dt><tt>%S</tt></dt>
<dd><p>A subdirectory within a repository. If <tt>$PWD</tt> is
<tt>/foo/bar/repoXY/beer/tasty</tt>, <tt>%S</tt> is <tt>beer/tasty</tt>.
</p></dd>
</dl>
<dl compact="compact">
<dt><tt>%m</tt></dt>
<dd><p>A &quot;misc&quot; replacement. It is at the discretion of the backend to
decide what this replacement expands to.
</p>
<p>The <tt>hg</tt> and <tt>git</tt> backends use this expando to display patch information.
<tt>hg</tt> sources patch information from the <tt>mq</tt> extensions; <tt>git</tt> from in-progress
<tt>rebase</tt> and <tt>cherry-pick</tt> operations and from the <tt>stgit</tt> extension.  The <tt>patch-format</tt>
and <tt>nopatch-format</tt> styles control the generated string.  The former is used
when at least one patch from the patch queue has been applied, and the latter
otherwise.
</p>
<p>The <tt>hg</tt> backend displays bookmark information in this expando (in addition
to <tt>mq</tt> information).  See the <tt>get-mq</tt> and <tt>get-bookmarks</tt> styles.  Both
of these styles may be enabled at the same time.  If both are enabled, both
resulting strings will be shown separated by a semicolon (that cannot currently
be customized).
</p>
<p>The <tt>quilt</tt> &lsquo;standalone&rsquo; backend sets this expando to the same value as the
<tt>%Q</tt> expando.
</p>
</dd>
<dt><tt>%Q</tt></dt>
<dd><p>Quilt series information.
When quilt is used (either in &lsquo;addon&rsquo; mode or as a &lsquo;standalone&rsquo; backend),
this expando is set to the quilt series&rsquo; <tt>patch-format</tt> string.
The <tt>set-patch-format</tt> hook and <tt>nopatch-format</tt> style are honoured.
</p>
<p>See <a href="#vcs_005finfo-Quilt-Support">Quilt Support</a> below for details.
</p>
</dd>
</dl>

<p>In <tt>branchformat</tt> these replacements are done:
</p>
<dl compact="compact">
<dt><tt>%b</tt></dt>
<dd><p>The branch name. For <tt>hg</tt>, the branch name can include a
topic name.
</p></dd>
<dt><tt>%r</tt></dt>
<dd><p>The current revision number or the <tt>hgrevformat</tt> style for
<tt>hg</tt>.
</p></dd>
</dl>

<p>In <tt>hgrevformat</tt> these replacements are done:
</p>
<dl compact="compact">
<dt><tt>%r</tt></dt>
<dd><p>The current local revision number.
</p></dd>
<dt><tt>%h</tt></dt>
<dd><p>The current global revision identifier.
</p></dd>
</dl>

<p>In <tt>patch-format</tt> and <tt>nopatch-format</tt> these replacements are done:
</p>
<dl compact="compact">
<dt><tt>%p</tt></dt>
<dd><p>The name of the top-most applied patch; may be overridden by the <tt>applied-string</tt> hook.
</p></dd>
<dt><tt>%u</tt></dt>
<dd><p>The number of unapplied patches; may be overridden by the <tt>unapplied-string</tt> hook.
</p></dd>
<dt><tt>%n</tt></dt>
<dd><p>The number of applied patches.
</p></dd>
<dt><tt>%c</tt></dt>
<dd><p>The number of unapplied patches.
</p></dd>
<dt><tt>%a</tt></dt>
<dd><p>The number of all patches (<tt>%a = %n + %c</tt>).
</p></dd>
<dt><tt>%g</tt></dt>
<dd><p>The names of active <tt>mq</tt> guards (<tt>hg</tt> backend).
</p></dd>
<dt><tt>%G</tt></dt>
<dd><p>The number of active <tt>mq</tt> guards (<tt>hg</tt> backend).
</p></dd>
</dl>

<p>Not all VCS backends have to support all replacements. For <tt>nvcsformats</tt>
no replacements are performed at all, it is just a string.
</p>
<hr>
<a name="vcs_005finfo-Oddities"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-Configuration" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Version-Control-Information" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-Quilt-Support" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="Oddities"></a>
<h3 class="subsection">26.5.3 Oddities</h3>

<p>If you want to use the <tt>%b</tt> (bold off) prompt expansion in <tt>formats</tt>,
which expands <tt>%b</tt> itself, use <tt>%%b</tt>. That will cause the <tt>vcs_info</tt>
expansion to replace <tt>%%b</tt> with <tt>%b</tt>, so that zsh&rsquo;s prompt expansion
mechanism can handle it. Similarly, to hand down <tt>%b</tt> from
<tt>branchformat</tt>, use <tt>%%%%b</tt>. Sorry for this inconvenience, but it
cannot be easily avoided. Luckily we do not clash with a lot of prompt
expansions and this only needs to be done for those.
</p>
<p>When one of the <tt>gen-applied-string</tt>, <tt>gen-unapplied-string</tt>, and
<tt>set-patch-format</tt> hooks is defined,
applying <tt>%</tt>-escaping (&lsquo;<tt>foo=${foo//&rsquo;%&rsquo;/%%}</tt>&rsquo;) to the interpolated values
for use in the prompt is the responsibility of those hooks (jointly);
when neither of those hooks is defined, <tt>vcs_info</tt> handles escaping by itself.
We regret this coupling, but it was required for backwards compatibility.
</p>
<hr>
<a name="vcs_005finfo-Quilt-Support"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-Oddities" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Version-Control-Information" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-API" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="Quilt-Support"></a>
<h3 class="subsection">26.5.4 Quilt Support</h3>

<p><cite>Quilt</cite> is not a version control system, therefore this is not implemented
as a backend. It can help keeping track of a series of patches. People use it
to keep a set of changes they want to use on top of software packages (which
is tightly integrated into the package build process - the Debian project
does this for a large number of packages). Quilt can also help individual
developers keep track of their own patches on top of real version control
systems.
</p>
<p>The <tt>vcs_info</tt> integration tries to support both ways of using quilt by
having two slightly different modes of operation: &lsquo;addon&rsquo; mode and
&lsquo;standalone&rsquo; mode).
</p>
<p>Quilt integration is off by default; to enable it, set the <tt>use-quilt</tt> style,
and add <tt>%Q</tt> to your <tt>formats</tt> or <tt>actionformats</tt> style:
</p><div class="example">
<pre class="example">zstyle ':vcs_info:*' use-quilt true
</pre></div>

<p>Styles looked up from the Quilt support code include &lsquo;<tt>.quilt-</tt><var>quilt-mode</var>&rsquo;
in the <var>vcs-string</var> part of the context, where <var>quilt-mode</var> is either
<tt>addon</tt> or <tt>standalone</tt>.
Example: <tt>:vcs_info:git.quilt-addon:default:</tt><var>repo-root-name</var>.
</p>
<p>For &lsquo;addon&rsquo; mode to become active <tt>vcs_info</tt> must have already detected a
real version control system controlling the directory. If that is the case,
a directory that holds quilt&rsquo;s patches needs to be found. That directory is
configurable via the &lsquo;<tt>QUILT_PATCHES</tt>&rsquo; environment variable. If that
variable exists its value is used, otherwise the value &lsquo;<tt>patches</tt>&rsquo; is
assumed. The value from <tt>$QUILT_PATCHES</tt> can be overwritten using the
&lsquo;<tt>quilt-patch-dir</tt>&rsquo; style. (Note: you can use <tt>vcs_info</tt> to keep the value
of <tt>$QUILT_PATCHES</tt> correct all the time via the <tt>post-quilt</tt> hook).
</p>
<p>When the directory in question is found, quilt is assumed to be active. To
gather more information, <tt>vcs_info</tt> looks for a directory called &lsquo;.pc&rsquo;;
Quilt uses that directory to track its current state. If this directory does
not exist we know that quilt has not done anything to the working directory
(read: no patches have been applied yet).
</p>
<p>If patches are applied, <tt>vcs_info</tt> will try to find out which. If you want
to know which patches of a series are not yet applied, you need to activate
the <tt>get-unapplied</tt> style in the appropriate context.
</p>
<p><tt>vcs_info</tt> allows for very detailed control over how the gathered
information is presented (see 
<a href="#vcs_005finfo-Configuration">Configuration</a> and <a href="#vcs_005finfo-Hooks">Hooks in vcs_info</a>),
all of which are documented below. Note there are a number of
other patch tracking systems that work on top of a certain version control
system (like <tt>stgit</tt> for <cite>git</cite>, or <tt>mq</tt> for <cite>hg</cite>); the configuration
for systems like that are generally configured the same way as the <cite>quilt</cite>
support.
</p>
<p>If the <cite>quilt</cite> support is working in &lsquo;addon&rsquo; mode, the produced string is
available as a simple format replacement (<tt>%Q</tt> to be precise), which can
be used in <tt>formats</tt> and <tt>actionformats</tt>; see below for details).
</p>
<p>If, on the other hand, the support code is working in &lsquo;standalone&rsquo; mode,
<tt>vcs_info</tt> will pretend as if <tt>quilt</tt> were an actual version control
system. That means that the version control system identifier (which
otherwise would be something like &lsquo;svn&rsquo; or &lsquo;cvs&rsquo;) will be set to
&lsquo;<tt>-quilt-</tt>&rsquo;. This has implications on the used style context where this
identifier is the second element. <tt>vcs_info</tt> will have filled in a proper
value for the &quot;repository&rsquo;s&quot; root directory and the string containing the
information about quilt&rsquo;s state will be available as the &lsquo;misc&rsquo; replacement
(and <tt>%Q</tt> for compatibility with &lsquo;addon&rsquo; mode).
</p>
<p>What is left to discuss is how &lsquo;standalone&rsquo; mode is detected. The detection
itself is a series of searches for directories. You can have this detection
enabled all the time in every directory that is not otherwise under version
control. If you know there is only a limited set of trees where you would
like <tt>vcs_info</tt> to try and look for Quilt in &lsquo;standalone&rsquo; mode to minimise
the amount of searching on every call to <tt>vcs_info</tt>, there are a number of
ways to do that:
</p>
<p>Essentially, &lsquo;standalone&rsquo; mode detection is controlled by a style called
&lsquo;<tt>quilt-standalone</tt>&rsquo;. It is a string style and its value can have different
effects. The simplest values are: &lsquo;<tt>always</tt>&rsquo; to run detection every time
<tt>vcs_info</tt> is run, and &lsquo;<tt>never</tt>&rsquo; to turn the detection off entirely.
</p>
<p>If the value of <tt>quilt-standalone</tt> is something else, it is interpreted
differently. If the value is the name of a scalar variable the value of that
variable is checked and that value is used in the same &lsquo;always&rsquo;/&lsquo;never&rsquo; way
as described above.
</p>
<p>If the value of <tt>quilt-standalone</tt> is an array, the elements of that array
are used as directory names under which you want the detection to be active.
</p>
<p>If <tt>quilt-standalone</tt> is an associative array, the keys are taken as
directory names under which you want the detection to be active, but only if
the corresponding value is the string &lsquo;<tt>true</tt>&rsquo;.
</p>
<p>Last, but not least, if the value of <tt>quilt-standalone</tt> is the name of a
function, the function is called without arguments and the return value
decides whether detection should be active. A &lsquo;0&rsquo; return value is true; a
non-zero return value is interpreted as false.
</p>
<p>Note, if there is both a function and a variable by the name of
<tt>quilt-standalone</tt>, the function will take precedence.
</p>
<hr>
<a name="vcs_005finfo-API"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-Quilt-Support" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Version-Control-Information" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-Variables" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="Function-Descriptions-_0028Public-API_0029"></a>
<h3 class="subsection">26.5.5 Function Descriptions (Public API)</h3>

<dl compact="compact">
<dd><a name="index-vcs_005finfo"></a>
</dd>
<dt><tt>vcs_info</tt> [<var>user-context</var>]</dt>
<dd><p>The main function, that runs all backends and assembles all data into
<tt>${vcs_info_msg_*_}</tt>. This is the function you want to call from
<tt>precmd</tt> if you want to include up-to-date information in your prompt (see
<a href="#vcs_005finfo-Variables">Variable Description</a>
below).  If an argument is given, that string will be
used instead of <tt>default</tt> in the <var>user-context</var> field of the style
context.
</p>
<a name="index-vcs_005finfo_005fhookadd"></a>
</dd>
<dt><tt>vcs_info_hookadd</tt></dt>
<dd><p>Statically registers a number of functions to a given hook. The hook needs
to be given as the first argument; what follows is a list of hook-function
names to register to the hook. The &lsquo;<tt>+vi-</tt>&rsquo; prefix needs to be left out
here. See <a href="#vcs_005finfo-Hooks">Hooks in vcs_info</a>
below for details.
</p>
<a name="index-vcs_005finfo_005fhookdel"></a>
</dd>
<dt><tt>vcs_info_hookdel</tt></dt>
<dd><p>Remove hook-functions from a given hook. The hook needs to be given as the
first non-option argument; what follows is a list of hook-function
names to un-register from the hook. If &lsquo;<tt>-a</tt>&rsquo; is used as the first
argument, <tt>all</tt> occurrences of the functions are unregistered. Otherwise
only the last occurrence is removed (if a function was registered to a hook
more than once). The &lsquo;<tt>+vi-</tt>&rsquo; prefix needs to be left out here.
See <a href="#vcs_005finfo-Hooks">Hooks in vcs_info</a>
below for details.
</p>
<a name="index-vcs_005finfo_005flastmsg"></a>
</dd>
<dt><tt>vcs_info_lastmsg</tt></dt>
<dd><p>Outputs the current values of <tt>${vcs_info_msg_*_}</tt>.
Takes into account the value of the <tt>use-prompt-escapes</tt> style in
<tt>&rsquo;:vcs_info:formats:command:-all-&rsquo;</tt>. It also only prints <tt>max-exports</tt>
values.
</p>
<a name="index-vcs_005finfo_005fprintsys"></a>
</dd>
<dt><tt>vcs_info_printsys</tt> [<var>user-context</var>]</dt>
<dd><p>Prints a list of all
supported version control systems. Useful to find out possible contexts
(and which of them are enabled) or values for the <tt>disable</tt> style.
</p>
<a name="index-vcs_005finfo_005fsetsys"></a>
</dd>
<dt><tt>vcs_info_setsys</tt></dt>
<dd><p>Initializes <tt>vcs_info</tt>&rsquo;s internal list of
available backends. With this function, you can add support for new VCSs
without restarting the shell.
</p>
</dd>
</dl>

<p>All functions named <tt>VCS_INFO_*</tt> are for internal use only.
</p>
<hr>
<a name="vcs_005finfo-Variables"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-API" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Version-Control-Information" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-Hooks" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="Variable-Description"></a>
<h3 class="subsection">26.5.6 Variable Description</h3>

<dl compact="compact">
<dt><tt>${vcs_info_msg_</tt><var>N</var><tt>_}</tt> (Note the trailing underscore)</dt>
<dd><p>Where <var>N</var> is an integer, e.g., <tt>vcs_info_msg_0_</tt>. These variables
are the storage for the informational message the last <tt>vcs_info</tt> call
has assembled. These are strongly connected to the <tt>formats</tt>,
<tt>actionformats</tt> and <tt>nvcsformats</tt> styles described above. Those styles
are lists. The first member of that list gets expanded into
<tt>${vcs_info_msg_0_}</tt>, the second into <tt>${vcs_info_msg_1_}</tt>
and the Nth into <tt>${vcs_info_msg_N-1_}</tt>. (See the <tt>max-exports</tt>
style above.)
</p>
</dd>
</dl>

<p>All variables named <tt>VCS_INFO_*</tt> are for internal use only.
</p>
<hr>
<a name="vcs_005finfo-Hooks"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-Variables" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Version-Control-Information" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-Examples" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="Hooks-in-vcs_005finfo"></a>
<h3 class="subsection">26.5.7 Hooks in vcs_info</h3>

<p>Hooks are places in <tt>vcs_info</tt> where you can run your own code. That
code can communicate with the code that called it and through that,
change the system&rsquo;s behaviour.
</p>
<p>For configuration, hooks change the style context:
</p><div class="example">
<pre class="example">:vcs_info:<var>vcs-string</var>+<var>hook-name</var>:<var>user-context</var>:<var>repo-root-name</var>
</pre></div>

<p>To register functions to a hook, you need to list them in the <tt>hooks</tt>
style in the appropriate context.
</p>
<p>Example:
</p><div class="example">
<pre class="example">zstyle ':vcs_info:*+foo:*' hooks bar baz
</pre></div>

<p>This registers functions to the hook &lsquo;foo&rsquo; for all backends. In order to
avoid namespace problems, all registered function names are prepended by
a &lsquo;<tt>+vi-</tt>&rsquo;, so the actual functions called for the &lsquo;foo&rsquo; hook are
&lsquo;<tt>+vi-bar</tt>&rsquo; and &lsquo;<tt>+vi-baz</tt>&rsquo;.
</p>
<p>If you would like to register a function to a hook regardless of the
current context, you may use the <tt>vcs_info_hookadd</tt> function. To remove
a function that was added like that, the <tt>vcs_info_hookdel</tt> function
can be used.
</p>
<p>If something seems weird, you can enable the &lsquo;debug&rsquo; boolean style in
the proper context and the hook-calling code will print what it tried
to execute and whether the function in question existed.
</p>
<p>When you register more than one function to a hook, all functions are
executed one after another until one function returns non-zero or until
all functions have been called. Context-sensitive hook functions are
executed <tt>before</tt> statically registered ones (the ones added by
<tt>vcs_info_hookadd</tt>).
</p>
<p>You may pass data between functions via an associative array, <tt>user_data</tt>.
For example:
</p><div class="example">
<pre class="example">
+vi-git-myfirsthook(){
    user_data[myval]=$myval
}
+vi-git-mysecondhook(){
    # do something with ${user_data[myval]}
}
</pre></div>

<p>There are a number of variables that are special in hook contexts:
</p>
<dl compact="compact">
<dt><tt>ret</tt></dt>
<dd><p>The return value that the hooks system will return to the caller. The
default is an integer &lsquo;zero&rsquo;. If and how a changed <tt>ret</tt> value changes
the execution of the caller depends on the specific hook. See the hook
documentation below for details.
</p>
</dd>
<dt><tt>hook_com</tt></dt>
<dd><p>An associated array which is used for bidirectional communication from
the caller to hook functions. The used keys depend on the specific hook.
</p>
</dd>
<dt><tt>context</tt></dt>
<dd><p>The active context of the hook. Functions that wish to change this
variable should make it local scope first.
</p>
</dd>
<dt><tt>vcs</tt></dt>
<dd><p>The current VCS after it was detected. The same values as in the
enable/disable style are used. Available in all hooks except <tt>start-up</tt>.
</p>
</dd>
</dl>

<p>Finally, the full list of currently available hooks:
</p>
<dl compact="compact">
<dt><tt>start-up</tt></dt>
<dd><p>Called after starting <tt>vcs_info</tt> but before the VCS in this directory is
determined. It can be used to deactivate <tt>vcs_info</tt> temporarily if
necessary. When <tt>ret</tt> is set to <tt>1</tt>, <tt>vcs_info</tt> aborts and does
nothing; when set to <tt>2</tt>, <tt>vcs_info</tt> sets up everything as if no
version control were active and exits.
</p>
</dd>
<dt><tt>pre-get-data</tt></dt>
<dd><p>Same as <tt>start-up</tt> but after the VCS was detected.
</p>
</dd>
<dt><tt>gen-hg-bookmark-string</tt></dt>
<dd><p>Called in the Mercurial backend when a bookmark string is generated; the
<tt>get-revision</tt> and <tt>get-bookmarks</tt> styles must be true.
</p>
<p>This hook gets the names of the Mercurial bookmarks that
<tt>vcs_info</tt> collected from &lsquo;hg&rsquo;.
</p>
<p>If a bookmark is active, the key <tt>${hook_com[hg-active-bookmark]}</tt> is
set to its name.  The key is otherwise unset.
</p>
<p>When setting <tt>ret</tt> to non-zero, the string in
<tt>${hook_com[hg-bookmark-string]}</tt> will be used in the <tt>%m</tt> escape in
<tt>formats</tt> and <tt>actionformats</tt> and will be available in the global
<tt>backend_misc</tt> array as <tt>${backend_misc[bookmarks]}</tt>.
</p>
</dd>
<dt><tt>gen-applied-string</tt></dt>
<dd><p>Called in the <tt>git</tt> (with <tt>stgit</tt> or during rebase or merge), and <tt>hg</tt>
(with <tt>mq</tt>) backends and in <tt>quilt</tt> support when the <tt>applied-string</tt>
is generated; the <tt>use-quilt</tt> zstyle must be true for <tt>quilt</tt> (the <tt>mq</tt>
and <tt>stgit</tt> backends are active by default).
</p>
<p>The arguments to this hook describe applied patches 
in the opposite order, which means that the first argument is the
top-most patch and so forth.
</p>
<p>When the patches&rsquo; log messages can be extracted, those are embedded
within each argument after a space, so each argument is of the form
&lsquo;<var>patch-name</var> <var>first line of the log message</var>&rsquo;, where <var>patch-name</var>
contains no whitespace. The <tt>mq</tt> backend passes arguments of
the form &lsquo;<var>patch name</var>&rsquo;, with possible embedded spaces, but without
extracting the patch&rsquo;s log message.
</p>
<p>When setting <tt>ret</tt> to non-zero, the string in
<tt>${hook_com[applied-string]}</tt> will be
available as <tt>%p</tt> in the <tt>patch-format</tt> and <tt>nopatch-format</tt> styles.
This hook is, in concert with <tt>set-patch-format</tt>, responsible for
<tt>%</tt>-escaping that value for use in the prompt.
(See <a href="#vcs_005finfo-Oddities">Oddities</a>.)
</p>
<p>The <tt>quilt</tt> backend passes to this hook the inputs
<tt>${hook_com[quilt-patches-dir]}</tt> and, if it has been
determined, <tt>${hook_com[quilt-pc-dir]}</tt>.
</p>
</dd>
<dt><tt>gen-unapplied-string</tt></dt>
<dd><p>Called in the <tt>git</tt> (with <tt>stgit</tt> or during rebase), and <tt>hg</tt> (with
<tt>mq</tt>) backend and in <tt>quilt</tt> support when the <tt>unapplied-string</tt> is
generated; the <tt>get-unapplied</tt> style must be true.
</p>
<p>This hook gets the names of all unapplied patches which <tt>vcs_info</tt>
in order, which means that the first argument is
the patch next-in-line to be applied and so forth.
</p>
<p>The format of each argument is as for <tt>gen-applied-string</tt>, above.
</p>
<p>When setting <tt>ret</tt> to non-zero, the string in
<tt>${hook_com[unapplied-string]}</tt> will be available as <tt>%u</tt> in the
<tt>patch-format</tt> and <tt>nopatch-format</tt> styles.
This hook is, in concert with <tt>set-patch-format</tt>, responsible for
<tt>%</tt>-escaping that value for use in the prompt.
(See <a href="#vcs_005finfo-Oddities">Oddities</a>.)
</p>
<p>The <tt>quilt</tt> backend passes to this hook the inputs
<tt>${hook_com[quilt-patches-dir]}</tt> and, if it has been
determined, <tt>${hook_com[quilt-pc-dir]}</tt>.
</p>
</dd>
<dt><tt>gen-mqguards-string</tt></dt>
<dd><p>Called in the <tt>hg</tt> backend when <tt>guards-string</tt> is generated; the
<tt>get-mq</tt> style must be true (default).
</p>
<p>This hook gets the names of any active <tt>mq</tt> guards.
</p>
<p>When setting <tt>ret</tt> to non-zero, the string in
<tt>${hook_com[guards-string]}</tt> will be used in the <tt>%g</tt> escape in the
<tt>patch-format</tt> and <tt>nopatch-format</tt> styles.
</p>
</dd>
<dt><tt>no-vcs</tt></dt>
<dd><p>This hooks is called when no version control system was detected.
</p>
<p>The &lsquo;<tt>hook_com</tt>&rsquo; parameter is not used.
</p>
</dd>
<dt><tt>post-backend</tt></dt>
<dd><p>Called as soon as the backend has finished collecting information.
</p>
<p>The &lsquo;<tt>hook_com</tt>&rsquo; keys available are as for the <tt>set-message</tt> hook.
</p>
</dd>
<dt><tt>post-quilt</tt></dt>
<dd><p>Called after the <tt>quilt</tt> support is done. The following information
is passed as arguments to the hook: 1. the quilt-support mode (&lsquo;addon&rsquo; or
&lsquo;standalone&rsquo;); 2. the directory that contains the patch series; 3. the
directory that holds quilt&rsquo;s status information (the &lsquo;.pc&rsquo; directory) or
the string <tt>&quot;-nopc-&quot;</tt> if that directory wasn&rsquo;t found.
</p>
<p>The &lsquo;hook_com&rsquo; parameter is not used.
</p>
</dd>
<dt><tt>set-branch-format</tt></dt>
<dd><p>Called before &lsquo;<tt>branchformat</tt>&rsquo; is set. The only argument to the
hook is the format that is configured at this point.
</p>
<p>The &lsquo;<tt>hook_com</tt>&rsquo; keys considered are &lsquo;<tt>branch</tt>&rsquo; and &lsquo;<tt>revision</tt>&rsquo;.
They are set to the values figured out so far by <tt>vcs_info</tt> and any
change will be used directly when the actual replacement is done.
</p>
<p>If <tt>ret</tt> is set to non-zero, the string in
<tt>${hook_com[branch-replace]}</tt> will be used unchanged as the
&lsquo;<tt>%b</tt>&rsquo; replacement in the variables set by <tt>vcs_info</tt>.
</p>
</dd>
<dt><tt>set-hgrev-format</tt></dt>
<dd><p>Called before a &lsquo;<tt>hgrevformat</tt>&rsquo; is set. The only argument to the
hook is the format that is configured at this point.
</p>
<p>The &lsquo;<tt>hook_com</tt>&rsquo; keys considered are &lsquo;<tt>hash</tt>&rsquo; and &lsquo;<tt>localrev</tt>&rsquo;.
They are set to the values figured out so far by <tt>vcs_info</tt> and any
change will be used directly when the actual replacement is done.
</p>
<p>If <tt>ret</tt> is set to non-zero, the string in
<tt>${hook_com[rev-replace]}</tt> will be used unchanged as the
&lsquo;<tt>%i</tt>&rsquo; replacement in the variables set by <tt>vcs_info</tt>.
</p>
</dd>
<dt><tt>pre-addon-quilt</tt></dt>
<dd><p>This hook is used when <tt>vcs_info</tt>&rsquo;s quilt functionality is active in &quot;addon&quot;
mode (quilt used on top of a real version control system). It is activated
right before any quilt specific action is taken.
</p>
<p>Setting the &lsquo;<tt>ret</tt>&rsquo; variable in this hook to a non-zero value avoids any
quilt specific actions from being run at all.
</p>
</dd>
<dt><tt>set-patch-format</tt></dt>
<dd><p>This hook is used to control some of the possible expansions in
<tt>patch-format</tt> and <tt>nopatch-format</tt> styles with patch queue systems such as
quilt, mqueue and the like.
</p>
<p>This hook is used in the <tt>git</tt>, <tt>hg</tt> and <tt>quilt</tt> backends.
</p>
<p>The hook allows the control of the <tt>%p</tt> (<tt>${hook_com[applied]}</tt>) and <tt>%u</tt>
(<tt>${hook_com[unapplied]}</tt>) expansion in all backends that use the hook. With
the mercurial backend, the <tt>%g</tt> (<tt>${hook_com[guards]}</tt>) expansion is
controllable in addition to that.
</p>
<p>If <tt>ret</tt> is set to non-zero, the string in <tt>${hook_com[patch-replace]}</tt>
will be used unchanged instead of an expanded format from <tt>patch-format</tt> or
<tt>nopatch-format</tt>.
</p>
<p>This hook is, in concert with the <tt>gen-applied-string</tt> or
<tt>gen-unapplied-string</tt> hooks if they are defined, responsible for
<tt>%</tt>-escaping the final <tt>patch-format</tt> value for use in the prompt.
(See <a href="#vcs_005finfo-Oddities">Oddities</a>.)
</p>
<p>The <tt>quilt</tt> backend passes to this hook the inputs
<tt>${hook_com[quilt-patches-dir]}</tt> and, if it has been
determined, <tt>${hook_com[quilt-pc-dir]}</tt>.
</p>
</dd>
<dt><tt>set-message</tt></dt>
<dd><p>Called each time before a &lsquo;<tt>vcs_info_msg_</tt><var>N</var><tt>_</tt>&rsquo; message is set.
It takes two arguments; the first being the &lsquo;<var>N</var>&rsquo; in the message
variable name, the second is the currently configured <tt>formats</tt> or
<tt>actionformats</tt>.
</p>
<p>There are a number of &lsquo;<tt>hook_com</tt>&rsquo; keys, that are used here:
&lsquo;<tt>action</tt>&rsquo;, &lsquo;<tt>branch</tt>&rsquo;, &lsquo;<tt>base</tt>&rsquo;, &lsquo;<tt>base-name</tt>&rsquo;, &lsquo;<tt>subdir</tt>&rsquo;,
&lsquo;<tt>staged</tt>&rsquo;, &lsquo;<tt>unstaged</tt>&rsquo;, &lsquo;<tt>revision</tt>&rsquo;, &lsquo;<tt>misc</tt>&rsquo;, &lsquo;<tt>vcs</tt>&rsquo;
and one &lsquo;<tt>miscN</tt>&rsquo; entry for each backend-specific data field (<tt>N</tt>
starting at zero). They are set to the values figured out so far by
<tt>vcs_info</tt> and any change will be used directly when the actual
replacement is done.
</p>
<p>Since this hook is triggered multiple times (once for each configured
<tt>formats</tt> or <tt>actionformats</tt>), each of the &lsquo;<tt>hook_com</tt>&rsquo; keys mentioned
above (except for the <tt>miscN</tt> entries) has an &lsquo;<tt>_orig</tt>&rsquo; counterpart,
so even if you changed a value to your liking you can still get the
original value in the next run. Changing the &lsquo;<tt>_orig</tt>&rsquo; values is
probably not a good idea.
</p>
<p>If <tt>ret</tt> is set to non-zero, the string in
<tt>${hook_com[message]}</tt> will be used unchanged as the message by
<tt>vcs_info</tt>.
</p>
</dd>
</dl>

<p>If all of this sounds rather confusing, take a look at
<a href="#vcs_005finfo-Examples">Examples</a>
and also in the <tt>Misc/vcs_info-examples</tt> file in the Zsh source.
They contain some explanatory code.
</p>
<hr>
<a name="vcs_005finfo-Examples"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-Hooks" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Version-Control-Information" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Prompt-Themes" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="Examples-1"></a>
<h3 class="subsection">26.5.8 Examples</h3>

<p>Don&rsquo;t use <tt>vcs_info</tt> at all (even though it&rsquo;s in your prompt):
</p><div class="example">
<pre class="example">zstyle ':vcs_info:*' enable NONE
</pre></div>

<p>Disable the backends for <tt>bzr</tt> and <tt>svk</tt>:
</p><div class="example">
<pre class="example">zstyle ':vcs_info:*' disable bzr svk
</pre></div>

<p>Disable everything <em>but</em> <tt>bzr</tt> and <tt>svk</tt>:
</p><div class="example">
<pre class="example">zstyle ':vcs_info:*' enable bzr svk
</pre></div>

<p>Provide a special formats for <tt>git</tt>:
</p><div class="example">
<pre class="example">zstyle ':vcs_info:git:*' formats       ' GIT, BABY! [%b]'
zstyle ':vcs_info:git:*' actionformats ' GIT ACTION! [%b|%a]'
</pre></div>

<p>All <tt>%x</tt> expansion in all sorts of formats (<tt>formats</tt>, <tt>actionformats</tt>,
<tt>branchformat</tt>, you name it) are done using the &lsquo;<tt>zformat</tt>&rsquo; builtin from
the &lsquo;<tt>zsh/zutil</tt>&rsquo; module. That means you can do everything with these
<tt>%x</tt> items what zformat supports. In particular, if you want something
that is really long to have a fixed width, like a hash in a mercurial
branchformat, you can do this: <tt>%12.12i</tt>. That&rsquo;ll shrink the 40 character
hash to its 12 leading characters. The form is actually
&lsquo;<tt>%</tt><var>min</var><tt>.</tt><var>max</var><tt>x</tt>&rsquo;. More is possible.
See <a href="Zsh-Modules.html#The-zsh_002fzutil-Module">The zsh/zutil Module</a> for details.
</p>
<p>Use the quicker <tt>bzr</tt> backend
</p><div class="example">
<pre class="example">zstyle ':vcs_info:bzr:*' use-simple true
</pre></div>

<p>If you do use <tt>use-simple</tt>, please report if it does &lsquo;the-right-thing[tm]&rsquo;.
</p>
<p>Display the revision number in yellow for <tt>bzr</tt> and <tt>svn</tt>:
</p><div class="example">
<pre class="example">zstyle ':vcs_info:(svn|bzr):*' \ 
       branchformat '%b%%F{yellow}:%r'
</pre></div>

<p>The doubled percent sign is explained in
<a href="#vcs_005finfo-Oddities">Oddities</a>.
</p>
<p>Alternatively, one can use the raw colour codes directly:
</p>
<div class="example">
<pre class="example">zstyle ':vcs_info:(svn|bzr):*' \ 
       branchformat '%b%{'${fg[yellow]}'%}:%r'
</pre></div>

<p>Normally when a variable is interpolated into a format string, the variable
needs to be <tt>%</tt>-escaped. In this example we skipped that because we assume
the value of <tt>${fg[yellow]}</tt> doesn&rsquo;t contain any <tt>%</tt> signs.
</p>
<p>Make sure you enclose the color codes in <tt>%{</tt><var>...</var><tt>%}</tt>
if you want to use the string provided by <tt>vcs_info</tt> in prompts.
</p>
<p>Here is how to print the VCS information as a command (not in a prompt):
</p><div class="example">
<pre class="example">vcsi() { vcs_info interactive; vcs_info_lastmsg }
</pre></div>

<p>This way, you can even define different formats for output via
<tt>vcs_info_lastmsg</tt> in the &rsquo;<tt>:vcs_info:*:interactive:*</tt>&rsquo; namespace.
</p>
<p>Now as promised, some code that uses hooks:
say, you&rsquo;d like to replace the string &lsquo;svn&rsquo; by &lsquo;subversion&rsquo; in
<tt>vcs_info</tt>&rsquo;s <tt>%s</tt> <tt>formats</tt> replacement.
</p>
<p>First, we will tell <tt>vcs_info</tt> to call a function when populating
the message variables with the gathered information:
</p><div class="example">
<pre class="example">zstyle ':vcs_info:*+set-message:*' hooks svn2subversion
</pre></div>

<p>Nothing happens. Which is reasonable, since we didn&rsquo;t define the actual
function yet. To see what the hooks subsystem is trying to do, enable the
&lsquo;<tt>debug</tt>&rsquo; style:
</p><div class="example">
<pre class="example">zstyle ':vcs_info:*+*:*' debug true
</pre></div>

<p>That should give you an idea what is going on. Specifically, the function
that we are looking for is &lsquo;<tt>+vi-svn2subversion</tt>&rsquo;. Note, the &lsquo;<tt>+vi-</tt>&rsquo;
prefix. So, everything is in order, just as documented. When you are done
checking out the debugging output, disable it again:
</p><div class="example">
<pre class="example">zstyle ':vcs_info:*+*:*' debug false
</pre></div>

<p>Now, let&rsquo;s define the function:
</p><div class="example">
<pre class="example">
function +vi-svn2subversion() {
    [[ ${hook_com[vcs_orig]} == svn ]] &amp;&amp; hook_com[vcs]=subversion
}
</pre></div>

<p>Simple enough. And it could have even been simpler, if only we had
registered our function in a less generic context. If we do it only in
the &lsquo;<tt>svn</tt>&rsquo; backend&rsquo;s context, we don&rsquo;t need to test which the active
backend is:
</p><div class="example">
<pre class="example">zstyle ':vcs_info:svn+set-message:*' hooks svn2subversion
</pre></div>
<div class="example">
<pre class="example">
function +vi-svn2subversion() {
    hook_com[vcs]=subversion
}
</pre></div>

<p>And finally a little more elaborate example, that uses a hook to create
a customised bookmark string for the <tt>hg</tt> backend.
</p>
<p>Again, we start off by registering a function:
</p><div class="example">
<pre class="example">zstyle ':vcs_info:hg+gen-hg-bookmark-string:*' hooks hgbookmarks
</pre></div>

<p>And then we define the &lsquo;<tt>+vi-hgbookmarks</tt>&rsquo; function:
</p><div class="example">
<pre class="example">
function +vi-hgbookmarks() {
    # The default is to connect all bookmark names by
    # commas. This mixes things up a little.
    # Imagine, there's one type of bookmarks that is
    # special to you. Say, because it's *your* work.
    # Those bookmarks look always like this: &quot;sh/*&quot;
    # (because your initials are sh, for example).
    # This makes the bookmarks string use only those
    # bookmarks. If there's more than one, it
    # concatenates them using commas.
    # The bookmarks returned by `hg' are available in
    # the function's positional parameters.
    local s=&quot;${(Mj:,:)@:#sh/*}&quot;
    # Now, the communication with the code that calls
    # the hook functions is done via the hook_com[]
    # hash. The key at which the `gen-hg-bookmark-string'
    # hook looks is `hg-bookmark-string'. So:
    hook_com[hg-bookmark-string]=$s
    # And to signal that we want to use the string we
    # just generated, set the special variable `ret' to
    # something other than the default zero:
    ret=1
    return 0
}
</pre></div>

<p>Some longer examples and code snippets which might be useful are available in
the examples file located at Misc/vcs_info-examples in the Zsh source
directory.
</p>
<p>This concludes our guided tour through zsh&rsquo;s <tt>vcs_info</tt>.
</p>
<hr>
<a name="Prompt-Themes"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#vcs_005finfo-Examples" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-Contributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Installation-3" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="Prompt-Themes-1"></a>
<h2 class="section">26.6 Prompt Themes</h2>


<hr>
<a name="Installation-3"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Prompt-Themes" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Prompt-Themes" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Theme-Selection" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.6.1 Installation</h3>

<p>You should make sure all the functions from the <tt>Functions/Prompts</tt>
directory of the source distribution are available; they all begin with
the string &lsquo;<tt>prompt_</tt>&rsquo; except for the special function &lsquo;<tt>promptinit</tt>&rsquo;.
You also need the &lsquo;<tt>colors</tt>&rsquo; and &lsquo;<tt>add-zsh-hook</tt>&rsquo; functions from
<tt>Functions/Misc</tt>.
All these functions may already be installed on your system; if not,
you will need to find them and copy them.  The directory should appear as
one of the elements of the <tt>fpath</tt> array (this should already be the
case if they were installed), and at least the function <tt>promptinit</tt>
should be autoloaded; it will autoload the rest.  Finally, to initialize
the use of the system you need to call the <tt>promptinit</tt> function.  The
following code in your <tt>.zshrc</tt> will arrange for this; assume the
functions are stored in the directory <tt>~/myfns</tt>:
</p>
<div class="example">
<pre class="example">fpath=(~/myfns $fpath)
autoload -U promptinit
promptinit
</pre></div>


<hr>
<a name="Theme-Selection"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation-3" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Prompt-Themes" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Utility-Themes" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.6.2 Theme Selection</h3>

<p>Use the <tt>prompt</tt> command to select your preferred theme.  This command
may be added to your <tt>.zshrc</tt> following the call to <tt>promptinit</tt> in
order to start zsh with a theme already selected.
</p>
<dl compact="compact">
<dt><tt>prompt</tt> [ <tt>-c</tt> | <tt>-l</tt> ]</dt>
<dt><tt>prompt</tt> [ <tt>-p</tt> | <tt>-h</tt> ] [ <var>theme</var> ... ]</dt>
<dt><tt>prompt</tt> [ <tt>-s</tt> ] <var>theme</var> [ <var>arg</var> ... ]</dt>
<dd><p>Set or examine the prompt theme.  With no options and a <var>theme</var>
argument, the theme with that name is set as the current theme.  The
available themes are determined at run time; use the <tt>-l</tt> option to see
a list.  The special <var>theme</var> &lsquo;<tt>random</tt>&rsquo; selects at random one of the
available themes and sets your prompt to that.
</p>
<p>In some cases the <var>theme</var> may be modified by one or more arguments,
which should be given after the theme name.  See the help for each theme
for descriptions of these arguments.
</p>
<p>Options are:
</p>
<dl compact="compact">
<dt><tt>-c</tt></dt>
<dd><p>Show the currently selected theme and its parameters, if any.
</p></dd>
<dt><tt>-l</tt></dt>
<dd><p>List all available prompt themes.
</p></dd>
<dt><tt>-p</tt></dt>
<dd><p>Preview the theme named by <var>theme</var>, or all themes if no
<var>theme</var> is given.
</p></dd>
<dt><tt>-h</tt></dt>
<dd><p>Show help for the theme named by <var>theme</var>, or for the
<tt>prompt</tt> function if no <var>theme</var> is given.
</p></dd>
<dt><tt>-s</tt></dt>
<dd><p>Set <var>theme</var> as the current theme and save state.
</p></dd>
</dl>

</dd>
<dt><tt>prompt_</tt><var>theme</var><tt>_setup</tt></dt>
<dd><p>Each available <var>theme</var> has a setup function which is called by the
<tt>prompt</tt> function to install that theme.  This function may define
other functions as necessary to maintain the prompt, including functions
used to preview the prompt or provide help for its use.  You should not
normally call a theme&rsquo;s setup function directly.
</p>
</dd>
</dl>


<hr>
<a name="Utility-Themes"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Theme-Selection" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Prompt-Themes" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Themes" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.6.3 Utility Themes</h3>

<dl compact="compact">
<dt><tt>prompt off</tt></dt>
<dd><p>The theme &lsquo;<tt>off</tt>&rsquo; sets all the prompt variables to minimal values with
no special effects.
</p>
</dd>
<dt><tt>prompt default</tt></dt>
<dd><p>The theme &lsquo;<tt>default</tt>&rsquo; sets all prompt variables to the same state as
if an interactive zsh was started with no initialization files.
</p>
</dd>
<dt><tt>prompt restore</tt></dt>
<dd><p>The special theme &lsquo;<tt>restore</tt>&rsquo; erases all theme settings and sets prompt
variables to their state before the first time the &lsquo;<tt>prompt</tt>&rsquo; function
was run, provided each theme has properly defined its cleanup (see below).
</p>
<p>Note that you can undo &lsquo;<tt>prompt off</tt>&rsquo; and &lsquo;<tt>prompt default</tt>&rsquo; with
&lsquo;<tt>prompt restore</tt>&rsquo;, but a second restore does not undo the first.
</p>
</dd>
</dl>


<hr>
<a name="Writing-Themes"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Utility-Themes" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Prompt-Themes" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#ZLE-Functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.6.4 Writing Themes</h3>

<p>The first step for adding your own theme is to choose a name for it,
and create a file &lsquo;<tt>prompt_<var>name</var>_setup</tt>&rsquo; in a directory in your
<tt>fpath</tt>, such as <tt>~/myfns</tt> in the example above.  The file should
at minimum contain assignments for the prompt variables that your
theme wishes to modify.  By convention, themes use <tt>PS1</tt>, <tt>PS2</tt>,
<tt>RPS1</tt>, etc., rather than the longer <tt>PROMPT</tt> and <tt>RPROMPT</tt>.
</p>
<p>The file is autoloaded as a function in the current shell context, so
it may contain any necessary commands to customize your theme, including
defining additional functions.  To make some complex tasks easier, your
setup function may also do any of the following:
</p>
<dl compact="compact">
<dt>Assign <tt>prompt_opts</tt></dt>
<dd><p>The array <tt>prompt_opts</tt> may be assigned any of <tt>&quot;bang&quot;</tt>, <tt>&quot;cr&quot;</tt>,
<tt>&quot;percent&quot;</tt>, <tt>&quot;sp&quot;</tt>, and/or <tt>&quot;subst&quot;</tt> as values.  The corresponding
setopts (<tt>promptbang</tt>, etc.) are turned on, all other prompt-related
options are turned off.  The <tt>prompt_opts</tt> array preserves setopts even
beyond the scope of <tt>localoptions</tt>, should your function need that.
</p>
</dd>
<dt>Modify hooks</dt>
<dd><p>Use of <tt>add-zsh-hook</tt> and <tt>add-zle-hook-widget</tt> is recommended (see
the <cite>Manipulating Hook Functions</cite> section above).
All hooks that follow the naming pattern <tt>prompt_</tt><var>theme</var><tt>_</tt><var>hook</var>
are automatically removed when the prompt theme changes or is disabled.
</p>
</dd>
<dt>Declare cleanup</dt>
<dd><p>If your function makes any other changes that should be undone when the
theme is disabled, your setup function may call
</p>
<div class="example">
<pre class="example">prompt_cleanup <var>command</var>
</pre></div>

<p>where <var>command</var> should be suitably quoted.  If your theme is ever
disabled or replaced by another, <var>command</var> is executed with <tt>eval</tt>.
You may declare more than one such cleanup hook.
</p>
</dd>
<dt>Define preview</dt>
<dd><p>Define or autoload a function <tt>prompt_</tt><var>name</var><tt>_preview</tt> to display
a simulated version of your prompt.  A simple default previewer is
defined by <tt>promptinit</tt> for themes that do not define their own.
This preview function is called by &lsquo;<tt>prompt -p</tt>&rsquo;.
</p>
</dd>
<dt>Provide help</dt>
<dd><p>Define or autoload a function <tt>prompt_</tt><var>name</var><tt>_help</tt> to display
documentation or help text for your theme.
This help function is called by &lsquo;<tt>prompt -h</tt>&rsquo;.
</p>
</dd>
</dl>

<hr>
<a name="ZLE-Functions"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Writing-Themes" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-Contributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Widgets" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="ZLE-Functions-1"></a>
<h2 class="section">26.7 ZLE Functions</h2>


<hr>
<a name="Widgets"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ZLE-Functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ZLE-Functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Utility-Functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.7.1 Widgets</h3>

<p>These functions all implement user-defined ZLE widgets (see
<a href="Zsh-Line-Editor.html#Zsh-Line-Editor">Zsh Line Editor</a>) which can be bound to keystrokes in interactive shells.  To use them,
your <tt>.zshrc</tt> should contain lines of the form
</p>
<div class="example">
<pre class="example">autoload <var>function</var>
zle -N <var>function</var>
</pre></div>

<p>followed by an appropriate <tt>bindkey</tt> command to associate the function
with a key sequence.  Suggested bindings are described below.
</p>
<dl compact="compact">
<dt>bash-style word functions</dt>
<dd><p>If you are looking for functions to implement moving over and editing
words in the manner of bash, where only alphanumeric characters are
considered word characters, you can use the functions described in
the next section.  The following is sufficient:
</p>
<div class="example">
<pre class="example">autoload -U select-word-style
select-word-style bash
</pre></div>


<a name="index-forward_002dword_002dmatch"></a>
<a name="index-backward_002dword_002dmatch"></a>
<a name="index-kill_002dword_002dmatch"></a>
<a name="index-backward_002dkill_002dword_002dmatch"></a>
<a name="index-transpose_002dwords_002dmatch"></a>
<a name="index-capitalize_002dword_002dmatch"></a>
<a name="index-up_002dcase_002dword_002dmatch"></a>
<a name="index-down_002dcase_002dword_002dmatch"></a>
<a name="index-delete_002dwhole_002dword_002dmatch"></a>
<a name="index-select_002dword_002dmatch"></a>
<a name="index-select_002dword_002dstyle"></a>
<a name="index-match_002dword_002dcontext"></a>
<a name="index-match_002dwords_002dby_002dstyle"></a>
</dd>
<dt><tt>forward-word-match</tt>, <tt>backward-word-match</tt></dt>
<dt><tt>kill-word-match</tt>, <tt>backward-kill-word-match</tt></dt>
<dt><tt>transpose-words-match</tt>, <tt>capitalize-word-match</tt></dt>
<dt><tt>up-case-word-match</tt>, <tt>down-case-word-match</tt></dt>
<dt><tt>delete-whole-word-match</tt>, <tt>select-word-match</tt></dt>
<dt><tt>select-word-style</tt>, <tt>match-word-context</tt>, <tt>match-words-by-style</tt></dt>
<dd><p>The first eight &lsquo;<tt>-match</tt>&rsquo; functions are drop-in replacements for the
builtin widgets without the suffix.  By default they behave in a similar
way.  However, by the use of styles and the function <tt>select-word-style</tt>,
the way words are matched can be altered. <tt>select-word-match</tt> is intended
to be used as a text object in vi mode but with custom word styles. For
comparison, the widgets described in <a href="Zsh-Line-Editor.html#Text-Objects">Text Objects</a> use fixed definitions of words, compatible
with the <tt>vim</tt> editor.
</p>
<p>The simplest way of configuring the functions is to use
<tt>select-word-style</tt>, which can either be called as a normal function with
the appropriate argument, or invoked as a user-defined widget that will
prompt for the first character of the word style to be used.  The first
time it is invoked, the first eight <tt>-match</tt> functions will automatically
replace the builtin versions, so they do not need to be loaded explicitly.
</p>
<p>The word styles available are as follows.  Only the first character
is examined.
</p>
<dl compact="compact">
<dt><tt>bash</tt></dt>
<dd><p>Word characters are alphanumeric characters only.
</p>
</dd>
<dt><tt>normal</tt></dt>
<dd><p>As in normal shell operation:  word characters are alphanumeric characters
plus any characters present in the string given by the parameter
<tt>$WORDCHARS</tt>.
</p>
</dd>
<dt><tt>shell</tt></dt>
<dd><p>Words are complete shell command arguments, possibly including complete
quoted strings, or any tokens special to the shell.
</p>
</dd>
<dt><tt>whitespace</tt></dt>
<dd><p>Words are any set of characters delimited by whitespace.
</p>
</dd>
<dt><tt>default</tt></dt>
<dd><p>Restore the default settings; this is usually the same as &lsquo;<tt>normal</tt>&rsquo;.
</p>
</dd>
</dl>

<p>All but &lsquo;<tt>default</tt>&rsquo; can be input as an upper case character, which has
the same effect but with subword matching turned on.  In this case, words
with upper case characters are treated specially: each separate run of
upper case characters, or an upper case character followed by any number of
other characters, is considered a word.  The style <tt>subword-range</tt>
can supply an alternative character range to the default &lsquo;<tt>[:upper:]</tt>&rsquo;;
the value of the style is treated as the contents of a &lsquo;<tt>[</tt><var>...</var><tt>]</tt>&rsquo;
pattern (note that the outer brackets should not be supplied, only
those surrounding named ranges).
</p>
<p>More control can be obtained using the <tt>zstyle</tt> command, as described in
<a href="Zsh-Modules.html#The-zsh_002fzutil-Module">The zsh/zutil Module</a>.  Each style is looked up in the
context <tt>:zle:</tt><var>widget</var> where <var>widget</var> is the name of the
user-defined widget, not the name of the function implementing it, so in
the case of the definitions supplied by <tt>select-word-style</tt> the
appropriate contexts are <tt>:zle:forward-word</tt>, and so on.  The function
<tt>select-word-style</tt> itself always defines styles for the context
&lsquo;<tt>:zle:*</tt>&rsquo; which can be overridden by more specific (longer) patterns as
well as explicit contexts.
</p>
<p>The style <tt>word-style</tt> specifies the rules to use.  This may have the
following values.
</p>
<dl compact="compact">
<dt><tt>normal</tt></dt>
<dd><p>Use the standard shell rules, i.e. alphanumerics and <tt>$WORDCHARS</tt>, unless
overridden by the styles <tt>word-chars</tt> or <tt>word-class</tt>.
</p>
</dd>
<dt><tt>specified</tt></dt>
<dd><p>Similar to <tt>normal</tt>, but <em>only</em> the specified characters, and not also
alphanumerics, are considered word characters.
</p>
</dd>
<dt><tt>unspecified</tt></dt>
<dd><p>The negation of specified.  The given characters are those which will
<em>not</em> be considered part of a word.
</p>
</dd>
<dt><tt>shell</tt></dt>
<dd><p>Words are obtained by using the syntactic rules for generating shell
command arguments.  In addition, special tokens which are never command
arguments such as &lsquo;<tt>()</tt>&rsquo; are also treated as words.
</p>
</dd>
<dt><tt>whitespace</tt></dt>
<dd><p>Words are whitespace-delimited strings of characters.
</p>
</dd>
</dl>

<p>The first three of those rules usually use <tt>$WORDCHARS</tt>, but the value
in the parameter can be overridden by the style <tt>word-chars</tt>, which works
in exactly the same way as <tt>$WORDCHARS</tt>.  In addition, the style
<tt>word-class</tt> uses character class syntax to group characters and takes
precedence over <tt>word-chars</tt> if both are set.  The <tt>word-class</tt> style
does not include the surrounding brackets of the character class; for
example, &lsquo;<tt>-:[:alnum:]</tt>&rsquo; is a valid <tt>word-class</tt> to include all
alphanumerics plus the characters &lsquo;<tt>-</tt>&rsquo; and &lsquo;<tt>:</tt>&rsquo;.  Be careful
including &lsquo;<tt>]</tt>&rsquo;, &lsquo;<tt>^</tt>&rsquo; and &lsquo;<tt>-</tt>&rsquo; as these are special inside
character classes.
</p>
<p><tt>word-style</tt> may also have &lsquo;<tt>-subword</tt>&rsquo; appended to its value to
turn on subword matching, as described above.
</p>
<p>The style <tt>skip-chars</tt> is mostly useful for
<tt>transpose-words</tt> and similar functions.  If set, it gives a count of
characters starting at the cursor position which will not be considered
part of the word and are treated as space, regardless of what they actually
are.  For example, if
</p>
<div class="example">
<pre class="example">zstyle ':zle:transpose-words' skip-chars 1
</pre></div>

<p>has been set, and <tt>transpose-words-match</tt> is called with the cursor on
the <var>X</var> of <tt>foo</tt><var>X</var><tt>bar</tt>, where <var>X</var> can be any character, then
the resulting expression is <tt>bar</tt><var>X</var><tt>foo</tt>.
</p>
<p>Finer grained control can be obtained by setting the style <tt>word-context</tt>
to an array of pairs of entries.  Each pair of entries consists of a
<var>pattern</var> and a <var>subcontext</var>.  The shell argument the cursor is on is
matched against each <var>pattern</var> in turn until one matches; if it does,
the context is extended by a colon and the corresponding <var>subcontext</var>.
Note that the test is made against the original word on the line, with no
stripping of quotes.  Special handling is done between words: the current
context is examined and if it contains the string <tt>between</tt> the word
is set to a single space; else if it is contains the string <tt>back</tt>,
the word before the cursor is considered, else the word after cursor is
considered. Some examples are given below.
</p>
<p>The style <tt>skip-whitespace-first</tt> is only used with the
<tt>forward-word</tt> widget.  If it is set to true, then <tt>forward-word</tt>
skips any non-word-characters, followed by any non-word-characters:
this is similar to the behaviour of other word-orientated widgets,
and also that used by other editors, however it differs from the
standard zsh behaviour.  When using <tt>select-word-style</tt> the widget
is set in the context <tt>:zle:*</tt> to <tt>true</tt> if the word style is
<tt>bash</tt> and <tt>false</tt> otherwise.  It may be overridden by setting it in
the more specific context <tt>:zle:forward-word*</tt>.
</p>
<p>It is possible to create widgets with specific behaviour by defining
a new widget implemented by the appropriate generic function, then
setting a style for the context of the specific widget.  For example,
the following defines a widget <tt>backward-kill-space-word</tt> using
<tt>backward-kill-word-match</tt>, the generic widget implementing
<tt>backward-kill-word</tt> behaviour, and ensures that the new widget
always implements space-delimited behaviour.
</p>
<div class="example">
<pre class="example">zle -N backward-kill-space-word backward-kill-word-match
zstyle :zle:backward-kill-space-word word-style space
</pre></div>

<p>The widget <tt>backward-kill-space-word</tt> can now be bound to a key.
</p>
<p>Here are some further examples of use of the styles, actually taken from the
simplified interface in <tt>select-word-style</tt>:
</p>
<div class="example">
<pre class="example">zstyle ':zle:*' word-style standard
zstyle ':zle:*' word-chars ''
</pre></div>

<p>Implements bash-style word handling for all widgets, i.e. only
alphanumerics are word characters; equivalent to setting
the parameter <tt>WORDCHARS</tt> empty for the given context.
</p>
<div class="example">
<pre class="example">style ':zle:*kill*' word-style space
</pre></div>

<p>Uses space-delimited words for widgets with the word &lsquo;kill&rsquo; in the name.
Neither of the styles <tt>word-chars</tt> nor <tt>word-class</tt> is used in this case.
</p>
<p>Here are some examples of use of the <tt>word-context</tt> style to extend
the context.
</p>
<div class="example">
<pre class="example">zstyle ':zle:*' word-context \ 
       &quot;*/*&quot; filename &quot;[[:space:]]&quot; whitespace
zstyle ':zle:transpose-words:whitespace' word-style shell
zstyle ':zle:transpose-words:filename' word-style normal
zstyle ':zle:transpose-words:filename' word-chars ''
</pre></div>

<p>This provides two different ways of using <tt>transpose-words</tt> depending on
whether the cursor is on whitespace between words or on a filename, here
any word containing a <tt>/</tt>.  On whitespace, complete arguments as defined
by standard shell rules will be transposed.  In a filename, only
alphanumerics will be transposed.  Elsewhere, words will be transposed
using the default style for <tt>:zle:transpose-words</tt>.
</p>
<p>The word matching and all the handling of <tt>zstyle</tt> settings is actually
implemented by the function <tt>match-words-by-style</tt>.  This can be used to
create new user-defined widgets.  The calling function should set the local
parameter <tt>curcontext</tt> to <tt>:zle:</tt><var>widget</var>, create the local
parameter <tt>matched_words</tt> and call <tt>match-words-by-style</tt> with no
arguments.  On return, <tt>matched_words</tt> will be set to an array with the
elements: (1) the start of the line (2) the word before the cursor (3) any
non-word characters between that word and the cursor (4) any non-word
character at the cursor position plus any remaining non-word characters
before the next word, including all characters specified by the
<tt>skip-chars</tt> style, (5) the word at or following the cursor (6) any
non-word characters following that word (7) the remainder of the line.  Any
of the elements may be an empty string; the calling function should test
for this to decide whether it can perform its function.
</p>
<p>If the variable <tt>matched_words</tt> is defined by the caller to
<tt>match-words-by-style</tt> as an associative array (<tt>local -A
matched_words</tt>), then the seven values given above should be retrieved
from it as elements named <tt>start</tt>, <tt>word-before-cursor</tt>,
<tt>ws-before-cursor</tt>, <tt>ws-after-cursor</tt>, <tt>word-after-cursor</tt>,
<tt>ws-after-word</tt>, and <tt>end</tt>.  In addition the element
<tt>is-word-start</tt> is 1 if the cursor is on the start of a word or
subword, or on white space before it (the cases can be distinguished by
testing the <tt>ws-after-cursor</tt> element) and 0 otherwise.  This form is
recommended for future compatibility.
</p>
<p>It is possible to pass options with arguments to <tt>match-words-by-style</tt>
to override the use of styles.  The options are:
</p><dl compact="compact">
<dt><tt>-w</tt></dt>
<dd><p><var>word-style</var>
</p></dd>
<dt><tt>-s</tt></dt>
<dd><p><var>skip-chars</var>
</p></dd>
<dt><tt>-c</tt></dt>
<dd><p><var>word-class</var>
</p></dd>
<dt><tt>-C</tt></dt>
<dd><p><var>word-chars</var>
</p></dd>
<dt><tt>-r</tt></dt>
<dd><p><var>subword-range</var>
</p></dd>
</dl>

<p>For example, <tt>match-words-by-style -w shell -c 0</tt> may be used to
extract the command argument around the cursor.
</p>
<p>The <tt>word-context</tt> style is implemented by the function
<tt>match-word-context</tt>.  This should not usually need to be called
directly.
</p>
<a name="index-bracketed_002dpaste_002dmagic"></a>
</dd>
<dt><tt>bracketed-paste-magic</tt></dt>
<dd><p>The <tt>bracketed-paste</tt> widget (see <a href="Zsh-Line-Editor.html#Miscellaneous">Miscellaneous</a> in <a href="Zsh-Line-Editor.html#Standard-Widgets">Standard Widgets</a>)
inserts pasted text literally into the editor buffer rather than interpret
it as keystrokes.  This disables some common usages where the self-insert
widget is replaced in order to accomplish some extra processing.  An
example is the contributed <tt>url-quote-magic</tt> widget described below.
</p>
<p>The <tt>bracketed-paste-magic</tt> widget is meant to replace <tt>bracketed-paste</tt>
with a wrapper that re-enables these self-insert actions, and other
actions as selected by zstyles.  Therefore this widget is installed with
</p>
<div class="example">
<pre class="example">autoload -Uz bracketed-paste-magic
zle -N bracketed-paste bracketed-paste-magic
</pre></div>

<p>Other than enabling some widget processing, <tt>bracketed-paste-magic</tt>
attempts to replicate <tt>bracketed-paste</tt> as faithfully as possible.
</p>
<p>The following zstyles may be set to control processing of pasted text.
All are looked up in the context &lsquo;<tt>:bracketed-paste-magic</tt>&rsquo;.
</p>
<dl compact="compact">
<dt><tt>active-widgets</tt></dt>
<dd><p>A list of patterns matching widget names that should be activated during
the paste.  All other key sequences are processed as self-insert-unmeta.
The default is &lsquo;<tt>self-*</tt>&rsquo; so any user-defined widgets named with that
prefix are active along with the builtin self-insert.
</p>
<p>If this style is not set (explicitly deleted) or set to an empty value,
no widgets are active and the pasted text is inserted literally.  If the
value includes &lsquo;<tt>undefined-key</tt>&rsquo;, any unknown sequences are discarded
from the pasted text.
</p>
</dd>
<dt><tt>inactive-keys</tt></dt>
<dd><p>The inverse of <tt>active-widgets</tt>, a list of key sequences that always use
<tt>self-insert-unmeta</tt> even when bound to an active widget.  Note that
this is a list of literal key sequences, not patterns.
</p>
</dd>
<dt><tt>paste-init</tt></dt>
<dd><p>A list of function names, called in widget context (but not as widgets).
The functions are called in order until one of them returns a non-zero
status.  The parameter &lsquo;<tt>PASTED</tt>&rsquo; contains the initial state of the
pasted text.  All other ZLE parameters such as &lsquo;<tt>BUFFER</tt>&rsquo; have their
normal values and side-effects, and full history is available, so for
example <tt>paste-init</tt> functions may move words from <tt>BUFFER</tt> into
<tt>PASTED</tt> to make those words visible to the <tt>active-widgets</tt>.
</p>
<p>A non-zero return from a <tt>paste-init</tt> function does <em>not</em> prevent the
paste itself from proceeding.
</p>
<p>Loading <tt>bracketed-paste-magic</tt> defines <tt>backward-extend-paste</tt>, a
helper function for use in <tt>paste-init</tt>.
</p>
<div class="example">
<pre class="example">zstyle :bracketed-paste-magic paste-init \ 
       backward-extend-paste
</pre></div>

<p>When a paste would insert into the middle of a word or append text to a
word already on the line, <tt>backward-extend-paste</tt> moves the prefix
from <tt>LBUFFER</tt> into <tt>PASTED</tt> so that the <tt>active-widgets</tt> see the
full word so far.  This may be useful with <tt>url-quote-magic</tt>.
</p>
</dd>
<dt><tt>paste-finish</tt></dt>
<dd><p>Another list of function names called in order until one returns non-zero.
These functions are called <em>after</em> the pasted text has been processed
by the <tt>active-widgets</tt>, but <em>before</em> it is inserted into &lsquo;<tt>BUFFER</tt>&rsquo;.
ZLE parameters have their normal values and side-effects.
</p>
<p>A non-zero return from a <tt>paste-finish</tt> function does <em>not</em> prevent
the paste itself from proceeding.
</p>
<p>Loading <tt>bracketed-paste-magic</tt> also defines <tt>quote-paste</tt>, a helper
function for use in <tt>paste-finish</tt>.
</p>
<div class="example">
<pre class="example">zstyle :bracketed-paste-magic paste-finish \ 
       quote-paste
zstyle :bracketed-paste-magic:finish quote-style \ 
       qqq
</pre></div>

<p>When the pasted text is inserted into <tt>BUFFER</tt>, it is quoted per the
<tt>quote-style</tt> value.  To forcibly turn off the built-in numeric prefix
quoting of <tt>bracketed-paste</tt>, use:
</p>
<div class="example">
<pre class="example">zstyle :bracketed-paste-magic:finish quote-style \ 
       none
</pre></div>

</dd>
</dl>

<p><em>Important:</em> During <tt>active-widgets</tt> processing of the paste (after
<tt>paste-init</tt> and before <tt>paste-finish</tt>), <tt>BUFFER</tt> starts empty and
history is restricted, so cursor motions, etc., may not pass outside of
the pasted content.  Text assigned to <tt>BUFFER</tt> by the active widgets
is copied back into <tt>PASTED</tt> before <tt>paste-finish</tt>.
</p>
<a name="index-copy_002dearlier_002dword"></a>
</dd>
<dt><tt>copy-earlier-word</tt></dt>
<dd><p>This widget works like a combination of <tt>insert-last-word</tt> and
<tt>copy-prev-shell-word</tt>.  Repeated invocations of the widget retrieve
earlier words on the relevant history line.  With a numeric argument
<var>N</var>, insert the <var>N</var>th word from the history line; <var>N</var> may be
negative to count from the end of the line.
</p>
<p>If <tt>insert-last-word</tt> has been used to retrieve the last word on a
previous history line, repeated invocations will replace that word with
earlier words from the same line.
</p>
<p>Otherwise, the widget applies to words on the line currently being edited.
The <tt>widget</tt> style can be set to the name of another widget that should
be called to retrieve words.  This widget must accept the same three
arguments as <tt>insert-last-word</tt>.
</p>
<a name="index-cycle_002dcompletion_002dpositions"></a>
</dd>
<dt><tt>cycle-completion-positions</tt></dt>
<dd><p>After inserting an unambiguous string into the command line, the new
function based completion system may know about multiple places in
this string where characters are missing or differ from at least one
of the possible matches.  It will then place the cursor on the
position it considers to be the most interesting one, i.e. the one
where one can disambiguate between as many matches as possible with as 
little typing as possible.
</p>
<p>This widget allows the cursor to be easily moved to the other interesting
spots.  It can be invoked repeatedly to cycle between all positions
reported by the completion system.
</p>
<a name="index-delete_002dwhole_002dword_002dmatch-1"></a>
</dd>
<dt><tt>delete-whole-word-match</tt></dt>
<dd><p>This is another function which works like the <tt>-match</tt> functions
described immediately above, i.e. using styles to decide the word
boundaries.  However, it is not a replacement for any existing function.
</p>
<p>The basic behaviour is to delete the word around the cursor.  There is no
numeric argument handling; only the single word around the cursor is
considered.  If the widget contains the string <tt>kill</tt>, the removed text
will be placed in the cutbuffer for future yanking.  This can be obtained
by defining <tt>kill-whole-word-match</tt> as follows:
</p>
<div class="example">
<pre class="example">zle -N kill-whole-word-match delete-whole-word-match
</pre></div>

<p>and then binding the widget <tt>kill-whole-word-match</tt>.
</p>
<a name="index-down_002dline_002dor_002dbeginning_002dsearch"></a>
<a name="index-up_002dline_002dor_002dbeginning_002dsearch"></a>
</dd>
<dt><tt>up-line-or-beginning-search</tt>, <tt>down-line-or-beginning-search</tt></dt>
<dd><p>These widgets are similar to the builtin functions <tt>up-line-or-search</tt>
and <tt>down-line-or-search</tt>:  if in a multiline buffer they move up or
down within the buffer, otherwise they search for a history line matching
the start of the current line.  In this case, however, they search for
a line which matches the current line up to the current cursor position, in
the manner of <tt>history-beginning-search-backward</tt> and <tt>-forward</tt>, rather
than the first word on the line.
</p>
<a name="index-edit_002dcommand_002dline"></a>
</dd>
<dt><tt>edit-command-line</tt></dt>
<dd><p>Edit the command line using your visual editor, as in <tt>ksh</tt>.
</p>
<div class="example">
<pre class="example">bindkey -M vicmd v edit-command-line
</pre></div>

<p>The editor to be used can also be specified using the <tt>editor</tt> style in
the context of the widget. It is specified as an array of command and
arguments:
</p>
<div class="example">
<pre class="example">zstyle :zle:edit-command-line editor gvim -f
</pre></div>

<a name="index-expand_002dabsolute_002dpath"></a>
</dd>
<dt><tt>expand-absolute-path</tt></dt>
<dd><p>Expand the file name under the cursor to an absolute path, resolving
symbolic links.  Where possible, the initial path segment is turned
into a named directory or reference to a user&rsquo;s home directory.
</p>
<a name="index-history_002dbeginning_002dsearch_002dbackward_002dend"></a>
<a name="index-history_002dbeginning_002dsearch_002dforward_002dend"></a>
</dd>
<dt><tt>history-search-end</tt></dt>
<dd><p>This function implements the widgets
<tt>history-beginning-search-backward-end</tt> and
<tt>history-beginning-search-forward-end</tt>.  These commands work by first
calling the corresponding builtin widget (see
<a href="Zsh-Line-Editor.html#History-Control">History Control</a>) and then moving the cursor to the end of the line.  The original cursor
position is remembered and restored before calling the builtin widget a
second time, so that the same search is repeated to look farther through
the history.
</p>
<p>Although you <tt>autoload</tt> only one function, the commands to use it are
slightly different because it implements two widgets.
</p>
<div class="example">
<pre class="example">zle -N history-beginning-search-backward-end \ 
       history-search-end
zle -N history-beginning-search-forward-end \ 
       history-search-end
bindkey '\e^P' history-beginning-search-backward-end
bindkey '\e^N' history-beginning-search-forward-end
</pre></div>

<a name="index-history_002dbeginning_002dsearch_002dmenu"></a>
</dd>
<dt><tt>history-beginning-search-menu</tt></dt>
<dd><p>This function implements yet another form of history searching.  The
text before the cursor is used to select lines from the history,
as for <tt>history-beginning-search-backward</tt> except that all matches are
shown in a numbered menu.  Typing the appropriate digits inserts the
full history line.  Note that leading zeroes must be typed (they are only
shown when necessary for removing ambiguity).  The entire history is
searched; there is no distinction between forwards and backwards.
</p>
<p>With a numeric argument, the search is not anchored to the start of
the line; the string typed by the use may appear anywhere in the line
in the history.
</p>
<p>If the widget name contains &lsquo;<tt>-end</tt>&rsquo; the cursor is moved to the end of
the line inserted.  If the widget name contains &lsquo;<tt>-space</tt>&rsquo; any space
in the text typed is treated as a wildcard and can match anything (hence
a leading space is equivalent to giving a numeric argument).  Both
forms can be combined, for example:
</p>
<div class="example">
<pre class="example">zle -N history-beginning-search-menu-space-end \ 
       history-beginning-search-menu
</pre></div>

<a name="index-history_002dpattern_002dsearch"></a>
<a name="index-history_002dpattern_002dsearch_002dbackward"></a>
<a name="index-history_002dpattern_002dsearch_002dforward"></a>
</dd>
<dt><tt>history-pattern-search</tt></dt>
<dd><p>The function <tt>history-pattern-search</tt> implements widgets which prompt
for a pattern with which to search the history backwards or forwards.  The
pattern is in the usual zsh format, however the first character may be
<tt>^</tt> to anchor the search to the start of the line, and the last character
may be <tt>$</tt> to anchor the search to the end of the line.  If the
search was not anchored to the end of the line the cursor is positioned
just after the pattern found.
</p>
<p>The commands to create bindable widgets are similar to those in the
example immediately above:
</p>
<div class="example">
<pre class="example">autoload -U history-pattern-search
zle -N history-pattern-search-backward history-pattern-search
zle -N history-pattern-search-forward history-pattern-search
</pre></div>

<a name="index-incarg"></a>
<a name="index-incarg_002c-use-of"></a>
</dd>
<dt><tt>incarg</tt></dt>
<dd><p>Typing the keystrokes for this widget with the cursor placed on or to the
left of an integer causes that integer to be incremented by one.  With a
numeric argument, the number is incremented by the amount of the
argument (decremented if the numeric argument is negative).  The shell
parameter <tt>incarg</tt> may be set to change the default increment to
something other than one.
</p>
<div class="example">
<pre class="example">bindkey '^X+' incarg
</pre></div>

<a name="index-incremental_002dcomplete_002dword"></a>
</dd>
<dt><tt>incremental-complete-word</tt></dt>
<dd><p>This allows incremental completion of a word.  After starting this
command, a list of completion choices can be shown after every character
you type, which you can delete with <tt>^H</tt> or <tt>DEL</tt>.  Pressing return
accepts the completion so far and returns you to normal editing (that is,
the command line is <em>not</em> immediately executed).  You can hit <tt>TAB</tt> to
do normal completion, <tt>^G</tt> to abort back to the state when you started,
and <tt>^D</tt> to list the matches.
</p>
<p>This works only with the new function based completion system.
</p>
<div class="example">
<pre class="example">bindkey '^Xi' incremental-complete-word
</pre></div>

<a name="index-insert_002dcomposed_002dchar"></a>
</dd>
<dt><tt>insert-composed-char</tt></dt>
<dd><p>This function allows you to compose characters that don&rsquo;t appear on the
keyboard to be inserted into the command line.  The command is followed by
two keys corresponding to ASCII characters (there is no prompt).  For
accented characters, the two keys are a base character followed by a code
for the accent, while for other special characters the two characters
together form a mnemonic for the character to be inserted.  The
two-character codes are a subset of those given by RFC 1345 (see for
example <tt><a href="http://www.faqs.org/rfcs/rfc1345.html">http://www.faqs.org/rfcs/rfc1345.html</a></tt>).
</p>
<p>The function may optionally be followed by up to two characters which
replace one or both of the characters read from the keyboard; if both
characters are supplied, no input is read.  For example,
<tt>insert-composed-char a:</tt> can be used within a widget to insert an a with
umlaut into the command line.  This has the advantages over use of a
literal character that it is more portable.
</p>
<p>For best results zsh should have been built with support for multibyte
characters (configured with <tt>&ndash;enable-multibyte</tt>); however, the function
works for the limited range of characters available in single-byte
character sets such as ISO-8859-1.
</p>
<p>The character is converted into the local representation and
inserted into the command line at the cursor position.
(The conversion is done within the shell, using whatever facilities
the C library provides.)  With a numeric argument, the character and its
code are previewed in the status line
</p>
<p>The function may be run outside zle in which case it prints the character
(together with a newline) to standard output.  Input is still read from
keystrokes.
</p>
<p>See <tt>insert-unicode-char</tt> for an alternative way of inserting Unicode
characters using their hexadecimal character number.
</p>
<p>The set of accented characters is reasonably complete up to Unicode
character U+0180, the set of special characters less so.  However, it
is very sporadic from that point.  Adding new characters is easy,
however; see the function <tt>define-composed-chars</tt>.  Please send any
additions to <tt>zsh-workers@zsh.org</tt>.
</p>
<p>The codes for the second character when used to accent the first are as
follows.  Note that not every character can take every accent.
</p><dl compact="compact">
<dt><tt>!</tt></dt>
<dd><p>Grave.
</p></dd>
<dt><tt>&rsquo;</tt></dt>
<dd><p>Acute.
</p></dd>
<dt><tt>&gt;</tt></dt>
<dd><p>Circumflex.
</p></dd>
<dt><tt>?</tt></dt>
<dd><p>Tilde.  (This is not <tt>~</tt> as RFC 1345 does not assume that
character is present on the keyboard.)
</p></dd>
<dt><tt>-</tt></dt>
<dd><p>Macron.  (A horizontal bar over the base character.)
</p></dd>
<dt><tt>(</tt></dt>
<dd><p>Breve.  (A shallow dish shape over the base character.)
</p></dd>
<dt><tt>.</tt></dt>
<dd><p>Dot above the base character, or in the case of <tt>i</tt> no dot,
or in the case of <tt>L</tt> and <tt>l</tt> a centered dot.
</p></dd>
<dt><tt>:</tt></dt>
<dd><p>Diaeresis (Umlaut).
</p></dd>
<dt><tt>c</tt></dt>
<dd><p>Cedilla.
</p></dd>
<dt><tt>_</tt></dt>
<dd><p>Underline, however there are currently no underlined characters.
</p></dd>
<dt><tt>/</tt></dt>
<dd><p>Stroke through the base character.
</p></dd>
<dt><tt>&quot;</tt></dt>
<dd><p>Double acute (only supported on a few letters).
</p></dd>
<dt><tt>;</tt></dt>
<dd><p>Ogonek.  (A little forward facing hook at the bottom right
of the character.)
</p></dd>
<dt><tt>&lt;</tt></dt>
<dd><p>Caron.  (A little v over the letter.)
</p></dd>
<dt><tt>0</tt></dt>
<dd><p>Circle over the base character.
</p></dd>
<dt><tt>2</tt></dt>
<dd><p>Hook over the base character.
</p></dd>
<dt><tt>9</tt></dt>
<dd><p>Horn over the base character.
</p></dd>
</dl>

<p>The most common characters from the Arabic, Cyrillic, Greek and Hebrew
alphabets are available; consult RFC 1345 for the appropriate sequences.
In addition, a set of two letter codes not in RFC 1345 are available for
the double-width characters corresponding to ASCII characters from <tt>!</tt>
to <tt>~</tt> (0x21 to 0x7e) by preceding the character with <tt>^</tt>, for
example <tt>^A</tt> for a double-width <tt>A</tt>.
</p>
<p>The following other two-character sequences are understood.
</p>
<dl compact="compact">
<dt>ASCII characters</dt>
<dd><p>These are already present on most keyboards:
</p><dl compact="compact">
<dt><tt>&lt;(</tt></dt>
<dd><p>Left square bracket
</p></dd>
<dt><tt>//</tt></dt>
<dd><p>Backslash (solidus)
</p></dd>
<dt><tt>)&gt;</tt></dt>
<dd><p>Right square bracket
</p></dd>
<dt><tt>(!</tt></dt>
<dd><p>Left brace (curly bracket)
</p></dd>
<dt><tt>!!</tt></dt>
<dd><p>Vertical bar (pipe symbol)
</p></dd>
<dt><tt>!)</tt></dt>
<dd><p>Right brace (curly bracket)
</p></dd>
<dt><tt>&rsquo;?</tt></dt>
<dd><p>Tilde
</p></dd>
</dl>

</dd>
<dt>Special letters</dt>
<dd><p>Characters found in various variants of the Latin alphabet:
</p><dl compact="compact">
<dt><tt>ss</tt></dt>
<dd><p>Eszett (scharfes S)
</p></dd>
<dt><tt>D-</tt>, <tt>d-</tt></dt>
<dd><p>Eth
</p></dd>
<dt><tt>TH</tt>, <tt>th</tt></dt>
<dd><p>Thorn
</p></dd>
<dt><tt>kk</tt></dt>
<dd><p>Kra
</p></dd>
<dt><tt>&rsquo;n</tt></dt>
<dd><p>&rsquo;n
</p></dd>
<dt><tt>NG</tt>, <tt>ng</tt></dt>
<dd><p>Ng
</p></dd>
<dt><tt>OI</tt>, <tt>oi</tt></dt>
<dd><p>Oi
</p></dd>
<dt><tt>yr</tt></dt>
<dd><p>yr
</p></dd>
<dt><tt>ED</tt></dt>
<dd><p>ezh
</p></dd>
</dl>

</dd>
<dt>Currency symbols</dt>
<dd><dl compact="compact">
<dt><tt>Ct</tt></dt>
<dd><p>Cent
</p></dd>
<dt><tt>Pd</tt></dt>
<dd><p>Pound sterling (also lira and others)
</p></dd>
<dt><tt>Cu</tt></dt>
<dd><p>Currency
</p></dd>
<dt><tt>Ye</tt></dt>
<dd><p>Yen
</p></dd>
<dt><tt>Eu</tt></dt>
<dd><p>Euro (N.B. not in RFC 1345)
</p></dd>
</dl>

</dd>
<dt>Punctuation characters</dt>
<dd><p>References to &quot;right&quot; quotes indicate the shape (like a 9 rather than 6)
rather than their grammatical use.  (For example, a &quot;right&quot; low double
quote is used to open quotations in German.)
</p><dl compact="compact">
<dt><tt>!I</tt></dt>
<dd><p>Inverted exclamation mark
</p></dd>
<dt><tt>BB</tt></dt>
<dd><p>Broken vertical bar
</p></dd>
<dt><tt>SE</tt></dt>
<dd><p>Section
</p></dd>
<dt><tt>Co</tt></dt>
<dd><p>Copyright
</p></dd>
<dt><tt>-a</tt></dt>
<dd><p>Spanish feminine ordinal indicator
</p></dd>
<dt><tt>&lt;&lt;</tt></dt>
<dd><p>Left guillemet
</p></dd>
<dt><tt>-</tt><tt>-</tt></dt>
<dd><p>Soft hyphen
</p></dd>
<dt><tt>Rg</tt></dt>
<dd><p>Registered trade mark
</p></dd>
<dt><tt>PI</tt></dt>
<dd><p>Pilcrow (paragraph)
</p></dd>
<dt><tt>-o</tt></dt>
<dd><p>Spanish masculine ordinal indicator
</p></dd>
<dt><tt>&gt;&gt;</tt></dt>
<dd><p>Right guillemet
</p></dd>
<dt><tt>?I</tt></dt>
<dd><p>Inverted question mark
</p></dd>
<dt><tt>-1</tt></dt>
<dd><p>Hyphen
</p></dd>
<dt><tt>-N</tt></dt>
<dd><p>En dash
</p></dd>
<dt><tt>-M</tt></dt>
<dd><p>Em dash
</p></dd>
<dt><tt>-3</tt></dt>
<dd><p>Horizontal bar
</p></dd>
<dt><tt>:3</tt></dt>
<dd><p>Vertical ellipsis
</p></dd>
<dt><tt>.3</tt></dt>
<dd><p>Horizontal midline ellipsis
</p></dd>
<dt><tt>!2</tt></dt>
<dd><p>Double vertical line
</p></dd>
<dt><tt>=2</tt></dt>
<dd><p>Double low line
</p></dd>
<dt><tt>&rsquo;6</tt></dt>
<dd><p>Left single quote
</p></dd>
<dt><tt>&rsquo;9</tt></dt>
<dd><p>Right single quote
</p></dd>
<dt><tt>.9</tt></dt>
<dd><p>&quot;Right&quot; low quote
</p></dd>
<dt><tt>9&rsquo;</tt></dt>
<dd><p>Reversed &quot;right&quot; quote
</p></dd>
<dt><tt>&quot;6</tt></dt>
<dd><p>Left double quote
</p></dd>
<dt><tt>&quot;9</tt></dt>
<dd><p>Right double quote
</p></dd>
<dt><tt>:9</tt></dt>
<dd><p>&quot;Right&quot; low double quote
</p></dd>
<dt><tt>9&quot;</tt></dt>
<dd><p>Reversed &quot;right&quot; double quote
</p></dd>
<dt><tt>/-</tt></dt>
<dd><p>Dagger
</p></dd>
<dt><tt>/=</tt></dt>
<dd><p>Double dagger
</p></dd>
</dl>

</dd>
<dt>Mathematical symbols</dt>
<dd><dl compact="compact">
<dt><tt>DG</tt></dt>
<dd><p>Degree
</p></dd>
<dt><tt>-2</tt>, <tt>+-</tt>, <tt>-+</tt></dt>
<dd><p>- sign, +/- sign, -/+ sign
</p></dd>
<dt><tt>2S</tt></dt>
<dd><p>Superscript 2
</p></dd>
<dt><tt>3S</tt></dt>
<dd><p>Superscript 3
</p></dd>
<dt><tt>1S</tt></dt>
<dd><p>Superscript 1
</p></dd>
<dt><tt>My</tt></dt>
<dd><p>Micro
</p></dd>
<dt><tt>.M</tt></dt>
<dd><p>Middle dot
</p></dd>
<dt><tt>14</tt></dt>
<dd><p>Quarter
</p></dd>
<dt><tt>12</tt></dt>
<dd><p>Half
</p></dd>
<dt><tt>34</tt></dt>
<dd><p>Three quarters
</p></dd>
<dt><tt>*X</tt></dt>
<dd><p>Multiplication
</p></dd>
<dt><tt>-:</tt></dt>
<dd><p>Division
</p></dd>
<dt><tt>%0</tt></dt>
<dd><p>Per mille
</p></dd>
<dt><tt>FA</tt>, <tt>TE</tt>, <tt>/0</tt></dt>
<dd><p>For all, there exists, empty set
</p></dd>
<dt><tt>dP</tt>, <tt>DE</tt>, <tt>NB</tt></dt>
<dd><p>Partial derivative, delta (increment), del
(nabla)
</p></dd>
<dt><tt>(-</tt>, <tt>-)</tt></dt>
<dd><p>Element of, contains
</p></dd>
<dt><tt>*P</tt>, <tt>+Z</tt></dt>
<dd><p>Product, sum
</p></dd>
<dt><tt>*-</tt>, <tt>Ob</tt>, <tt>Sb</tt></dt>
<dd><p>Asterisk, ring, bullet
</p></dd>
<dt><tt>RT</tt>, <tt>0(</tt>, <tt>00</tt></dt>
<dd><p>Root sign, proportional to, infinity
</p></dd>
</dl>

</dd>
<dt>Other symbols</dt>
<dd><dl compact="compact">
<dt><tt>cS</tt>, <tt>cH</tt>, <tt>cD</tt>, <tt>cC</tt></dt>
<dd><p>Card suits: spades, hearts, diamonds,
clubs
</p></dd>
<dt><tt>Md</tt>, <tt>M8</tt>, <tt>M2</tt>, <tt>Mb</tt>, <tt>Mx</tt>, <tt>MX</tt></dt>
<dd><p>Musical notation:
crotchet (quarter note), quaver (eighth note), semiquavers (sixteenth
notes), flag sign, natural sign, sharp sign
</p></dd>
<dt><tt>Fm</tt>, <tt>Ml</tt></dt>
<dd><p>Female, male
</p></dd>
</dl>

</dd>
<dt>Accents on their own</dt>
<dd><dl compact="compact">
<dt><tt>&rsquo;&gt;</tt></dt>
<dd><p>Circumflex (same as caret, <tt>^</tt>)
</p></dd>
<dt><tt>&rsquo;!</tt></dt>
<dd><p>Grave (same as backtick, <tt>&lsquo;</tt>)
</p></dd>
<dt><tt>&rsquo;,</tt></dt>
<dd><p>Cedilla
</p></dd>
<dt><tt>&rsquo;:</tt></dt>
<dd><p>Diaeresis (Umlaut)
</p></dd>
<dt><tt>&rsquo;m</tt></dt>
<dd><p>Macron
</p></dd>
<dt><tt>&rdquo;</tt></dt>
<dd><p>Acute
</p></dd>
</dl>

</dd>
</dl>

<a name="index-insert_002dfiles"></a>
</dd>
<dt><tt>insert-files</tt></dt>
<dd><p>This function allows you type a file pattern, and see the results of the
expansion at each step.  When you hit return, all expansions are inserted
into the command line.
</p>
<div class="example">
<pre class="example">bindkey '^Xf' insert-files
</pre></div>

<a name="index-insert_002dunicode_002dchar"></a>
</dd>
<dt><tt>insert-unicode-char</tt></dt>
<dd><p>When first executed, the user inputs a set of hexadecimal digits.
This is terminated with another call to <tt>insert-unicode-char</tt>.
The digits are then turned into the corresponding Unicode character.
For example, if the widget is bound to <tt>^XU</tt>, the character sequence
&lsquo;<tt>^XU 4 c ^XU</tt>&rsquo; inserts <tt>L</tt> (Unicode U+004c).
</p>
<p>See <tt>insert-composed-char</tt> for a way of inserting characters
using a two-character mnemonic.
</p>
<a name="index-narrow_002dto_002dregion"></a>
<a name="index-narrow_002dto_002dregion_002dinvisible"></a>

</dd>
<dt><tt>narrow-to-region </tt>[ <tt>-p</tt> <var>pre</var> ] [ <tt>-P</tt> <var>post</var> ]</dt>
<dt><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>[ <tt>-S</tt> <var>statepm</var> | <tt>-R</tt> <var>statepm</var> | [ <tt>-l</tt> <var>lbufvar</var> ] [ <tt>-r</tt> <var>rbufvar</var> ] ]</dt>
<dt><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>[ <tt>-n</tt> ] [ <var>start</var> <var>end</var> ]</dt>
<dt><tt>narrow-to-region-invisible</tt></dt>
<dd><p>Narrow the editable portion of the buffer to the region between the cursor
and the mark, which may be in either order.  The region may not be empty.
</p>
<p><tt>narrow-to-region</tt> may be used as a widget or called as a function from a
user-defined widget; by default, the text outside the editable area remains
visible.  A <tt>recursive-edit</tt> is performed and the original widening
status is then restored.  Various options and arguments are available when
it is called as a function.
</p>
<p>The options <tt>-p</tt> <var>pretext</var> and <tt>-P</tt> <var>posttext</var> may be
used to replace the text before and after the display for the duration of
the function; either or both may be an empty string.
</p>
<p>If the option <tt>-n</tt> is also given, <var>pretext</var> or <var>posttext</var> will only
be inserted if there is text before or after the region respectively which
will be made invisible.
</p>
<p>Two numeric arguments may be given which will be used instead of the cursor
and mark positions.
</p>
<p>The option <tt>-S</tt> <var>statepm</var> is used to narrow according to the other
options while saving the original state in the parameter with name
<var>statepm</var>, while the option <tt>-R</tt> <var>statepm</var> is used to restore the
state from the parameter; note in both cases the <em>name</em> of the parameter
is required.  In the second case, other options and arguments are
irrelevant.  When this method is used, no <tt>recursive-edit</tt> is performed;
the calling widget should call this function with the option <tt>-S</tt>,
perform its own editing on the command line or pass control to the user
via &lsquo;<tt>zle recursive-edit</tt>&rsquo;, then call this function with the option
<tt>-R</tt>.  The argument <var>statepm</var> must be a suitable name for an ordinary
parameter, except that parameters beginning with the prefix <tt>_ntr_</tt> are
reserved for use within <tt>narrow-to-region</tt>.  Typically the parameter will
be local to the calling function.
</p>
<p>The options <tt>-l</tt> <var>lbufvar</var> and <tt>-r</tt> <var>rbufvar</var> may be used to
specify parameters where the widget will store the resulting text from
the operation.  The parameter <var>lbufvar</var> will contain <tt>LBUFFER</tt>
and <var>rbufvar</var> will contain <tt>RBUFFER</tt>.  Neither of these two options
may be used with <tt>-S</tt> or <tt>-R</tt>.
</p>
<p><tt>narrow-to-region-invisible</tt> is a simple widget which calls
<tt>narrow-to-region</tt> with arguments which replace any text outside the
region with &lsquo;<tt>...</tt>&rsquo;.  It does not take any arguments.
</p>
<p>The display is restored (and the widget returns) upon any zle command
which would usually cause the line to be accepted or aborted.  Hence an
additional such command is required to accept or abort the current line.
</p>
<p>The return status of both widgets is zero if the line was accepted, else
non-zero.
</p>
<p>Here is a trivial example of a widget using this feature.
</p><div class="example">
<pre class="example">local state
narrow-to-region -p $'Editing restricted region\n' \ 
  -P '' -S state
zle recursive-edit
narrow-to-region -R state
</pre></div>

<a name="index-predict_002don"></a>
<a name="index-predict_002doff"></a>
</dd>
<dt><tt>predict-on</tt></dt>
<dd><p>This set of functions implements predictive typing using history search.
After <tt>predict-on</tt>, typing characters causes the editor to look backward
in the history for the first line beginning with what you have typed so
far.  After <tt>predict-off</tt>, editing returns to normal for the line found.
In fact, you often don&rsquo;t even need to use <tt>predict-off</tt>, because if the
line doesn&rsquo;t match something in the history, adding a key performs
standard completion, and then inserts itself if no completions were found.
However, editing in the middle of a line is liable to confuse prediction;
see the <tt>toggle</tt> style below.
</p>
<p>With the function based completion system (which is needed for this), you
should be able to type <tt>TAB</tt> at almost any point to advance the cursor
to the next &lsquo;&lsquo;interesting&rsquo;&rsquo; character position (usually the end of the
current word, but sometimes somewhere in the middle of the word).  And of
course as soon as the entire line is what you want, you can accept with
return, without needing to move the cursor to the end first.
</p>
<p>The first time <tt>predict-on</tt> is used, it creates several additional
widget functions:
</p>
<dl compact="compact">
<dt><tt>delete-backward-and-predict</tt></dt>
<dd><p>Replaces the <tt>backward-delete-char</tt>
widget.  You do not need to bind this yourself.
</p></dd>
<dt><tt>insert-and-predict</tt></dt>
<dd><p>Implements predictive typing by replacing the
<tt>self-insert</tt> widget.  You do not need to bind this yourself.
</p></dd>
<dt><tt>predict-off</tt></dt>
<dd><p>Turns off predictive typing.
</p></dd>
</dl>

<p>Although you <tt>autoload</tt> only the <tt>predict-on</tt> function, it is
necessary to create a keybinding for <tt>predict-off</tt> as well.
</p>
<div class="example">
<pre class="example">zle -N predict-on
zle -N predict-off
bindkey '^X^Z' predict-on
bindkey '^Z' predict-off
</pre></div>

<a name="index-read_002dfrom_002dminibuffer"></a>
</dd>
<dt><tt>read-from-minibuffer</tt></dt>
<dd><p>This is most useful when called as a function from inside a widget, but will
work correctly as a widget in its own right.  It prompts for a value
below the current command line; a value may be input using all of the
standard zle operations (and not merely the restricted set available
when executing, for example, <tt>execute-named-cmd</tt>).  The value is then
returned to the calling function in the parameter <tt>$REPLY</tt> and the
editing buffer restored to its previous state.  If the read was aborted
by a keyboard break (typically <tt>^G</tt>), the function returns status 1
and <tt>$REPLY</tt> is not set.
</p>
<p>If one argument is supplied to the function it is taken as a prompt,
otherwise &lsquo;<tt>? </tt>&rsquo; is used.  If two arguments are supplied, they are the
prompt and the initial value of <tt>$LBUFFER</tt>, and if a third argument is
given it is the initial value of <tt>$RBUFFER</tt>.  This provides a default
value and starting cursor placement.  Upon return the entire buffer is the
value of <tt>$REPLY</tt>.
</p>
<p>One option is available: &lsquo;<tt>-k</tt> <var>num</var>&rsquo; specifies that <var>num</var>
characters are to be read instead of a whole line.  The line editor is not
invoked recursively in this case, so depending on the terminal settings
the input may not be visible, and only the input keys are placed in
<tt>$REPLY</tt>, not the entire buffer.  Note that unlike the <tt>read</tt> builtin
<var>num</var> must be given; there is no default.
</p>
<p>The name is a slight misnomer, as in fact the shell&rsquo;s own minibuffer is
not used.  Hence it is still possible to call <tt>executed-named-cmd</tt> and
similar functions while reading a value.
</p>
<a name="index-replace_002dargument"></a>
<a name="index-replace_002dargument_002dedit"></a>
</dd>
<dt><tt>replace-argument</tt>, <tt>replace-argument-edit</tt></dt>
<dd><p>The function <tt>replace-argument</tt> can be used to replace a command
line argument in the current command line or, if the current command
line is empty, in the last command line executed (the new command line
is not executed).  Arguments are as delimited by standard shell syntax,
</p>
<p>If a numeric argument is given, that specifies the argument to be
replaced.  0 means the command name, as in history expansion.
A negative numeric argument counts backward from the last word.
</p>
<p>If no numeric argument is given, the current argument is replaced;
this is the last argument if the previous history line is being used.
</p>
<p>The function prompts for a replacement argument.
</p>
<p>If the widget contains the string <tt>edit</tt>, for example is defined as
</p>
<div class="example">
<pre class="example">zle -N replace-argument-edit replace-argument
</pre></div>

<p>then the function presents the current value of the argument for
editing, otherwise the editing buffer for the replacement is
initially empty.
</p>
<a name="index-replace_002dstring"></a>
<a name="index-replace_002dstring_002dagain"></a>
<a name="index-replace_002dpattern"></a>
</dd>
<dt><tt>replace-string</tt>, <tt>replace-pattern</tt></dt>
<dt><tt>replace-string-again</tt>, <tt>replace-pattern-again</tt></dt>
<dd><p>The function <tt>replace-string</tt> implements three widgets.
If defined under the same name as the function, it prompts for two
strings; the first (source) string will be replaced by the second
everywhere it occurs in the line editing buffer.
</p>
<p>If the widget name contains the word &lsquo;<tt>pattern</tt>&rsquo;, for example by
defining the widget using the command &lsquo;<tt>zle -N replace-pattern
replace-string</tt>&rsquo;, then the matching is performed using zsh patterns.  All
zsh extended globbing patterns can be used in the source string; note
that unlike filename generation the pattern does not need to match an
entire word, nor do glob qualifiers have any effect.  In addition, the
replacement string can contain parameter or command substitutions.
Furthermore, a &lsquo;<tt>&amp;</tt>&rsquo; in the replacement string will be replaced with
the matched source string, and a backquoted digit &lsquo;<tt>\</tt><var>N</var>&rsquo; will be
replaced by the <var>N</var>th parenthesised expression matched.  The form
&lsquo;<tt>\{</tt><var>N</var><tt>}</tt>&rsquo; may be used to protect the digit from following
digits.
</p>
<p>If the widget instead contains the word &lsquo;<tt>regex</tt>&rsquo; (or &lsquo;<tt>regexp</tt>&rsquo;),
then the matching is performed using regular expressions, respecting
the setting of the option <tt>RE_MATCH_PCRE</tt> (see the description of the
function <tt>regexp-replace</tt> below).  The special replacement facilities
described above for pattern matching are available.
</p>
<p>By default the previous source or replacement string will not be offered
for editing.  However, this feature can be activated by setting the style
<tt>edit-previous</tt> in the context <tt>:zle:</tt><var>widget</var> (for example,
<tt>:zle:replace-string</tt>) to <tt>true</tt>.  In addition, a positive
numeric argument forces the previous values to be offered, a negative or
zero argument forces them not to be.
</p>
<p>The function <tt>replace-string-again</tt> can be used to repeat the previous
replacement; no prompting is done.  As with <tt>replace-string</tt>, if the name
of the widget contains the word &lsquo;<tt>pattern</tt>&rsquo; or &lsquo;<tt>regex</tt>&rsquo;, pattern or
regular expression matching is performed, else a literal string
replacement.  Note that the previous source and replacement text are the
same whether pattern, regular expression or string matching is used.
</p>
<p>In addition, <tt>replace-string</tt> shows the previous replacement above
the prompt, so long as there was one during the current session; if the
source string is empty, that replacement will be repeated without
the widget prompting for a replacement string.
</p>
<p>For example, starting from the line:
</p>
<div class="example">
<pre class="example">print This line contains fan and fond
</pre></div>

<p>and invoking <tt>replace-pattern</tt> with the source string
&lsquo;<tt>f(?)n</tt>&rsquo; and
the replacement string &lsquo;<tt>c\1r</tt>&rsquo; produces the not very useful line:
</p>
<div class="example">
<pre class="example">print This line contains car and cord
</pre></div>

<p>The range of the replacement string can be limited by using the
<tt>narrow-to-region-invisible</tt> widget.  One limitation of the current
version is that <tt>undo</tt> will cycle through changes to the replacement
and source strings before undoing the replacement itself.
</p>
<a name="index-send_002dinvisible"></a>
</dd>
<dt><tt>send-invisible</tt></dt>
<dd><p>This is similar to read-from-minibuffer in that it may be called as a
function from a widget or as a widget of its own, and interactively reads
input from the keyboard.  However, the input being typed is concealed and
a string of asterisks (&lsquo;<tt>*</tt>&rsquo;) is shown instead.  The value is saved in
the parameter <tt>$INVISIBLE</tt> to which a reference is inserted into the
editing buffer at the restored cursor position.  If the read was aborted
by a keyboard break (typically <tt>^G</tt>) or another escape from editing such
as <tt>push-line</tt>, <tt>$INVISIBLE</tt> is set to empty and the original buffer
is restored unchanged.
</p>
<p>If one argument is supplied to the function it is taken as a prompt,
otherwise &lsquo;<tt>Non-echoed text: </tt>&rsquo; is used (as in emacs).  If a second and
third argument are supplied they are used to begin and end the reference
to <tt>$INVISIBLE</tt> that is inserted into the buffer.  The default is to
open with <tt>${</tt>, then <tt>INVISIBLE</tt>, and close with <tt>}</tt>, but many
other effects are possible.
</p>
<a name="index-smart_002dinsert_002dlast_002dword"></a>
</dd>
<dt><tt>smart-insert-last-word</tt></dt>
<dd><p>This function may replace the <tt>insert-last-word</tt> widget, like so:
</p>
<div class="example">
<pre class="example">zle -N insert-last-word smart-insert-last-word
</pre></div>

<p>With a numeric argument, or when passed command line arguments in a call
from another widget, it behaves like <tt>insert-last-word</tt>, except that
words in comments are ignored when <tt>INTERACTIVE_COMMENTS</tt> is set.
</p>
<p>Otherwise, the rightmost &lsquo;&lsquo;interesting&rsquo;&rsquo; word from the previous command is
found and inserted.  The default definition of &lsquo;&lsquo;interesting&rsquo;&rsquo; is that the
word contains at least one alphabetic character, slash, or backslash.
This definition may be overridden by use of the <tt>match</tt> style.  The
context used to look up the style is the widget name, so usually the
context is <tt>:insert-last-word</tt>.  However, you can bind this function to
different widgets to use different patterns:
</p>
<div class="example">
<pre class="example">zle -N insert-last-assignment smart-insert-last-word
zstyle :insert-last-assignment match '[[:alpha:]][][[:alnum:]]#=*'
bindkey '\e=' insert-last-assignment
</pre></div>

<p>If no interesting word is found and the <tt>auto-previous</tt> style is set to
a true value, the search continues upward through the history.  When
<tt>auto-previous</tt> is unset or false (the default), the widget must be
invoked repeatedly in order to search earlier history lines.
</p>
<a name="index-transpose_002dlines"></a>
</dd>
<dt><tt>transpose-lines</tt></dt>
<dd><p>Only useful with a multi-line editing buffer; the lines here are
lines within the current on-screen buffer, not history lines.
The effect is similar to the function of the same name in Emacs.
</p>
<p>Transpose the current line with the previous line and move the cursor
to the start of the next line.  Repeating this (which can be done by
providing a positive numeric argument) has the effect of moving
the line above the cursor down by a number of lines.
</p>
<p>With a negative numeric argument, requires two lines above the
cursor.  These two lines are transposed and the cursor moved to the
start of the previous line.  Using a numeric argument less than -1
has the effect of moving the line above the cursor up by minus that
number of lines.
</p>
<a name="index-url_002dquote_002dmagic"></a>
</dd>
<dt><tt>url-quote-magic</tt></dt>
<dd><p>This widget replaces the built-in <tt>self-insert</tt> to make it easier to
type URLs as command line arguments.  As you type, the input character is
analyzed and, if it may need quoting, the current word is checked for a
URI scheme.  If one is found and the current word is not already in
quotes, a backslash is inserted before the input character.
</p>
<p>Styles to control quoting behavior:
</p>
<dl compact="compact">
<dt><tt>url-metas</tt></dt>
<dd><p>This style is looked up in the context &lsquo;<tt>:url-quote-magic:</tt><var>scheme</var>&rsquo;
(where <var>scheme</var> is that of the current URL, e.g. &quot;<tt>ftp</tt>&quot;).  The value
is a string listing the characters to be treated as globbing
metacharacters when appearing in a URL using that scheme.  The default is
to quote all zsh extended globbing characters, excluding &rsquo;<tt>&lt;</tt>&rsquo; and
&rsquo;<tt>&gt;</tt>&rsquo; but including braces (as in brace expansion).  See also
<tt>url-seps</tt>.
</p>
</dd>
<dt><tt>url-seps</tt></dt>
<dd><p>Like <tt>url-metas</tt>, but lists characters that should be considered command
separators, redirections, history references, etc.  The default is to
quote the standard set of shell separators, excluding those that overlap
with the extended globbing characters, but including &rsquo;<tt>&lt;</tt>&rsquo; and
&rsquo;<tt>&gt;</tt>&rsquo; and the first character of <tt>$histchars</tt>.
</p>
</dd>
<dt><tt>url-globbers</tt></dt>
<dd><p>This style is looked up in the context &lsquo;<tt>:url-quote-magic</tt>&rsquo;.  The values
form a list of command names that are expected to do their own globbing
on the URL string.  This implies that they are aliased to use the
&lsquo;<tt>noglob</tt>&rsquo; modifier.  When the first word on the line matches one of the
values <em>and</em> the URL refers to a local file (see <tt>url-local-schema</tt>),
only the <tt>url-seps</tt> characters are quoted; the <tt>url-metas</tt> are left
alone, allowing them to affect command-line parsing, completion, etc.  The
default values are a literal &lsquo;<tt>noglob</tt>&rsquo; plus (when the <tt>zsh/parameter</tt>
module is available) any commands aliased to the helper function
&lsquo;<tt>urlglobber</tt>&rsquo; or its alias &lsquo;<tt>globurl</tt>&rsquo;.
</p>
</dd>
<dt><tt>url-local-schema</tt></dt>
<dd><p>This style is always looked up in the context &lsquo;<tt>:urlglobber</tt>&rsquo;, even
though it is used by both url-quote-magic and urlglobber.  The values form
a list of URI schema that should be treated as referring to local files by
their real local path names, as opposed to files which are specified
relative to a web-server-defined document root.  The defaults are
&quot;<tt>ftp</tt>&quot; and &quot;<tt>file</tt>&quot;.
</p>
</dd>
<dt><tt>url-other-schema</tt></dt>
<dd><p>Like <tt>url-local-schema</tt>, but lists all other URI schema upon which
<tt>urlglobber</tt> and <tt>url-quote-magic</tt> should act.  If the URI on the
command line does not have a scheme appearing either in this list or in
<tt>url-local-schema</tt>, it is not magically quoted.  The default values are
&quot;<tt>http</tt>&quot;, &quot;<tt>https</tt>&quot;, and &quot;<tt>ftp</tt>&quot;.  When a scheme appears both here
and in <tt>url-local-schema</tt>, it is quoted differently depending on whether
the command name appears in <tt>url-globbers</tt>.
</p>
</dd>
</dl>

<p>Loading <tt>url-quote-magic</tt> also defines a helper function &lsquo;<tt>urlglobber</tt>&rsquo;
and aliases &lsquo;<tt>globurl</tt>&rsquo; to &lsquo;<tt>noglob urlglobber</tt>&rsquo;.  This function takes
a local URL apart, attempts to pattern-match the local file portion of the
URL path, and then puts the results back into URL format again.
</p>
<a name="index-vi_002dpipe"></a>
</dd>
<dt><tt>vi-pipe</tt></dt>
<dd><p>This function reads a movement command from the keyboard and then
prompts for an external command. The part of the buffer covered by
the movement is piped to the external command and then replaced by
the command&rsquo;s output. If the movement command is bound to vi-pipe,
the current line is used.
</p>
<p>The function serves as an example for reading a vi movement command
from within a user-defined widget.
</p>
<a name="index-which_002dcommand-1"></a>
</dd>
<dt><tt>which-command</tt></dt>
<dd><p>This function is a drop-in replacement for the builtin widget
<tt>which-command</tt>.  It has enhanced behaviour, in that it correctly
detects whether or not the command word needs to be expanded as an
alias; if so, it continues tracing the command word from the expanded
alias until it reaches the command that will be executed.
</p>
<p>The style <tt>whence</tt> is available in the context <tt>:zle:$WIDGET</tt>; this
may be set to an array to give the command and options that will be used to
investigate the command word found.  The default is <tt>whence -c</tt>.
</p>
<a name="index-zcalc_002dauto_002dinsert"></a>
</dd>
<dt><tt>zcalc-auto-insert</tt></dt>
<dd><p>This function is useful together with the <tt>zcalc</tt> function described in
<a href="#Mathematical-Functions">Mathematical Functions</a>.
It should be bound to a key representing a binary operator such
as &lsquo;<tt>+</tt>&rsquo;, &lsquo;<tt>-</tt>&rsquo;, &lsquo;<tt>*</tt>&rsquo; or &lsquo;<tt>/</tt>&rsquo;.  When running in zcalc,
if the key occurs at the start of the line or immediately following
an open parenthesis, the text <tt>&quot;ans &quot;</tt> is inserted before the
representation of the key itself.  This allows easy use of the
answer from the previous calculation in the current line.  The
text to be inserted before the symbol typed can be modified by setting
the variable <tt>ZCALC_AUTO_INSERT_PREFIX</tt>.
</p>
<p>Hence, for example, typing &lsquo;<tt>+12</tt>&rsquo; followed by return adds 12
to the previous result.
</p>
<p>If zcalc is in RPN mode (<tt>-r</tt> option) the effect of this binding is
automatically suppressed as operators alone on a line are meaningful.
</p>
<p>When not in zcalc, the key simply inserts the symbol itself.
</p>
</dd>
</dl>


<hr>
<a name="Utility-Functions"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Widgets" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ZLE-Functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Styles-2" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.7.2 Utility Functions</h3>

<p>These functions are useful in constructing widgets.  They
should be loaded with &lsquo;<tt>autoload -U</tt> <var>function</var>&rsquo; and called
as indicated from user-defined widgets.
</p>
<dl compact="compact">
<dd><a name="index-split_002dshell_002darguments"></a>
</dd>
<dt><tt>split-shell-arguments</tt></dt>
<dd><p>This function splits the line currently being edited into shell arguments
and whitespace.  The result is stored in the array <tt>reply</tt>.  The array
contains all the parts of the line in order, starting with any whitespace
before the first argument, and finishing with any whitespace after the last
argument.  Hence (so long as the option <tt>KSH_ARRAYS</tt> is not set)
whitespace is given by odd indices in the array and arguments by
even indices.  Note that no stripping of quotes is done; joining together
all the elements of <tt>reply</tt> in order is guaranteed to produce the
original line.
</p>
<p>The parameter <tt>REPLY</tt> is set to the index of the word in <tt>reply</tt> which
contains the character after the cursor, where the first element has index
1.  The parameter <tt>REPLY2</tt> is set to the index of the character under the
cursor in that word, where the first character has index 1.
</p>
<p>Hence <tt>reply</tt>, <tt>REPLY</tt> and <tt>REPLY2</tt> should all be made local to
the enclosing function.
</p>
<p>See the function <tt>modify-current-argument</tt>, described below, for
an example of how to call this function.
</p>
<a name="index-modify_002dcurrent_002dargument"></a>
</dd>
<dt><tt>modify-current-argument</tt> [ <var>expr-using-</var><tt>$ARG</tt> | <var>func</var> ]</dt>
<dd><p>This function provides a simple method of allowing user-defined widgets
to modify the command line argument under the cursor (or immediately to the
left of the cursor if the cursor is between arguments).
</p>
<p>The argument can be an expression which when evaluated operates on the shell
parameter <tt>ARG</tt>, which will have been set to the command line argument
under the cursor.  The expression should be suitably quoted to prevent
it being evaluated too early.
</p>
<p>Alternatively, if the argument does not contain the string <tt>ARG</tt>, it
is assumed to be a shell function, to which the current command line
argument is passed as the only argument.  The function should set the
variable <tt>REPLY</tt> to the new value for the command line argument.
If the function returns non-zero status, so does the calling function.
</p>
<p>For example, a user-defined widget containing the following code
converts the characters in the argument under the cursor into all upper
case:
</p>
<div class="example">
<pre class="example">modify-current-argument '${(U)ARG}'
</pre></div>

<p>The following strips any quoting from the current word (whether backslashes
or one of the styles of quotes), and replaces it with single quoting
throughout:
</p>
<div class="example">
<pre class="example">modify-current-argument '${(qq)${(Q)ARG}}'
</pre></div>

<p>The following performs directory expansion on the command line
argument and replaces it by the absolute path:
</p>
<div class="example">
<pre class="example">expand-dir() {
  REPLY=${~1}
  REPLY=${REPLY:a}
}
modify-current-argument expand-dir
</pre></div>

<p>In practice the function <tt>expand-dir</tt> would probably not be defined
within the widget where <tt>modify-current-argument</tt> is called.
</p>
</dd>
</dl>


<hr>
<a name="Styles-2"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Utility-Functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ZLE-Functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Exception-Handling" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.7.3 Styles</h3>

<p>The behavior of several of the above widgets can be controlled by the use
of the <tt>zstyle</tt> mechanism.  In particular, widgets that interact with
the completion system pass along their context to any completions that
they invoke.
</p>
<dl compact="compact">
<dd><a name="index-break_002dkeys_002c-widget-style"></a>
</dd>
<dt><tt>break-keys</tt></dt>
<dd><p>This style is used by the <tt>incremental-complete-word</tt> widget. Its value
should be a pattern, and all keys matching this pattern will cause the
widget to stop incremental completion without the key having any further
effect. Like all styles used directly by
<tt>incremental-complete-word</tt>, this style is looked up using the
context &lsquo;<tt>:incremental</tt>&rsquo;.
</p>
<a name="index-completer_002c-completion-style-1"></a>
</dd>
<dt><tt>completer</tt></dt>
<dd><p>The <tt>incremental-complete-word</tt> and <tt>insert-and-predict</tt> widgets set
up their top-level context name before calling completion.  This allows
one to define different sets of completer functions for normal completion
and for these widgets.  For example, to use completion, approximation and
correction for normal completion, completion and correction for
incremental completion and only completion for prediction one could use:
</p>
<div class="example">
<pre class="example">zstyle ':completion:*' completer \ 
        _complete _correct _approximate
zstyle ':completion:incremental:*' completer \ 
        _complete _correct
zstyle ':completion:predict:*' completer \ 
        _complete
</pre></div>

<p>It is a good idea to restrict the completers used in prediction, because
they may be automatically invoked as you type.  The <tt>_list</tt> and
<tt>_menu</tt> completers should never be used with prediction.  The
<tt>_approximate</tt>, <tt>_correct</tt>, <tt>_expand</tt>, and <tt>_match</tt> completers may
be used, but be aware that they may change characters anywhere in the word
behind the cursor, so you need to watch carefully that the result is what
you intended.
</p>
<a name="index-cursor_002c-completion-style"></a>
</dd>
<dt><tt>cursor</tt></dt>
<dd><p>The <tt>insert-and-predict</tt> widget uses this style, in the context
&lsquo;<tt>:predict</tt>&rsquo;, to decide where to place the cursor after completion has
been tried.  Values are:
</p>
<dl compact="compact">
<dt><tt>complete</tt></dt>
<dd><p>The cursor is left where it was when completion finished, but only if
it is after a character equal to the one just inserted by the user.  If 
it is after another character, this value is the same as &lsquo;<tt>key</tt>&rsquo;.
</p>
</dd>
<dt><tt>key</tt></dt>
<dd><p>The cursor is left
after the <var>n</var>th occurrence of the character just inserted, where
<var>n</var> is the number of times that character appeared in the word
before completion was attempted.  In short, this has the effect of
leaving the cursor after the character just typed even if the
completion code found out that no other characters need to be inserted 
at that position.
</p>
</dd>
</dl>

<p>Any other value for this style unconditionally leaves the cursor at the
position where the completion code left it.
</p>
<a name="index-list_002c-widget-style"></a>
</dd>
<dt><tt>list</tt></dt>
<dd><p>When using the <tt>incremental-complete-word</tt> widget, this style says
if the matches should be listed on every key press (if they fit on the 
screen).  Use the context prefix &lsquo;<tt>:completion:incremental</tt>&rsquo;.
</p>
<p>The <tt>insert-and-predict</tt> widget uses this style to decide if the
completion should be shown even if there is only one possible completion.
This is done if the value of this style is the string <tt>always</tt>.  In this
case the context is &lsquo;<tt>:predict</tt>&rsquo; (<em>not</em> &lsquo;<tt>:completion:predict</tt>&rsquo;).
</p>
<a name="index-match_002c-widget-style"></a>
</dd>
<dt><tt>match</tt></dt>
<dd><p>This style is used by <tt>smart-insert-last-word</tt> to provide a pattern
(using full <tt>EXTENDED_GLOB</tt> syntax) that matches an interesting word.
The context is the name of the widget to which <tt>smart-insert-last-word</tt>
is bound (see above).  The default behavior of <tt>smart-insert-last-word</tt>
is equivalent to:
</p>
<div class="example">
<pre class="example">zstyle :insert-last-word match '*[[:alpha:]/\\]*'
</pre></div>

<p>However, you might want to include words that contain spaces:
</p>
<div class="example">
<pre class="example">zstyle :insert-last-word match '*[[:alpha:][:space:]/\\]*'
</pre></div>

<p>Or include numbers as long as the word is at least two characters long:
</p>
<div class="example">
<pre class="example">zstyle :insert-last-word match '*([[:digit:]]?|[[:alpha:]/\\])*'
</pre></div>

<p>The above example causes redirections like &quot;2&gt;&quot; to be included.
</p>
<a name="index-prompt_002c-widget-style"></a>
</dd>
<dt><tt>prompt</tt></dt>
<dd><p>The <tt>incremental-complete-word</tt> widget shows the value of this
style in the status line during incremental completion.  The string
value may contain any of the following substrings in the manner of
the <tt>PS1</tt> and other prompt parameters:
</p>
<dl compact="compact">
<dt><tt>%c</tt></dt>
<dd><p>Replaced by the name of the completer function that generated the
matches (without the leading underscore).
</p>
</dd>
<dt><tt>%l</tt></dt>
<dd><p>When the <tt>list</tt> style is set,
replaced by &lsquo;<tt>...</tt>&rsquo; if the list of matches is too long to fit on the
screen and with an empty string otherwise.  If the <tt>list</tt> style is
&lsquo;false&rsquo; or not set, &lsquo;<tt>%l</tt>&rsquo; is always removed.
</p>
</dd>
<dt><tt>%n</tt></dt>
<dd><p>Replaced by the number of matches generated.
</p>
</dd>
<dt><tt>%s</tt></dt>
<dd><p>Replaced by &lsquo;<tt>-no match-</tt>&rsquo;, &lsquo;<tt>-no prefix-</tt>&rsquo;, or an empty string
if there is no completion matching the word on the line, if the
matches have no common prefix different from the word on the line, or
if there is such a common prefix, respectively.
</p>
</dd>
<dt><tt>%u</tt></dt>
<dd><p>Replaced by the unambiguous part of all matches, if there
is any, and if it is different from the word on the line.
</p>
</dd>
</dl>

<p>Like &lsquo;<tt>break-keys</tt>&rsquo;, this uses the &lsquo;<tt>:incremental</tt>&rsquo; context.
</p>
<a name="index-stop_002dkeys_002c-widget-style"></a>
</dd>
<dt><tt>stop-keys</tt></dt>
<dd><p>This style is used by the <tt>incremental-complete-word</tt> widget.  Its value
is treated similarly to the one for the <tt>break-keys</tt> style (and uses 
the same context: &lsquo;<tt>:incremental</tt>&rsquo;).  However, in
this case all keys matching the pattern given as its value will stop
incremental completion and will then execute their usual function.
</p>
<a name="index-toggle_002c-widget-style"></a>
</dd>
<dt><tt>toggle</tt></dt>
<dd><p>This boolean style is used by <tt>predict-on</tt> and its related widgets in
the context &lsquo;<tt>:predict</tt>&rsquo;.  If set to one of the standard &lsquo;true&rsquo; values,
predictive typing is automatically toggled off in situations where it is
unlikely to be useful, such as when editing a multi-line buffer or after
moving into the middle of a line and then deleting a character.  The
default is to leave prediction turned on until an explicit call to
<tt>predict-off</tt>.
</p>
<a name="index-verbose_002c-widget-style"></a>
</dd>
<dt><tt>verbose</tt></dt>
<dd><p>This boolean style is used by <tt>predict-on</tt> and its related widgets in
the context &lsquo;<tt>:predict</tt>&rsquo;.  If set to one of the standard &lsquo;true&rsquo; values,
these widgets display a message below the prompt when the predictive state
is toggled.  This is most useful in combination with the <tt>toggle</tt> style.
The default does not display these messages.
</p>
<a name="index-widget_002c-widget-style"></a>
</dd>
<dt><tt>widget</tt></dt>
<dd><p>This style is similar to the <tt>command</tt> style: For widget functions that
use <tt>zle</tt> to call other widgets, this style can sometimes be used to
override the widget which is called.  The context for this style is the
name of the calling widget (<em>not</em> the name of the calling function,
because one function may be bound to multiple widget names).
</p>
<div class="example">
<pre class="example">zstyle :copy-earlier-word widget smart-insert-last-word
</pre></div>

<p>Check the documentation for the calling widget or function to determine
whether the <tt>widget</tt> style is used.
</p>
</dd>
</dl>

<hr>
<a name="Exception-Handling"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Styles-2" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-Contributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#MIME-Functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="Exception-Handling-1"></a>
<h2 class="section">26.8 Exception Handling</h2>

<p>Two functions are provided to enable zsh to provide exception handling in a
form that should be familiar from other languages.
</p>
<dl compact="compact">
<dd><a name="index-throw"></a>
</dd>
<dt><tt>throw</tt> <var>exception</var></dt>
<dd><p>The function <tt>throw</tt> throws the named <var>exception</var>.  The name is
an arbitrary string and is only used by the <tt>throw</tt> and <tt>catch</tt>
functions.  An exception is for the most part treated the same as a
shell error, i.e. an unhandled exception will cause the shell to abort all
processing in a function or script and to return to the top level in an
interactive shell.
</p>
</dd>
<dt><tt>catch</tt> <var>exception-pattern</var></dt>
<dd><p>The function <tt>catch</tt> returns status zero if an exception was thrown and
the pattern <var>exception-pattern</var> matches its name.  Otherwise it
returns status 1.  <var>exception-pattern</var> is a standard
shell pattern, respecting the current setting of the <tt>EXTENDED_GLOB</tt>
option.  An alias <tt>catch</tt> is also defined to prevent the argument to the
function from matching filenames, so patterns may be used unquoted.  Note
that as exceptions are not fundamentally different from other shell errors
it is possible to catch shell errors by using an empty string as the
exception name.  The shell variable <tt>CAUGHT</tt> is set by <tt>catch</tt> to the
name of the exception caught.  It is possible to rethrow an exception by
calling the <tt>throw</tt> function again once an exception has been caught.
<a name="index-catch"></a>
</p>
</dd>
</dl>

<p>The functions are designed to be used together with the <tt>always</tt> construct
described in
<a href="Shell-Grammar.html#Complex-Commands">Complex Commands</a>.  This is important as only this
construct provides the required support for exceptions.  A typical example
is as follows.
</p>
<div class="example">
<pre class="example">{
  # &quot;try&quot; block
  # ... nested code here calls &quot;throw MyExcept&quot;
} always {
  # &quot;always&quot; block
  if catch MyExcept; then
    print &quot;Caught exception MyExcept&quot;
  elif catch ''; then
    print &quot;Caught a shell error.  Propagating...&quot;
    throw ''
  fi
  # Other exceptions are not handled but may be caught further
  # up the call stack.
}
</pre></div>

<p>If all exceptions should be caught, the following idiom might be
preferable.
</p>
<div class="example">
<pre class="example">{
  # ... nested code here throws an exception
} always {
  if catch *; then
    case $CAUGHT in
      (MyExcept)
      print &quot;Caught my own exception&quot;
      ;;
      (*)
      print &quot;Caught some other exception&quot;
      ;;
    esac
  fi
}
</pre></div>

<p>In common with exception handling in other languages, the exception may be
thrown by code deeply nested inside the &lsquo;try&rsquo; block.  However, note that it
must be thrown inside the current shell, not in a subshell forked for a
pipeline, parenthesised current-shell construct, or some form of
command or process substitution.
</p>
<p>The system internally uses the shell variable <tt>EXCEPTION</tt> to record the
name of the exception between throwing and catching.  One drawback of this
scheme is that if the exception is not handled the variable <tt>EXCEPTION</tt>
remains set and may be incorrectly recognised as the name of an exception
if a shell error subsequently occurs.  Adding <tt>unset EXCEPTION</tt> at the
start of the outermost layer of any code that uses exception handling will
eliminate this problem.
</p>
<hr>
<a name="MIME-Functions"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Exception-Handling" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-Contributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Mathematical-Functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="MIME-Functions-1"></a>
<h2 class="section">26.9 MIME Functions</h2>

<p>Three functions are available to provide handling of files recognised by
extension, for example to dispatch a file <tt>text.ps</tt> when executed as a
command to an appropriate viewer.
</p>
<dl compact="compact">
<dd><a name="index-zsh_002dmime_002dsetup"></a>
<a name="index-zsh_002dmime_002dhandler"></a>
</dd>
<dt><tt>zsh-mime-setup</tt> [ <tt>-fv</tt> ] [ <tt>-l</tt> [ <var>suffix</var> ... ] ]</dt>
<dt><tt>zsh-mime-handler</tt> [ <tt>-l</tt> ] <var>command argument</var> ...</dt>
<dd><p>These two functions use the files <tt>~/.mime.types</tt> and <tt>/etc/mime.types</tt>,
which associate types and extensions, as well as <tt>~/.mailcap</tt> and
<tt>/etc/mailcap</tt> files, which associate types and the programs that
handle them.  These are provided on many systems with the Multimedia
Internet Mail Extensions.
</p>
<p>To enable the system, the function <tt>zsh-mime-setup</tt> should be
autoloaded and run.  This allows files with extensions to be treated
as executable; such files be completed by the function completion system.
The function <tt>zsh-mime-handler</tt> should not need to be called by the
user.
</p>
<p>The system works by setting up suffix aliases with &lsquo;<tt>alias -s</tt>&rsquo;.
Suffix aliases already installed by the user will not be overwritten.
</p>
<p>For suffixes defined in lower case, upper case variants will also
automatically be handled (e.g. <tt>PDF</tt> is automatically handled if
handling for the suffix <tt>pdf</tt> is defined), but not vice versa.
</p>
<p>Repeated calls to <tt>zsh-mime-setup</tt> do not override the existing
mapping between suffixes and executable files unless the option <tt>-f</tt>
is given.  Note, however, that this does not override existing suffix
aliases assigned to handlers other than <tt>zsh-mime-handler</tt>.
</p>
<p>Calling <tt>zsh-mime-setup</tt> with the option <tt>-l</tt> lists the existing
mappings without altering them.  Suffixes to list (which may contain
pattern characters that should be quoted from immediate interpretation
on the command line) may be given as additional arguments, otherwise
all suffixes are listed.
</p>
<p>Calling <tt>zsh-mime-setup</tt> with the option
<tt>-v</tt> causes verbose output to be shown during the setup operation.
</p>
<p>The system respects the <tt>mailcap</tt> flags <tt>needsterminal</tt> and
<tt>copiousoutput</tt>; see mailcap(4) or mailcap(5)
(the man page&rsquo;s name varies across platforms).
</p>
<p>The functions use the following styles, which are defined with the
<tt>zstyle</tt> builtin command (<a href="Zsh-Modules.html#The-zsh_002fzutil-Module">The zsh/zutil Module</a>).  They should be defined
before <tt>zsh-mime-setup</tt> is run.  The contexts used all
start with <tt>:mime:</tt>, with additional components in some cases.
It is recommended that a trailing <tt>*</tt> (suitably quoted) be appended
to style patterns in case the system is extended in future.  Some
examples are given below.
</p>
<p>For files that have multiple suffixes, e.g. <tt>.pdf.gz</tt>, where the
context includes the suffix it will be looked up starting with the
longest possible suffix until a match for the style is found.
For example, if <tt>.pdf.gz</tt> produces a match for the handler, that
will be used; otherwise the handler for <tt>.gz</tt> will be used.  Note
that, owing to the way suffix aliases work, it is always required that
there be a handler for the shortest possible suffix, so in this example
<tt>.pdf.gz</tt> can only be handled if <tt>.gz</tt> is also handled (though
not necessarily in the same way).  Alternatively, if no handling
for <tt>.gz</tt> on its own is needed, simply adding the command
</p>
<div class="example">
<pre class="example">alias -s gz=zsh-mime-handler
</pre></div>

<p>to the initialisation code is sufficient; <tt>.gz</tt> will not be handled
on its own, but may be in combination with other suffixes.
</p>
<dl compact="compact">
<dd><a name="index-current_002dshell_002c-MIME-style"></a>
</dd>
<dt><tt>current-shell</tt></dt>
<dd><p>If this boolean style is true, the mailcap handler for the context in
question is run using the <tt>eval</tt> builtin instead of by starting a new
<tt>sh</tt> process.  This is more efficient, but may not work in the occasional
cases where the mailcap handler uses strict POSIX syntax.
</p>
<a name="index-disown_002c-MIME-style"></a>
</dd>
<dt><tt>disown</tt></dt>
<dd><p>If this boolean style is true, mailcap handlers started in the
background will be disowned, i.e. not subject to job control within
the parent shell.  Such handlers nearly always produce their own
windows, so the only likely harmful side effect of setting the style is
that it becomes harder to kill jobs from within the shell.
</p>
<a name="index-execute_002das_002dis_002c-MIME-style"></a>
</dd>
<dt><tt>execute-as-is</tt></dt>
<dd><p>This style gives a list of patterns to be matched against files
passed for execution with a handler program.  If the file matches
the pattern, the entire command line is executed in its current form,
with no handler.  This is useful for files which might have suffixes
but nonetheless be executable in their own right.  If the style
is not set, the pattern <tt>*(*) *(/)</tt> is used;
hence executable files are executed directly and not passed to a
handler, and the option <tt>AUTO_CD</tt> may be used to change to directories
that happen to have MIME suffixes.
</p>
<a name="index-execute_002dnever_002c-MIME-style"></a>
</dd>
<dt><tt>execute-never</tt></dt>
<dd><p>This style is useful in combination with <tt>execute-as-is</tt>.  It is
set to an array of patterns corresponding to full paths to files that
should never be treated as executable, even if the file passed to
the MIME handler matches <tt>execute-as-is</tt>.  This is useful for file
systems that don&rsquo;t handle execute permission or that contain executables
from another operating system.  For example, if <tt>/mnt/windows</tt> is a
Windows mount, then
</p>
<div class="example">
<pre class="example">zstyle ':mime:*' execute-never '/mnt/windows/*'
</pre></div>

<p>will ensure that any files found in that area will be executed as MIME
types even if they are executable.  As this example shows, the complete
file name is matched against the pattern, regardless of how the file
was passed to the handler.  The file is resolved to a full path using
the <tt>:P</tt> modifier described in
<a href="Expansion.html#Modifiers">Modifiers</a>;
this means that symbolic links are resolved where possible, so that
links into other file systems behave in the correct fashion.
</p>
<a name="index-file_002dpath_002c-MIME-style"></a>
</dd>
<dt><tt>file-path</tt></dt>
<dd><p>Used if the style <tt>find-file-in-path</tt> is true for the same context.
Set to an array of directories that are used for searching for the
file to be handled; the default is the command path given by the
special parameter <tt>path</tt>.  The shell option <tt>PATH_DIRS</tt> is respected;
if that is set, the appropriate path will be searched even if the
name of the file to be handled as it appears on the command line contains
a &lsquo;<tt>/</tt>&rsquo;.
The full context is <tt>:mime:.</tt><var>suffix</var><tt>:</tt>, as described for the style
<tt>handler</tt>.
</p>
<a name="index-find_002dfile_002din_002dpath_002c-MIME-style"></a>
</dd>
<dt><tt>find-file-in-path</tt></dt>
<dd><p>If set, allows files whose names do not contain absolute paths
to be searched for in the command path or the path specified by the
<tt>file-path</tt> style.  If the file is not found in the path, it is looked
for locally (whether or not the current directory is in the path); if it is
not found locally, the handler will abort unless the <tt>handle-nonexistent</tt>
style is set.  Files found in the path are tested as described for
the style <tt>execute-as-is</tt>.
The full context is <tt>:mime:.</tt><var>suffix</var><tt>:</tt>, as described for the style
<tt>handler</tt>.
</p>
<a name="index-flags_002c-MIME-style"></a>
</dd>
<dt><tt>flags</tt></dt>
<dd><p>Defines flags to go with a handler; the context is as for the
<tt>handler</tt> style, and the format is as for the flags in <tt>mailcap</tt>.
</p>
<a name="index-handle_002dnonexistent_002c-MIME-style"></a>
</dd>
<dt><tt>handle-nonexistent</tt></dt>
<dd><p>By default, arguments that don&rsquo;t correspond to files are not passed
to the MIME handler in order to prevent it from intercepting commands found
in the path that happen to have suffixes.  This style may be set to
an array of extended glob patterns for arguments that will be passed to the
handler even if they don&rsquo;t exist.  If it is not explicitly set it
defaults to <tt>[[:alpha:]]#:/*</tt> which allows URLs to be passed to the MIME
handler even though they don&rsquo;t exist in that format in the file system.
The full context is <tt>:mime:.</tt><var>suffix</var><tt>:</tt>, as described for the style
<tt>handler</tt>.
</p>
<a name="index-handler_002c-MIME-style"></a>
</dd>
<dt><tt>handler</tt></dt>
<dd><p>Specifies a handler for a suffix; the suffix is given by the context as
<tt>:mime:.</tt><var>suffix</var><tt>:</tt>, and the format of the handler is exactly
that in <tt>mailcap</tt>.  Note in particular the &lsquo;<tt>.</tt>&rsquo; and trailing colon
to distinguish this use of the context.  This overrides any handler
specified by the <tt>mailcap</tt> files.  If the handler requires a terminal,
the <tt>flags</tt> style should be set to include the word <tt>needsterminal</tt>,
or if the output is to be displayed through a pager (but not if the
handler is itself a pager), it should include <tt>copiousoutput</tt>.
</p>
<a name="index-mailcap_002c-MIME-style"></a>
</dd>
<dt><tt>mailcap</tt></dt>
<dd><p>A list of files in the format of <tt>~/.mailcap</tt> and
<tt>/etc/mailcap</tt> to be read during setup, replacing the default list
which consists of those two files.  The context is <tt>:mime:</tt>.
A <tt>+</tt> in the list will be replaced by the default files.
</p>
<a name="index-mailcap_002dpriorities_002c-MIME-style"></a>
</dd>
<dt><tt>mailcap-priorities</tt></dt>
<dd><p>This style is used to resolve multiple mailcap entries for the same MIME
type.  It consists of an array of the following elements, in descending
order of priority; later entries will be used if earlier entries are
unable to resolve the entries being compared.  If none of the tests
resolve the entries, the first entry encountered is retained.
</p>
<dl compact="compact">
<dt><tt>files</tt></dt>
<dd><p>The order of files (entries in the <tt>mailcap</tt> style) read.  Earlier
files are preferred.  (Note this does not resolve entries in the same file.)
</p>
</dd>
<dt><tt>priority</tt></dt>
<dd><p>The priority flag from the mailcap entry.  The priority is an integer
from 0 to 9 with the default value being 5.
</p>
</dd>
<dt><tt>flags</tt></dt>
<dd><p>The test given by the <tt>mailcap-prio-flags</tt> option is used to resolve
entries.
</p>
</dd>
<dt><tt>place</tt></dt>
<dd><p>Later entries are preferred; as the entries are strictly ordered, this
test always succeeds.
</p>
</dd>
</dl>

<p>Note that as this style is handled during initialisation, the context
is always <tt>:mime:</tt>, with no discrimination by suffix.
</p>
<a name="index-mailcap_002dprio_002dflags_002c-MIME-style"></a>
</dd>
<dt><tt>mailcap-prio-flags</tt></dt>
<dd><p>This style is used when the keyword <tt>flags</tt> is encountered in the
list of tests specified by the <tt>mailcap-priorities</tt> style.
It should be set to a list of patterns, each of which is tested against
the flags specified in the mailcap entry (in other words, the sets of
assignments found with some entries in the mailcap file).  Earlier
patterns in the list are preferred to later ones, and matched patterns
are preferred to unmatched ones.
</p>
<a name="index-mime_002dtypes_002c-MIME-style"></a>
</dd>
<dt><tt>mime-types</tt></dt>
<dd><p>A list of files in the format of <tt>~/.mime.types</tt> and
<tt>/etc/mime.types</tt> to be read during setup, replacing the default list
which consists of those two files.  The context is <tt>:mime:</tt>.
A <tt>+</tt> in the list will be replaced by the default files.
</p>
<a name="index-never_002dbackground_002c-MIME-style"></a>
</dd>
<dt><tt>never-background</tt></dt>
<dd><p>If this boolean style is set, the handler for the given context is
always run in the foreground, even if the flags provided in the mailcap
entry suggest it need not be (for example, it doesn&rsquo;t require a
terminal).
</p>
<a name="index-pager_002c-MIME-style"></a>
</dd>
<dt><tt>pager</tt></dt>
<dd><p>If set, will be used instead of <tt>$PAGER</tt> or <tt>more</tt> to handle
suffixes where the <tt>copiousoutput</tt> flag is set.  The context is
as for <tt>handler</tt>, i.e. <tt>:mime:.</tt><var>suffix</var><tt>:</tt> for handling
a file with the given <var>suffix</var>.
</p>
</dd>
</dl>

<p>Examples:
</p>
<div class="example">
<pre class="example">zstyle ':mime:*' mailcap ~/.mailcap /usr/local/etc/mailcap
zstyle ':mime:.txt:' handler less %s
zstyle ':mime:.txt:' flags needsterminal
</pre></div>

<p>When <tt>zsh-mime-setup</tt> is subsequently run, it will look for
<tt>mailcap</tt> entries in the two files given.  Files of suffix <tt>.txt</tt>
will be handled by running &lsquo;<tt>less</tt> <var>file.txt</var>&rsquo;.  The flag
<tt>needsterminal</tt> is set to show that this program must run attached to a
terminal.
</p>
<p>As there are several steps to dispatching a command, the following
should be checked if attempting to execute a file by extension
<tt>.</tt><var>ext</var> does not have the expected effect.
</p>
<p>The command &lsquo;<tt>alias -s</tt> <var>ext</var>&rsquo; should show
&lsquo;<tt>ps=zsh-mime-handler</tt>&rsquo;.  If it shows something else, another suffix
alias was already installed and was not overwritten.  If it shows
nothing, no handler was installed:  this is most likely because no
handler was found in the <tt>.mime.types</tt> and <tt>mailcap</tt> combination for
<tt>.ext</tt> files.  In that case, appropriate handling should be added to
<tt>~/.mime.types</tt> and <tt>mailcap</tt>.
</p>
<p>If the extension is handled by <tt>zsh-mime-handler</tt> but the file is
not opened correctly, either the handler defined for the type is
incorrect, or the flags associated with it are in appropriate.  Running
<tt>zsh-mime-setup -l</tt> will show the handler and, if there are any, the
flags.  A <tt>%s</tt> in the handler is replaced by the file (suitably quoted
if necessary).  Check that the handler program listed lists and can
be run in the way shown.  Also check that the flags <tt>needsterminal</tt> or
<tt>copiousoutput</tt> are set if the handler needs to be run under a
terminal; the second flag is used if the output should be sent to a pager.
An example of a suitable <tt>mailcap</tt> entry for such a program is:
</p>
<div class="example">
<pre class="example">text/html; /usr/bin/lynx '%s'; needsterminal
</pre></div>

<p>Running &lsquo;<tt>zsh-mime-handler -l</tt> <var>command line</var>&rsquo; prints the command
line that would be executed, simplified to remove the effect of any
flags, and quoted so that the output can be run as a complete zsh
command line.  This is used by the completion system to decide how to
complete after a file handled by <tt>zsh-mime-setup</tt>.
</p>
<a name="index-pick_002dweb_002dbrowser"></a>
</dd>
<dt><tt>pick-web-browser</tt></dt>
<dd><p>This function is separate from the two MIME functions described above
and can be assigned directly to a suffix:
</p>
<div class="example">
<pre class="example">autoload -U pick-web-browser
alias -s html=pick-web-browser
</pre></div>

<p>It is provided as an intelligent front end to dispatch a web browser.
It may be run as either a function or a shell script.  The status
255 is returned if no browser could be started.
</p>
<p>Various styles are available to customize the choice of browsers:
</p>
<dl compact="compact">
<dt><tt>browser-style</tt></dt>
<dd><p>The value of the style is an array giving preferences in decreasing order
for the type of browser to use.  The values of elements may be
</p>
<dl compact="compact">
<dt><tt>running</tt></dt>
<dd><p>Use a GUI browser that is already running when an X Window display is
available.  The browsers listed in the <tt>x-browsers</tt> style are tried
in order until one is found; if it is, the file will be displayed in
that browser, so the user may need to check whether it has appeared.
If no running browser is found, one is not started.  Browsers other than
Firefox, Opera and Konqueror are assumed to understand the Mozilla
syntax for opening a URL remotely.
</p>
</dd>
<dt><tt>x</tt></dt>
<dd><p>Start a new GUI browser when an X Window display is available.  Search for
the availability of one of the browsers listed in the <tt>x-browsers</tt> style
and start the first one that is found.  No check is made for an already
running browser.
</p>
</dd>
<dt><tt>tty</tt></dt>
<dd><p>Start a terminal-based browser.  Search for the availability of one
of the browsers listed in the <tt>tty-browsers</tt> style and start the
first one that is found.
</p>
</dd>
</dl>

<p>If the style is not set the default <tt>running x tty</tt> is used.
</p>
</dd>
<dt><tt>x-browsers</tt></dt>
<dd><p>An array in decreasing order
of preference of browsers to use when running under the X Window System.
The array consists of the command name under which to start the
browser.  They are looked up in the context <tt>:mime:</tt> (which may
be extended in future, so appending &lsquo;<tt>*</tt>&rsquo; is recommended).  For
example,
</p>
<div class="example">
<pre class="example">zstyle ':mime:*' x-browsers opera konqueror firefox
</pre></div>

<p>specifies that <tt>pick-web-browser</tt> should first look for a running
instance of Opera, Konqueror or Firefox, in that order, and if it
fails to find any should attempt to start Opera.  The default is
<tt>firefox mozilla netscape opera konqueror</tt>.
</p>
</dd>
<dt><tt>tty-browsers</tt></dt>
<dd><p>An array similar to <tt>x-browsers</tt>, except that it gives browsers to
use when no X Window display is available.  The default is
<tt>elinks links lynx</tt>.
</p>
</dd>
<dt><tt>command</tt></dt>
<dd><p>If it is set this style is used to pick the command
used to open a page for a browser.  The context is
<tt>:mime:browser:new:$browser:</tt> to start a new browser or
<tt>:mime:browser:running:$browser:</tt> to open a URL in a browser already
running on the current X display, where <tt>$browser</tt> is the value matched
in the <tt>x-browsers</tt> or <tt>tty-browsers</tt> style.  The escape sequence
<tt>%b</tt> in the style&rsquo;s value will be replaced by the browser, while <tt>%u</tt>
will be replaced by the URL.  If the style is not set, the default for all
new instances is equivalent to <tt>%b %u</tt> and the defaults for using running
browsers are equivalent to the values <tt>kfmclient openURL %u</tt> for
Konqueror, <tt>firefox -new-tab %u</tt> for Firefox, <tt>opera -newpage %u</tt>
for Opera, and <tt>%b -remote &quot;openUrl(%u)&quot;</tt> for all others.
</p>
</dd>
</dl>

</dd>
</dl>

<hr>
<a name="Mathematical-Functions"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#MIME-Functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-Contributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#User-Configuration-Functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="Mathematical-Functions-1"></a>
<h2 class="section">26.10 Mathematical Functions</h2>

<dl compact="compact">
<dd><a name="index-zcalc"></a>
</dd>
<dt><tt>zcalc</tt> [ <tt>-erf</tt> ] [ <var>expression</var> ... ]</dt>
<dd><p>A reasonably powerful calculator based on zsh&rsquo;s arithmetic evaluation
facility.  The syntax is similar to that of formulae in most programming
languages; see
<a href="Arithmetic-Evaluation.html#Arithmetic-Evaluation">Arithmetic Evaluation</a> for details.
</p>
<p>Non-programmers should note that, as in many other programming
languages, expressions involving only integers (whether constants
without a &lsquo;<tt>.</tt>&rsquo;, variables containing such constants as strings, or
variables declared to be integers) are by default evaluated using
integer arithmetic, which is not how an ordinary desk calculator
operates.  To force floating point operation, pass the option <tt>-f</tt>;
see further notes below.
</p>
<p>If the file <tt>~/.zcalcrc</tt> exists it will be sourced inside the function
once it is set up and about to process the command line.  This
can be used, for example, to set shell options; <tt>emulate -L zsh</tt>
and <tt>setopt extendedglob</tt> are in effect at this point.  Any
failure to source the file if it exists is treated as fatal.
As with other initialisation files, the directory <tt>$ZDOTDIR</tt> is used
instead of <tt>$HOME</tt> if it is set.
</p>
<p>The mathematical library <tt>zsh/mathfunc</tt> will be loaded if it is
available; see
<a href="Zsh-Modules.html#The-zsh_002fmathfunc-Module">The zsh/mathfunc Module</a>.  The mathematical functions
correspond to the raw system libraries, so trigonometric functions are
evaluated using radians, and so on.
</p>
<p>Each line typed is evaluated as an expression.  The prompt shows a number,
which corresponds to a positional parameter where the result of that
calculation is stored.  For example, the result of the calculation on the
line preceded by &lsquo;<tt>4&gt; </tt>&rsquo; is available as <tt>$4</tt>.  The last value
calculated is available as <tt>ans</tt>.  Full command line editing, including
the history of previous calculations, is available; the history is saved in
the file <tt>~/.zcalc_history</tt>.  To exit, enter a blank line or type &lsquo;<tt>:q</tt>&rsquo;
on its own (&lsquo;<tt>q</tt>&rsquo; is allowed for historical compatibility).
</p>
<p>A line ending with a single backslash is treated in the same fashion
as it is in command line editing:  the backslash is removed, the
function prompts for more input (the prompt is preceded by &lsquo;<tt>...</tt>&rsquo;
to indicate this), and the lines are combined into one to get the final
result.  In addition, if the input so far contains more open than
close parentheses <tt>zcalc</tt> will prompt for more input.
</p>
<p>If arguments are given to <tt>zcalc</tt> on start up, they are used to prime the
first few positional parameters.  A visual indication of this is given when
the calculator starts.
</p>
<p>The constants <tt>PI</tt> (3.14159...) and <tt>E</tt> (2.71828...) are provided.
Parameter assignment is possible, but note that all parameters will be
put into the global namespace unless the <tt>:local</tt> special command is
used.  The function creates local variables whose names start with
<tt>_</tt>, so users should avoid doing so.  The variables <tt>ans</tt> (the last
answer) and <tt>stack</tt> (the stack in RPN mode) may be referred to
directly; <tt>stack</tt> is an array but elements of it are numeric.  Various
other special variables are used locally with their standard meaning,
for example <tt>compcontext</tt>, <tt>match</tt>, <tt>mbegin</tt>, <tt>mend</tt>, <tt>psvar</tt>.
</p>
<p>The output base can be initialised by passing the option &lsquo;<tt>-#</tt><var>base</var>&rsquo;,
for example &lsquo;<tt>zcalc -#16</tt>&rsquo; (the &lsquo;<tt>#</tt>&rsquo; may have to be quoted, depending
on the globbing options set).
</p>
<p>If the option &lsquo;<tt>-e</tt>&rsquo; is set, the function runs non-interactively:
the arguments are treated as expressions to be evaluated as if entered
interactively line by line.
</p>
<p>If the option &lsquo;<tt>-f</tt>&rsquo; is set, all numbers are treated as floating
point, hence for example the expression &lsquo;<tt>3/4</tt>&rsquo; evaluates to 0.75
rather than 0.  Options must appear in separate words.
</p>
<p>If the option &lsquo;<tt>-r</tt>&rsquo; is set, RPN (Reverse Polish Notation) mode is
entered.  This has various additional properties:
</p><dl compact="compact">
<dt>Stack</dt>
<dd><p>Evaluated values are maintained in a stack; this is contained in
an array named <tt>stack</tt> with the most recent value in <tt>${stack[1]}</tt>.
</p>
</dd>
<dt>Operators and functions</dt>
<dd><p>If the line entered matches an operator (<tt>+</tt>, <tt>-</tt>, <tt>*</tt>,
<tt>/</tt>, <tt>**</tt>, <tt>^</tt>, <tt>|</tt> or <tt>&amp;</tt>) or a function supplied by the
<tt>zsh/mathfunc</tt> library, the bottom element or elements of the stack
are popped to use as the argument or arguments.  The higher elements
of stack (least recent) are used as earlier arguments.  The result is
then pushed into <tt>${stack[1]}</tt>.
</p>
</dd>
<dt>Expressions</dt>
<dd><p>Other expressions are evaluated normally, printed, and added to the
stack as numeric values.  The syntax within expressions on a single line
is normal shell arithmetic (not RPN).
</p>
</dd>
<dt>Stack listing</dt>
<dd><p>If an integer follows the option <tt>-r</tt> with no space, then
on every evaluation that many elements of the stack, where available,
are printed instead of just the most recent result.  Hence, for example,
<tt>zcalc -r4</tt> shows <tt>$stack[4]</tt> to <tt>$stack[1]</tt> each time results
are printed.
</p>
</dd>
<dt>Duplication: <tt>=</tt></dt>
<dd><p>The pseudo-operator <tt>=</tt> causes the most recent element of
the stack to be duplicated onto the stack.
</p>
</dd>
<dt><tt>pop</tt></dt>
<dd><p>The pseudo-function <tt>pop</tt> causes the most recent element of
the stack to be popped.  A &lsquo;<tt>&gt;</tt>&rsquo; on its own has the same effect.
</p>
</dd>
<dt><tt>&gt;</tt><var>ident</var></dt>
<dd><p>The expression <tt>&gt;</tt> followed (with no space) by a shell identifier
causes the most recent element of the stack to be popped and
assigned to the variable with that name.  The variable is
local to the <tt>zcalc</tt> function.
</p>
</dd>
<dt><tt>&lt;</tt><var>ident</var></dt>
<dd><p>The expression <tt>&lt;</tt> followed (with no space) by a shell identifier
causes the value of the variable with that name to be pushed
onto the stack.  <var>ident</var> may be an integer, in which
case the previous result with that number (as shown before
the <tt>&gt;</tt> in the standard <tt>zcalc</tt> prompt) is put on the stack.
</p>
</dd>
<dt>Exchange: <tt>xy</tt></dt>
<dd><p>The pseudo-function <tt>xy</tt> causes the most recent two elements of
the stack to be exchanged.  &lsquo;<tt>&lt;&gt;</tt>&rsquo; has the same effect.
</p>
</dd>
</dl>

<p>The prompt is configurable via the parameter <tt>ZCALCPROMPT</tt>, which
undergoes standard prompt expansion.  The index of the current entry is
stored locally in the first element of the array <tt>psvar</tt>, which can be
referred to in <tt>ZCALCPROMPT</tt> as &lsquo;<tt>%1v</tt>&rsquo;.  The default prompt is
&lsquo;<tt>%1v&gt; </tt>&rsquo;.
</p>
<p>The variable <tt>ZCALC_ACTIVE</tt> is set within the function and can
be tested by nested functions; it has the value <tt>rpn</tt> if RPN mode is
active, else 1.
</p>
<p>A few special commands are available; these are introduced by a colon.
For backward compatibility, the colon may be omitted for certain
commands.  Completion is available if <tt>compinit</tt> has been run.
</p>
<p>The output precision may be specified within zcalc by special commands
familiar from many calculators.
</p><dl compact="compact">
<dt><tt>:norm</tt></dt>
<dd><p>The default output format.  It corresponds to the printf <tt>%g</tt>
specification.  Typically this shows six decimal digits.
</p>
</dd>
<dt><tt>:sci</tt> <var>digits</var></dt>
<dd><p>Scientific notation, corresponding to the printf <tt>%g</tt> output format with
the precision given by <var>digits</var>.  This produces either fixed point or
exponential notation depending on the value output.
</p>
</dd>
<dt><tt>:fix</tt> <var>digits</var></dt>
<dd><p>Fixed point notation, corresponding to the printf <tt>%f</tt> output format with
the precision given by <var>digits</var>.
</p>
</dd>
<dt><tt>:eng</tt> <var>digits</var></dt>
<dd><p>Exponential notation, corresponding to the printf <tt>%E</tt> output format with
the precision given by <var>digits</var>.
</p>
</dd>
<dt><tt>:raw</tt></dt>
<dd><p>Raw output:  this is the default form of the output from a math
evaluation.  This may show more precision than the number actually
possesses.
</p>
</dd>
</dl>

<p>Other special commands:
</p><dl compact="compact">
<dt><tt>:!</tt><var>line...</var></dt>
<dd><p>Execute <var>line...</var> as a normal shell command line.  Note that it
is executed in the context of the function, i.e. with local variables.
Space is optional after <tt>:!</tt>.
</p>
</dd>
<dt><tt>:local</tt> <var>arg</var> ...</dt>
<dd><p>Declare variables local to the function.  Other variables
may be used, too, but they will be taken from or put into the global
scope.
</p>
</dd>
<dt><tt>:function</tt> <var>name</var> [ <var>body</var> ]</dt>
<dd><p>Define a mathematical function or (with no <var>body</var>) delete it.
<tt>:function</tt> may be abbreviated to <tt>:func</tt> or simply <tt>:f</tt>.
The <var>name</var> may contain the same characters as a shell function name.
The function is defined using <tt>zmathfuncdef</tt>, see below.
</p>
<p>Note that <tt>zcalc</tt> takes care of all quoting.  Hence for example:
</p>
<div class="example">
<pre class="example">:f cube $1 * $1 * $1
</pre></div>

<p>defines a function to cube the sole argument.  Functions so defined, or
indeed any functions defined directly or indirectly using <tt>functions
-M</tt>, are available to execute by typing only the name on the line in RPN
mode; this pops the appropriate number of arguments off the stack
to pass to the function, i.e. 1 in the case of the example <tt>cube</tt>
function.  If there are optional arguments only the mandatory
arguments are supplied by this means.
</p>
</dd>
<dt><tt>[#</tt><var>base</var><tt>]</tt></dt>
<dd><p>This is not a special command, rather part of normal arithmetic
syntax; however, when this form appears on a line by itself the default
output radix is set to <var>base</var>.  Use, for example, &lsquo;<tt>[#16]</tt>&rsquo; to display
hexadecimal output preceded by an indication of the base, or &lsquo;<tt>[##16]</tt>&rsquo;
just to display the raw number in the given base.  Bases themselves are
always specified in decimal. &lsquo;<tt>[#]</tt>&rsquo; restores the normal output format.
Note that setting an output base suppresses floating point output; use
&lsquo;<tt>[#]</tt>&rsquo; to return to normal operation.
</p>
</dd>
<dt><tt>$</tt><var>var</var></dt>
<dd><p>Print out the value of var literally; does not affect the calculation.
To use the value of var, omit the leading &lsquo;<tt>$</tt>&rsquo;.
</p>
</dd>
</dl>

<p>See the comments in the function for a few extra tips.
</p>
<a name="index-max"></a>
<a name="index-min"></a>
<a name="index-sum"></a>
<a name="index-zmathfunc"></a>
</dd>
<dt><tt>min(</tt><var>arg</var><tt>, ...)</tt></dt>
<dt><tt>max(</tt><var>arg</var><tt>, ...)</tt></dt>
<dt><tt>sum(</tt><var>arg</var><tt>, ...)</tt></dt>
<dt><tt>zmathfunc</tt></dt>
<dd><p>The function <tt>zmathfunc</tt> defines the three mathematical functions
<tt>min</tt>, <tt>max</tt>, and <tt>sum</tt>.  The functions <tt>min</tt> and <tt>max</tt> take
one or more arguments.  The function <tt>sum</tt> takes zero or more arguments.
Arguments can be of different types (ints and floats).
</p>
<p>Not to be confused with the <tt>zsh/mathfunc</tt> module, described in
<a href="Zsh-Modules.html#The-zsh_002fmathfunc-Module">The zsh/mathfunc Module</a>.
</p>
<a name="index-zmathfuncdef"></a>
</dd>
<dt><tt>zmathfuncdef</tt> [ <var>mathfunc</var> [ <var>body</var> ] ]</dt>
<dd><p>A convenient front end to <tt>functions -M</tt>.
</p>
<p>With two arguments, define a mathematical function named <var>mathfunc</var>
which can be used in any form of arithmetic evaluation.  <var>body</var>
is a mathematical expression to implement the function.  It may
contain references to position parameters <tt>$1</tt>, <tt>$2</tt>, ...
to refer to mandatory parameters and <tt>${1:-</tt><var>defvalue</var><tt>}</tt> ...
to refer to optional parameters.  Note that the forms must be
strictly adhered to for the function to calculate the correct number
of arguments.  The implementation is held in a shell function named
<tt>zsh_math_func_</tt><var>mathfunc</var>; usually the user will not need
to refer to the shell function directly.  Any existing function
of the same name is silently replaced.
</p>
<p>With one argument, remove the mathematical function <var>mathfunc</var>
as well as the shell function implementation.
</p>
<p>With no arguments, list all <var>mathfunc</var> functions in a form
suitable for restoring the definition.
The functions have not necessarily been defined by <tt>zmathfuncdef</tt>.
</p>
</dd>
</dl>

<hr>
<a name="User-Configuration-Functions"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Mathematical-Functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-Contributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Other-Functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="User-Configuration-Functions-1"></a>
<h2 class="section">26.11 User Configuration Functions</h2>

<p>The <tt>zsh/newuser</tt> module comes with a function to aid in configuring
shell options for new users.  If the module is installed, this function can
also be run by hand.  It is available even if the module&rsquo;s default
behaviour, namely running the function for a new user logging in without
startup files, is inhibited.
</p>
<dl compact="compact">
<dt><tt>zsh-newuser-install</tt> [ <tt>-f</tt> ]</dt>
<dd><p>The function presents the user with various options for customizing
their initialization scripts.  Currently only <tt>~/.zshrc</tt> is handled.
<tt>$ZDOTDIR/.zshrc</tt> is used instead if the parameter <tt>ZDOTDIR</tt> is
set; this provides a way for the user to configure a file without
altering an existing <tt>.zshrc</tt>.
</p>
<p>By default the function exits immediately if it finds any of the files
<tt>.zshenv</tt>, <tt>.zprofile</tt>, <tt>.zshrc</tt>, or <tt>.zlogin</tt> in the appropriate
directory.  The option <tt>-f</tt> is required in order to force the function
to continue.  Note this may happen even if <tt>.zshrc</tt> itself does not
exist.
</p>
<p>As currently configured, the function will exit immediately if the
user has root privileges; this behaviour cannot be overridden.
</p>
<p>Once activated, the function&rsquo;s behaviour is supposed to be
self-explanatory.  Menus are present allowing the user to alter
the value of options and parameters.  Suggestions for improvements are
always welcome.
</p>
<p>When the script exits, the user is given the opportunity to save the new
file or not; changes are not irreversible until this point.  However,
the script is careful to restrict changes to the file only to a group
marked by the lines &lsquo;<tt># Lines configured by zsh-newuser-install</tt>&rsquo; and
&lsquo;<tt># End of lines configured by zsh-newuser-install</tt>&rsquo;.  In addition,
the old version of <tt>.zshrc</tt> is saved to a file with the suffix
<tt>.zni</tt> appended.
</p>
<p>If the function edits an existing <tt>.zshrc</tt>, it is up to the user
to ensure that the changes made will take effect.  For example, if
control usually returns early from the existing <tt>.zshrc</tt> the lines
will not be executed; or a later initialization file may override
options or parameters, and so on.  The function itself does not attempt to
detect any such conflicts.
</p>
</dd>
</dl>

<hr>
<a name="Other-Functions"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-Configuration-Functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#User-Contributions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Descriptions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<a name="Other-Functions-1"></a>
<h2 class="section">26.12 Other Functions</h2>

<p>There are a large number of helpful functions in the <tt>Functions/Misc</tt>
directory of the zsh distribution.  Most are very simple and do not
require documentation here, but a few are worthy of special mention.
</p>

<hr>
<a name="Descriptions"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Other-Functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Other-Functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Styles" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.12.1 Descriptions</h3>

<dl compact="compact">
<dd><a name="index-colors"></a>
</dd>
<dt><tt>colors</tt></dt>
<dd><p>This function initializes several associative arrays to map color names to
(and from) the ANSI standard eight-color terminal codes.  These are used
by the prompt theme system (<a href="#Prompt-Themes">Prompt Themes</a>).  You seldom should need to run
<tt>colors</tt> more than once.
</p>
<p>The eight base colors are: <tt>black</tt>, <tt>red</tt>, <tt>green</tt>, <tt>yellow</tt>,
<tt>blue</tt>, <tt>magenta</tt>, <tt>cyan</tt>, and <tt>white</tt>.  Each of these has codes for
foreground and background.  In addition there are seven intensity attributes:
<tt>bold</tt>, <tt>faint</tt>, <tt>standout</tt>, <tt>underline</tt>, <tt>blink</tt>, <tt>reverse</tt>,
and <tt>conceal</tt>.  Finally, there are seven codes used to negate attributes:
<tt>none</tt> (reset all attributes to the defaults), <tt>normal</tt>
(neither bold nor faint), <tt>no-standout</tt>, <tt>no-underline</tt>, <tt>no-blink</tt>,
<tt>no-reverse</tt>, and <tt>no-conceal</tt>.
</p>
<p>Some terminals do not support all combinations of colors and intensities.
</p>
<p>The associative arrays are:
</p>
<dl compact="compact">
<dt><tt>color</tt></dt>
<dt><tt>colour</tt></dt>
<dd><p>Map all the color names to their integer codes, and integer codes to the
color names.  The eight base names map to the foreground color codes, as
do names prefixed with &lsquo;<tt>fg-</tt>&rsquo;, such as &lsquo;<tt>fg-red</tt>&rsquo;.  Names prefixed
with &lsquo;<tt>bg-</tt>&rsquo;, such as &lsquo;<tt>bg-blue</tt>&rsquo;, refer to the background codes.  The
reverse mapping from code to color yields base name for foreground codes
and the <tt>bg-</tt> form for backgrounds.
</p>
<p>Although it is a misnomer to call them &lsquo;colors&rsquo;, these arrays also map the
other fourteen attributes from names to codes and codes to names.
</p>
</dd>
<dt><tt>fg</tt></dt>
<dt><tt>fg_bold</tt></dt>
<dt><tt>fg_no_bold</tt></dt>
<dd><p>Map the eight basic color names to ANSI terminal escape sequences that set
the corresponding foreground text properties.  The <tt>fg</tt> sequences change
the color without changing the eight intensity attributes.
</p>
</dd>
<dt><tt>bg</tt></dt>
<dt><tt>bg_bold</tt></dt>
<dt><tt>bg_no_bold</tt></dt>
<dd><p>Map the eight basic color names to ANSI terminal escape sequences that set
the corresponding background properties.  The <tt>bg</tt> sequences change the
color without changing the eight intensity attributes.
</p>
</dd>
</dl>

<p>In addition, the scalar parameters <tt>reset_color</tt> and <tt>bold_color</tt> are
set to the ANSI terminal escapes that turn off all attributes and turn on
bold intensity, respectively.
</p>
<a name="index-fned"></a>
</dd>
<dt><tt>fned</tt> [ <tt>-x</tt> <var>num</var> ] <var>name</var></dt>
<dd><p>Same as <tt>zed -f</tt>.  This function does not appear in the zsh
distribution, but can be created by linking <tt>zed</tt> to the name <tt>fned</tt>
in some directory in your <tt>fpath</tt>.
</p>
<a name="index-histed"></a>
</dd>
<dt><tt>histed</tt> [ [ <var>name</var> ] <var>size</var> ]</dt>
<dd><p>Same as <tt>zed -h</tt>.  This function does not appear in the zsh
distribution, but can be created by linking <tt>zed</tt> to the name <tt>histed</tt>
in some directory in your <tt>fpath</tt>.
</p>
<a name="index-is_002dat_002dleast"></a>
</dd>
<dt><tt>is-at-least</tt> <var>needed</var> [ <var>present</var> ]</dt>
<dd><p>Perform a greater-than-or-equal-to comparison of two strings having the
format of a zsh version number; that is, a string of numbers and text with
segments separated by dots or dashes.  If the <var>present</var> string is not
provided, <tt>$ZSH_VERSION</tt> is used.  Segments are paired left-to-right in
the two strings with leading non-number parts ignored.  If one string has
fewer segments than the other, the missing segments are considered zero.
</p>
<p>This is useful in startup files to set options and other state that are
not available in all versions of zsh.
</p>
<div class="example">
<pre class="example">is-at-least 3.1.6-15 &amp;&amp; setopt NO_GLOBAL_RCS
is-at-least 3.1.0 &amp;&amp; setopt HIST_REDUCE_BLANKS
is-at-least 2.6-17 || print &quot;You can't use is-at-least here.&quot;
</pre></div>

<a name="index-nslookup"></a>
</dd>
<dt><tt>nslookup</tt> [ <var>arg</var> ... ]</dt>
<dd><p>This wrapper function for the <tt>nslookup</tt> command requires the
<tt>zsh/zpty</tt> module (see
<a href="Zsh-Modules.html#The-zsh_002fzpty-Module">The zsh/zpty Module</a>).  It behaves exactly like the standard <tt>nslookup</tt>
except that it provides customizable prompts (including a right-side
prompt) and completion of nslookup commands, host names, etc. (if you use
the function-based completion system).  Completion styles may be set with
the context prefix &lsquo;<tt>:completion:nslookup</tt>&rsquo;.
</p>
<p>See also the <tt>pager</tt>, <tt>prompt</tt> and <tt>rprompt</tt> styles below.
</p>
<a name="index-regexp_002dreplace"></a>
</dd>
<dt><tt>regexp-replace</tt> <var>var</var> <var>regexp</var> <var>replace</var></dt>
<dd><p>Use regular expressions to perform a global search and replace operation
on a variable.  POSIX extended regular expressions (ERE) are used,
unless the option <tt>RE_MATCH_PCRE</tt> has been set, in which case
Perl-compatible regular expressions are used
(this requires the shell to be linked against the <tt>pcre</tt>
library).
</p>
<p><var>var</var> is the name of the variable containing the string to be matched.
The variable will be modified directly by the function.  The
variables <tt>MATCH</tt>, <tt>MBEGIN</tt>, <tt>MEND</tt>, <tt>match</tt>, <tt>mbegin</tt>, <tt>mend</tt>
should be avoided as these are used by the regular expression code.
</p>
<p><var>regexp</var> is the regular expression to match against the string.
</p>
<p><var>replace</var> is the replacement text.  This can contain parameter, command
and arithmetic expressions which will be replaced:  in particular, a
reference to <tt>$MATCH</tt> will be replaced by the text matched by the pattern.
</p>
<p>The return status is 0 if at least one match was performed, else 1.
</p>
<p>Note that if using POSIX EREs, the <tt>^</tt> or word boundary operators
(where available) may not work properly.
</p>
<a name="index-run_002dhelp-1"></a>
</dd>
<dt><tt>run-help</tt> <var>cmd</var></dt>
<dd><p>This function is designed to be invoked by the <tt>run-help</tt> ZLE widget,
in place of the default alias.  See &lsquo;Accessing On-Line Help&rsquo;
(<a href="#Utilities">Utilities</a>) for setup instructions.
</p>
<p>In the discussion which follows, if <var>cmd</var> is a file system path, it is
first reduced to its rightmost component (the file name).
</p>
<p>Help is first sought by looking for a file named <var>cmd</var> in the directory
named by the <tt>HELPDIR</tt> parameter.  If no file is found, an assistant
function, alias, or command named <tt>run-help-<var>cmd</var></tt> is sought.  If
found, the assistant is executed with the rest of the current command line
(everything after the command name <var>cmd</var>) as its arguments.  When
neither file nor assistant is found, the external command
&lsquo;<tt>man</tt> <var>cmd</var>&rsquo; is run.
</p>
<p>An example assistant for the &quot;ssh&quot; command:
</p>
<div class="example">
<pre class="example">run-help-ssh() {
    emulate -LR zsh
    local -a args
    # Delete the &quot;-l username&quot; option
    zparseopts -D -E -a args l:
    # Delete other options, leaving: host command
    args=(${@:#-*})
    if [[ ${#args} -lt 2 ]]; then
        man ssh
    else
        run-help $args[2]
    fi
}
</pre></div>

<p>Several of these assistants are provided in the <tt>Functions/Misc</tt>
directory.  These must be autoloaded, or placed as executable scripts in
your search path, in order to be found and used by <tt>run-help</tt>.
</p>
<dl compact="compact">
<dd><a name="index-run_002dhelp_002dbtrfs"></a>
<a name="index-run_002dhelp_002dgit"></a>
<a name="index-run_002dhelp_002dip"></a>
<a name="index-run_002dhelp_002dopenssl"></a>
<a name="index-run_002dhelp_002dp4"></a>
<a name="index-run_002dhelp_002dsudo"></a>
<a name="index-run_002dhelp_002dsvk"></a>
<a name="index-run_002dhelp_002dsvn"></a>
</dd>
<dt><tt>run-help-btrfs</tt></dt>
<dt><tt>run-help-git</tt></dt>
<dt><tt>run-help-ip</tt></dt>
<dt><tt>run-help-openssl</tt></dt>
<dt><tt>run-help-p4</tt></dt>
<dt><tt>run-help-sudo</tt></dt>
<dt><tt>run-help-svk</tt></dt>
<dt><tt>run-help-svn</tt></dt>
<dd><p>Assistant functions for the
<tt>btrfs</tt>,
<tt>git</tt>,
<tt>ip</tt>,
<tt>openssl</tt>,
<tt>p4</tt>,
<tt>sudo</tt>,
<tt>svk</tt>,
and 
<tt>svn</tt>,
commands.
</p>
</dd>
</dl>

</dd>
<dt><tt>tetris</tt></dt>
<dd><p>Zsh was once accused of not being as complete as Emacs,
because it lacked a Tetris game.  This function was written to
refute this vicious slander.
</p>
<p>This function must be used as a ZLE widget:
</p>
<div class="example">
<pre class="example">autoload -U tetris
zle -N tetris
bindkey <var>keys</var> tetris
</pre></div>

<p>To start a game, execute the widget by typing the <var>keys</var>.  Whatever command
line you were editing disappears temporarily, and your keymap is also
temporarily replaced by the Tetris control keys.  The previous editor state
is restored when you quit the game (by pressing &lsquo;<tt>q</tt>&rsquo;) or when you lose.
</p>
<p>If you quit in the middle of a game, the next invocation of the <tt>tetris</tt>
widget will continue where you left off.  If you lost, it will start a new
game.
</p>
</dd>
<dt><tt>tetriscurses</tt></dt>
<dd><p>This is a port of the above to zcurses.  The input handling is improved
a bit so that moving a block sideways doesn&rsquo;t automatically advance a
timestep, and the graphics use unicode block graphics.
</p>
<p>This version does not save the game state between invocations, and is not
invoked as a widget, but rather as:
</p>
<div class="example">
<pre class="example">autoload -U tetriscurses
tetriscurses
</pre></div>

<a name="index-zargs"></a>
</dd>
<dt><tt>zargs</tt> [ <var>option</var> ... <tt>-</tt><tt>-</tt> ] [ <var>input</var> ... ] [ <tt>-</tt><tt>-</tt> <var>command</var> [ <var>arg</var> ... ] ]</dt>
<dd><p>This function has a similar purpose to GNU xargs.  Instead of
reading lines of arguments from the standard input, it takes them from
the command line.  This is useful because zsh, especially with recursive
glob operators, often can construct a command line for a shell function
that is longer than can be accepted by an external command.
</p>
<p>The <var>option</var> list represents options of the <tt>zargs</tt> command itself,
which are the same as those of <tt>xargs</tt>.  The <var>input</var> list is the
collection of strings (often file names) that become the arguments of the
<tt>command</tt>, analogous to the standard input of <tt>xargs</tt>.  Finally, the
<var>arg</var> list consists of those arguments (usually options) that are
passed to the <var>command</var> each time it runs.  The <var>arg</var> list precedes
the elements from the <tt>input</tt> list in each run.  If no <var>command</var> is
provided, then no <var>arg</var> list may be provided, and in that event the
default command is &lsquo;<tt>print</tt>&rsquo; with arguments &lsquo;<tt>-r -</tt><tt>-</tt>&rsquo;.
</p>
<p>For example, to get a long <tt>ls</tt> listing of all non-hidden plain files
in the current directory or its subdirectories:
</p>
<div class="example">
<pre class="example">autoload -U zargs
zargs -- **/*(.) -- ls -ld --
</pre></div>

<p>The first and third occurrences of &lsquo;<tt>-</tt><tt>-</tt>&rsquo; are used to mark the end
of options for <tt>zargs</tt> and <tt>ls</tt> respectively to guard against
filenames starting with &lsquo;<tt>-</tt>&rsquo;, while the second is used to separate the
list of files from the command to run (&lsquo;<tt>ls -ld &ndash;</tt>&rsquo;).
</p>
<p>The first &lsquo;<tt>-</tt><tt>-</tt>&rsquo; would also be needed if there was a chance the
list might be empty as in:
</p>
<div class="example">
<pre class="example">zargs -r -- ./*.back(#qN) -- rm -f
</pre></div>

<p>In the event that the string &lsquo;<tt>-</tt><tt>-</tt>&rsquo; is or may be an <var>input</var>, the
<tt>-e</tt> option may be used to change the end-of-inputs marker.  Note that
this does <em>not</em> change the end-of-options marker.  For example, to use
&lsquo;<tt>..</tt>&rsquo; as the marker:
</p>
<div class="example">
<pre class="example">zargs -e.. -- **/*(.) .. ls -ld --
</pre></div>

<p>This is a good choice in that example because no plain file can be named
&lsquo;<tt>..</tt>&rsquo;, but the best end-marker depends on the circumstances.
</p>
<p>The options <tt>-i</tt>, <tt>-I</tt>, <tt>-l</tt>, <tt>-L</tt>, and <tt>-n</tt> differ slightly
from their usage in <tt>xargs</tt>.  There are no input lines for <tt>zargs</tt> to
count, so <tt>-l</tt> and <tt>-L</tt> count through the <var>input</var> list, and <tt>-n</tt>
counts the number of arguments passed to each execution of <var>command</var>,
<em>including</em> any <var>arg</var> list.  Also, any time <tt>-i</tt> or <tt>-I</tt> is used,
each <var>input</var> is processed separately as if by &lsquo;<tt>-L</tt> <tt>1</tt>&rsquo;.
</p>
<p>For details of the other <tt>zargs</tt> options, see the xargs(1) man page (but note
the difference in function between <tt>zargs</tt> and <tt>xargs</tt>) or run
<tt>zargs</tt> with the <tt>-</tt><tt>-help</tt> option.
</p>
<a name="index-zed"></a>
</dd>
<dt><tt>zed</tt> [ <tt>-f</tt> [ <tt>-x</tt> <var>num</var> ] ] <var>name</var></dt>
<dt><tt>zed</tt> [ <tt>-h</tt> [ <var>name</var> ] <var>size</var> ]</dt>
<dt><tt>zed -b</tt></dt>
<dd><p>This function uses the ZLE editor to edit a file or function.
</p>
<p>Only one <var>name</var> argument is allowed.
If the <tt>-f</tt> option is given, the name is taken to be that of
a function; if the function is marked for autoloading, <tt>zed</tt> searches
for it in the <tt>fpath</tt> and loads it.  Note that functions edited this way
are installed into the current shell, but <em>not</em> written back to the
autoload file.  In this case the <tt>-x</tt> option specifies that leading
tabs indenting the function according to syntax should be converted into
the given number of spaces; &lsquo;<tt>-x 2</tt>&rsquo; is consistent with the layout
of functions distributed with the shell.
</p>
<p>Without <tt>-f</tt>, <var>name</var> is the path name of the file to edit, which need
not exist; it is created on write, if necessary.  With <tt>-h</tt>, the file is
presumed to contain history events.
</p>
<p>When no file name is provided for <tt>-h</tt> the current shell history is edited
in place.  The history is renumbered when zed exits successfully.
</p>
<p>When editing history, multi-line events must have a trailing backslash on
every line before the last.
</p>
<p>While editing, the function sets the main keymap to <tt>zed</tt> and the
vi command keymap to <tt>zed-vicmd</tt>.  These will be copied from the existing
<tt>main</tt> and <tt>vicmd</tt> keymaps if they do not exist the first time <tt>zed</tt>
is run.  They can be used to provide special key bindings used only in zed.
</p>
<p>If it creates the keymap, <tt>zed</tt> rebinds the return key to insert a line
break and &lsquo;<tt>^X^W</tt>&rsquo; to accept the edit in the <tt>zed</tt> keymap, and binds
&lsquo;<tt>ZZ</tt>&rsquo; to accept the edit in the <tt>zed-vicmd</tt> keymap.
</p>
<p>The bindings alone can be installed by running &lsquo;<tt>zed -b</tt>&rsquo;.  This is
suitable for putting into a startup file.  Note that, if rerun,
this will overwrite the existing <tt>zed</tt> and <tt>zed-vicmd</tt> keymaps.
</p>
<p>Completion is available, and styles may be set with the context prefix
&lsquo;<tt>:completion:zed:</tt>&rsquo;.
</p>
<a name="index-zed_002dset_002dfile_002dname"></a>
<p>A zle widget <tt>zed-set-file-name</tt> is available.  This can be called
by name from within zed using &lsquo;<tt>\ex zed-set-file-name</tt>&rsquo; or can be
bound to a key in either of the <tt>zed</tt> or <tt>zed-vicmd</tt> keymaps after
&lsquo;<tt>zed -b</tt>&rsquo; has been run.  When the widget is called, it prompts for
a new name for the file being edited.  When zed exits the file will be
written under that name and the original file will be left alone.  The
widget has no effect when invoked from &lsquo;<tt>zed -f</tt>&rsquo;.  The completion
context is changed to &lsquo;<tt>:completion:zed-set-file-name:</tt>&rsquo;.  When editing
the current history with &lsquo;<tt>zed -h</tt>&rsquo;, the history is first updated and
then the file is written, but the global setting of <tt>HISTFILE</tt> is not
altered.
</p>
<p>While <tt>zed-set-file-name</tt> is running, zed uses the keymap
<tt>zed-normal-keymap</tt>, which is linked from the main keymap in effect
at the time zed initialised its bindings.  (This is to make the return key
operate normally.)  The result is that if the main keymap has been changed,
the widget won&rsquo;t notice.  This is not a concern for most users.
</p>
<a name="index-zcp"></a>
<a name="index-zln"></a>
</dd>
<dt><tt>zcp</tt> [ <tt>-finqQvwW</tt> ] <var>srcpat</var> <var>dest</var></dt>
<dt><tt>zln</tt> [ <tt>-finqQsvwW</tt> ] <var>srcpat</var> <var>dest</var></dt>
<dd><p>Same as <tt>zmv -C</tt> and <tt>zmv -L</tt>, respectively.  These functions do not
appear in the zsh distribution, but can be created by linking <tt>zmv</tt> to
the names <tt>zcp</tt> and <tt>zln</tt> in some directory in your <tt>fpath</tt>.
</p>
</dd>
<dt><tt>zkbd</tt></dt>
<dd><p>See &lsquo;Keyboard Definition&rsquo;
(<a href="#Utilities">Utilities</a>).
</p>
<a name="index-zmv"></a>

</dd>
<dt><tt>zmv</tt> [ <tt>-finqQsvwW</tt> ] [ <tt>-C</tt> | <tt>-L</tt> | <tt>-M</tt> | -{<tt>p</tt>|<tt>P</tt>} <var>program</var> ] [ <tt>-o</tt> <var>optstring</var> ]</dt>
<dt><tt>&nbsp;&nbsp;&nbsp;&nbsp;</tt><var>srcpat</var> <var>dest</var></dt>
<dd><p>Move (usually, rename) files matching the pattern <var>srcpat</var> to
corresponding files having names of the form given by <var>dest</var>, where
<var>srcpat</var> contains parentheses surrounding patterns which will be
replaced in turn by <tt>$1</tt>, <tt>$2</tt>, ... in <var>dest</var>.  For example,
</p>
<div class="example">
<pre class="example">zmv '(*).lis' '$1.txt'
</pre></div>

<p>renames &lsquo;<tt>foo.lis</tt>&rsquo; to &lsquo;<tt>foo.txt</tt>&rsquo;, &lsquo;<tt>my.old.stuff.lis</tt>&rsquo; to
&lsquo;<tt>my.old.stuff.txt</tt>&rsquo;, and so on.
</p>
<p>The pattern is always treated as an <tt>EXTENDED_GLOB</tt> pattern.  Any file
whose name is not changed by the substitution is simply ignored.  Any
error (a substitution resulted in an empty string, two substitutions gave
the same result, the destination was an existing regular file and <tt>-f</tt>
was not given) causes the entire function to abort without doing
anything.
</p>
<p>In addition to pattern replacement, the variable <tt>$f</tt> can be referred
to in the second (replacement) argument.  This makes it possible to
use variable substitution to alter the argument; see examples below.
</p>
<p>Options:
</p>
<dl compact="compact">
<dt><tt>-f</tt></dt>
<dd><p>Force overwriting of destination files.  Not currently
passed down to the <tt>mv</tt>/<tt>cp</tt>/<tt>ln</tt> command due to vagaries of
implementations (but you can use <tt>-o-f</tt> to do that).
</p></dd>
<dt><tt>-i</tt></dt>
<dd><p>Interactive: show each line to be executed and ask the user
whether to execute it.  &lsquo;<tt>Y</tt>&rsquo; or &lsquo;<tt>y</tt>&rsquo; will execute it, anything else will
skip it.  Note that you just need to type one character.
</p></dd>
<dt><tt>-n</tt></dt>
<dd><p>No execution: print what would happen, but don&rsquo;t do it.
</p></dd>
<dt><tt>-q</tt></dt>
<dd><p>Turn bare glob qualifiers off: now assumed by default, so
this has no effect.
</p></dd>
<dt><tt>-Q</tt></dt>
<dd><p>Force bare glob qualifiers on.  Don&rsquo;t turn this on unless
you are actually using glob qualifiers in a pattern.
</p></dd>
<dt><tt>-s</tt></dt>
<dd><p>Symbolic, passed down to <tt>ln</tt>; only works with <tt>-L</tt>.
</p></dd>
<dt><tt>-v</tt></dt>
<dd><p>Verbose: print each command as it&rsquo;s being executed.
</p></dd>
<dt><tt>-w</tt></dt>
<dd><p>Pick out wildcard parts of the pattern, as described above,
and implicitly add parentheses for referring to them.
</p></dd>
<dt><tt>-W</tt></dt>
<dd><p>Just like <tt>-w</tt>, with the addition of turning wildcards in
the replacement pattern into sequential <tt>${1}</tt> .. <tt>${N}</tt> references.
</p></dd>
<dt><tt>-C</tt></dt>
<dt><tt>-L</tt></dt>
<dt><tt>-M</tt></dt>
<dd><p>Force <tt>cp</tt>, <tt>ln</tt> or <tt>mv</tt>, respectively, regardless of
the name of the function.
</p></dd>
<dt><tt>-p</tt> <var>program</var></dt>
<dd><p>Call <var>program</var> instead of <tt>cp</tt>, <tt>ln</tt> or
<tt>mv</tt>.  Whatever it does, it should at least understand the form
</p><div class="example">
<pre class="example"><var>program</var> <tt>-</tt><tt>-</tt> <var>oldname</var> <var>newname</var>
</pre></div>
<p>where <var>oldname</var> and <var>newname</var> are filenames generated by <tt>zmv</tt>.
<var>program</var> will be split into words, so might be e.g. the name
of an archive tool plus a copy or rename subcommand.
</p></dd>
<dt><tt>-P</tt> <var>program</var></dt>
<dd><p>As <tt>-p</tt> <var>program</var>, except that
<var>program</var> does not accept a following <tt>-</tt><tt>-</tt> to indicate the
end of options.  In this case filenames must already be in a sane
form for the program in question.
</p></dd>
<dt><tt>-o</tt> <var>optstring</var></dt>
<dd><p>The <var>optstring</var> is split into words and
passed down verbatim to the <tt>cp</tt>, <tt>ln</tt> or <tt>mv</tt> command called to
perform the work.  It should probably begin with a &lsquo;<tt>-</tt>&rsquo;.
</p></dd>
</dl>

<p>Further examples:
</p>
<div class="example">
<pre class="example">zmv -v '(* *)' '${1// /_}'
</pre></div>

<p>For any file in the current directory with at least one space in the name,
replace every space by an underscore and display the commands executed.
</p>
<div class="example">
<pre class="example">zmv -v '* *' '${f// /_}'
</pre></div>

<p>This does exactly the same by referring to the file name stored in <tt>$f</tt>.
</p>
<p>For more complete examples and other implementation details, see the
<tt>zmv</tt> source file, usually located in one of the directories named in
your <tt>fpath</tt>, or in <tt>Functions/Misc/zmv</tt> in the zsh distribution.
</p>
</dd>
<dt><tt>zrecompile</tt></dt>
<dd><p>See &lsquo;Recompiling Functions&rsquo;
(<a href="#Utilities">Utilities</a>).
</p>
<a name="index-zstyle_002b"></a>
</dd>
<dt><tt>zstyle+</tt> <var>context</var> <var>style</var> <var>value</var> [ <tt>+</tt> <var>subcontext</var> <var>style</var> <var>value</var> ... ]</dt>
<dd><p>This makes defining styles a bit simpler by using a single &lsquo;<tt>+</tt>&rsquo; as a
special token that allows you to append a context name to the previously
used context name.  Like this:
</p>
<div class="example">
<pre class="example">zstyle+ ':foo:bar' <var>style1</var> <var>value1</var> \ 
       +':baz'     <var>style2</var> <var>value2</var> \ 
       +':frob'    <var>style3</var> <var>value3</var>
</pre></div>

<p>This defines <var>style1</var> with <var>value1</var> for the context <tt>:foo:bar</tt> as usual,
but it also defines <var>style2</var> with <var>value2</var> for the context
<tt>:foo:bar:baz</tt> and <var>style3</var> with <var>value3</var> for <tt>:foo:bar:frob</tt>.  Any
<var>subcontext</var> may be the empty string to re-use the first context
unchanged.
</p>
</dd>
</dl>


<hr>
<a name="Styles"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Descriptions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Other-Functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">26.12.2 Styles</h3>

<dl compact="compact">
<dd><a name="index-insert_002dtab_002c-completion-style-1"></a>
</dd>
<dt><tt>insert-tab</tt></dt>
<dd><p>The <tt>zed</tt> function <em>sets</em> this style in context &lsquo;<tt>:completion:zed:*</tt>&rsquo;
to turn off completion when <tt>TAB</tt> is typed at the beginning of a line.
You may override this by setting your own value for this context and style.
</p>
<a name="index-pager_002c-nslookup-style"></a>
</dd>
<dt><tt>pager</tt></dt>
<dd><p>The <tt>nslookup</tt> function looks up this style in the context
&lsquo;<tt>:nslookup</tt>&rsquo; to determine the program used to display output that does
not fit on a single screen.
</p>
<a name="index-prompt_002c-nslookup-style"></a>
<a name="index-rprompt_002c-nslookup-style"></a>
</dd>
<dt><tt>prompt</tt></dt>
<dt><tt>rprompt</tt></dt>
<dd><p>The <tt>nslookup</tt> function looks up this style in the context
&lsquo;<tt>:nslookup</tt>&rsquo; to set the prompt and the right-side prompt, respectively.
The usual expansions for the <tt>PS1</tt> and <tt>RPS1</tt> parameters may be used
(see
<a href="Prompt-Expansion.html#Prompt-Expansion">Prompt Expansion</a>).
</p>
</dd>
</dl>
<hr>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#User-Contributions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="index.html#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="zsh_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="Concept-Index.html#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="zsh_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated on <i>May 14, 2022</i> using <a href="http://www.nongnu.org/texi2html/"><i>texi2html 5.0</i></a>.
 </font>
 <br>
<font size="-1">Zsh version 5.9, released on May 14, 2022.</font>
</p>
</body>
</html>
